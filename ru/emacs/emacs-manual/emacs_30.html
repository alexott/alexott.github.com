<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from emacs.texi on 29 October 2002 -->

<TITLE>Руководство по GNU Emacs - Редактирование рисунков</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_29.html">previous</A>, <A HREF="emacs_31.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC334" HREF="emacs_toc.html#TOC334">Редактирование рисунков</A></H1>
<P>
<A NAME="IDX1689"></A>
<A NAME="IDX1690"></A>
<A NAME="IDX1691"></A>


<P>
  Чтобы создать рисунок, составленный из текстовых знаков (например
изображение деления регистра на поля в качестве комментария в
программе), используйте команду <KBD>M-x edit-picture</KBD> для входа в режим
Picture.


<P>
  В режиме Picture редактирование основывается на <EM>квадрантной</EM>
модели текста, согласно которой текстовые знаки рассыпаны в области,
простирающейся неограничено вправо и вниз.  Понятие конца строки не
существует в этой модели; самое большое, что вы можете сказать, -- это
где находится последний непустой знак на строке.


<P>
  Конечно, в действительности Emacs всегда рассматривает текст как
последовательность знаков, и строки на самом деле имеют концы.  Но в
режиме Picture наиболее часто используемые команды заменяются
вариантами, которые воспроизводят квадрантную модель текста.  Они делают
это, вставляя пробелы или превращая в пробелы знаки табуляции.


<P>
  Большинство базовых команд редактирования Emacs переопределяются
режимом Picture таким образом, чтобы делать в основном те же самые вещи,
но квадрантным способом.  Кроме того, режим Picture определяет разные
ключи, начинающиеся с префикса <KBD>C-c</KBD>, для запуска специальных команд
редактирования изображения.


<P>
  Один из этих ключей, <KBD>C-c C-c</KBD>, достаточно важен.  Часто рисунок
--- это часть большего файла, который обычно редактируется в
каком-нибудь другом основном режиме.  Команда <KBD>M-x edit-picture</KBD>
записывает имя предыдущего основного режима, и затем вы можете
использовать команду <KBD>C-c C-c</KBD> (<CODE>picture-mode-exit</CODE>), чтобы
вернуться в этот режим.  Если <KBD>C-c C-c</KBD> не имеет числового
аргумента, она также уничтожает пробелы в концах строк.


<P>
  Все команды, используемые в режиме Picture, работают и в других
режимах (если только загружена библиотека <TT>`picture'</TT>), но привязаны
к ключам только в режиме Picture.  Дальнейшие описания говорят о
движении "на один столбец" и так далее, но все команды режима Picture
обращаются с числовыми аргументами так же, как и их обычные эквиваленты.


<P>
<A NAME="IDX1692"></A>
   Включение режима Picture вызывает ловушку <CODE>picture-mode-hook</CODE>
(see section <A HREF="emacs_36.html#SEC449">Ловушки</A>).




<H2><A NAME="SEC335" HREF="emacs_toc.html#TOC335">Основы редактирования в режиме Picture</A></H2>

<P>
<A NAME="IDX1693"></A>
<A NAME="IDX1694"></A>
<A NAME="IDX1695"></A>
<A NAME="IDX1696"></A>
<A NAME="IDX1697"></A>


<P>
  Большинство ключей делают в режиме Picture то же самое, что они делают
обычно, но в квадрантном стиле.  Например, <KBD>C-f</KBD> перепривязывается
на запуск команды <CODE>picture-forward-column</CODE>, которая передвигает
точку на один столбец вправо, вставляя, если это необходимо, пробел, так
что действительный конец строки не играет роли.  <KBD>C-b</KBD>
перепривязывается для запуска <CODE>picture-backward-column</CODE>, которая
всегда двигает точку влево на один столбец, превращая знак табуляции в
несколько пробелов, если это необходимо.  <KBD>C-n</KBD> и <KBD>C-p</KBD>
перепривязываются для запуска <CODE>picture-move-down</CODE> и
<CODE>picture-move-up</CODE>, которые могут либо вставить пробелы, либо
превратить знаки табуляции в пробелы, как необходимо, чтобы
гарантировать, что точка остается в том же самом столбце.  <KBD>C-e</KBD>
запускает <CODE>picture-end-of-line</CODE>, которая передвигается за последний
непустой знак на строке.  Здесь не надо менять <KBD>C-a</KBD>, так как выбор
модели экрана не влияет на начала строк.


<P>
<A NAME="IDX1698"></A>
  Вставка текста приспосабливается к квадрантной модели экрана
посредством использования режима Overwrite (see section <A HREF="emacs_36.html#SEC441">Второстепенные режимы</A>).  Самовставляющиеся знаки заменяют существующий текст, столбец
за столбцом, а не выталкивают его вправо.  <KBD>RET</KBD> запускает
<CODE>picture-newline</CODE>, которая просто сдвигает на начало следующей
строки, так что новый текст заменит эту строку.


<P>
<A NAME="IDX1699"></A>
<A NAME="IDX1700"></A>
<A NAME="IDX1701"></A>
  Режим Picture предоставляет стирание текста вместо удаления и
уничтожения.  <KBD>DEL</KBD> (<CODE>picture-backward-clear-column</CODE>) заменяет
предыдущий знак пробелом, а не удаляет его; это смещает точку назад.
<KBD>C-d</KBD> (<CODE>picture-clear-column</CODE>) заменяет следующий знак или
знаки пробелами, но не сдвигает точку.  (Если вы хотите превратить знаки
в пробелы и продвинуться через них, используйте <KBD>SPC</KBD>.)  <KBD>C-k</KBD>
(<CODE>picture-clear-line</CODE>) действительно уничтожает содержимое строки,
но никогда не удаляет из буфера знаки перевода строки.


<P>
<A NAME="IDX1702"></A>
  Чтобы сделать действительную вставку, вы должны использовать
специальные команды.  <KBD>C-o</KBD> (<CODE>picture-open-line</CODE>) создает
пустую строку после текущей; она никогда не разбивает строку.
<KBD>C-M-o</KBD> (<CODE>split-line</CODE>) имеет смысл в режиме Picture, поэтому
она не изменяется.  <KBD>C-j</KBD> (<CODE>picture-duplicate-line</CODE>) вставляет
ниже текущей строки другую строку с тем же самым содержимым.

<P>
<A NAME="IDX1703"></A>
   Чтобы сделать в режиме Picture действительное удаление, используйте
<KBD>C-w</KBD> или <KBD>C-c C-d</KBD> (которая определяется для запуска
<CODE>delete-char</CODE>, как <KBD>C-d</KBD> в других режимах), или с помощью одной
из команд прямоугольника для рисунков (see section <A HREF="emacs_30.html#SEC338">Команды прямоугольника в режиме Picture</A>).




<H2><A NAME="SEC336" HREF="emacs_toc.html#TOC336">Управление движением после вставки</A></H2>

<P>
<A NAME="IDX1704"></A>
<A NAME="IDX1705"></A>
<A NAME="IDX1706"></A>
<A NAME="IDX1707"></A>
<A NAME="IDX1708"></A>
<A NAME="IDX1709"></A>
<A NAME="IDX1710"></A>
<A NAME="IDX1711"></A>
<A NAME="IDX1712"></A>
<A NAME="IDX1713"></A>
<A NAME="IDX1714"></A>
<A NAME="IDX1715"></A>
<A NAME="IDX1716"></A>
<A NAME="IDX1717"></A>
<A NAME="IDX1718"></A>
<A NAME="IDX1719"></A>
  Так как "самовставляющиеся" знаки в режиме Picture перезаписывают и
передвигают точку, то нет существенного ограничения на то, как точка
будет передвигаться.  Обычно точка перемещается вправо, но вы можете
определить любое из восьми ортогональных или диагональных направлений
для движения после "самовставляющегося" знака.  Это удобно для
рисования линий в буфере.


<DL COMPACT>

<DT><KBD>C-c &#60;</KBD>
<DD>
Сдвинуться после вставки влево (<CODE>picture-movement-left</CODE>).
<DT><KBD>C-c &#62;</KBD>
<DD>
Сдвинуться после вставки вправо (<CODE>picture-movement-right</CODE>).
<DT><KBD>C-c ^</KBD>
<DD>
Сдвинуться после вставки вверх (<CODE>picture-movement-up</CODE>).
<DT><KBD>C-c .</KBD>
<DD>
Cдвинуться после вставки вниз (<CODE>picture-movement-down</CODE>).
<DT><KBD>C-c `</KBD>
<DD>
Сдвинуться после вставки вверх и влево (на "северо-запад")
(<CODE>picture-movement-nw</CODE>).
<DT><KBD>C-c '</KBD>
<DD>
Сдвинуться после вставки вверх и вправо (на "северо-восток")
(<CODE>picture-movement-ne</CODE>).
<DT><KBD>C-c /</KBD>
<DD>
Сдвинуться после вставки вниз и влево (на "юго-запад")
<BR>(<CODE>picture-movement-sw</CODE>).
<DT><KBD>C-c \</KBD>
<DD>
Сдвинуться после вставки вниз и вправо (на "юго-восток")
<BR>(<CODE>picture-movement-se</CODE>).
</DL>

<P>
<A NAME="IDX1720"></A>
<A NAME="IDX1721"></A>
<A NAME="IDX1722"></A>
<A NAME="IDX1723"></A>
  Две команды движения передвигают, основываясь на текущем направлении
вставки.  Команда <KBD>C-c C-f</KBD> (<CODE>picture-motion</CODE>) передвигает в
том же самом направлении, в каком выполняется движение после текущей
"вставки", тогда как <KBD>C-c C-b</KBD> (<CODE>picture-motion-reverse</CODE>)
двигает в противоположном направлении.




<H2><A NAME="SEC337" HREF="emacs_toc.html#TOC337">Знаки табуляции в режиме Picture</A></H2>

<P>
<A NAME="IDX1724"></A>
<A NAME="IDX1725"></A>
<A NAME="IDX1726"></A>
   В режиме Picture предусмотрены два вида действий, подобных табуляции.
Для табуляции, основанной на контексте, используйте <KBD>M-<KBD>TAB</KBD></KBD>
(<CODE>picture-tab-search</CODE>).  Без аргумента она передвигает в точку под
следующий "интересный" знак, который следует за незначащим знаком в
предыдущей непустой строке.  "Следующий" означает здесь "появляющийся
в более дальней горизонтальной позиции, чем та, с которой точка
отправлялась".  С аргументом, как в <KBD>C-u M-<KBD>TAB</KBD></KBD>, эта команда
переходит к следующему такому интересному знаку в текущей строке.
<KBD>M-<KBD>TAB</KBD></KBD> не изменяет текст, она только двигает точку.
"Интересные" знаки определяются переменной <CODE>picture-tab-chars</CODE>,
которая должна задавать набор знаков.  Синтаксис этой переменной похож
на синтаксис, используемый внутри <SAMP>`[...]'</SAMP> в регулярном
выражении, но без <SAMP>`['</SAMP> и <SAMP>`]'</SAMP>.  Ее значение по умолчанию равно
<CODE>"!-~"</CODE>.


<P>
<A NAME="IDX1727"></A>
   Сама <KBD>TAB</KBD> запускает <CODE>picture-tab</CODE>, которая действует,
основываясь на установленных текущих позициях табуляции; это эквивалент
<CODE>tab-to-tab-stop</CODE> в режиме Picture.  Обычно она просто двигает
точку, но с числовым аргументом она стирает текст, через который
передвинулась.


<P>
<A NAME="IDX1728"></A>
<A NAME="IDX1729"></A>
  Формы табуляции, основанные на контексте и на позициях табуляции,
объединяются вместе командой <KBD>C-c <KBD>TAB</KBD></KBD>,
<CODE>picture-set-tab-stops</CODE>.  Эта команда устанавливает позиции
табуляции, которые <KBD>M-<KBD>TAB</KBD></KBD> считала бы значимыми в текущей
строке.  Использование этой команды вместе с <KBD>TAB</KBD> может дать эффект
табуляции, основанной на контексте.  Но <KBD>M-<KBD>TAB</KBD></KBD> более удобна в
тех случаях, когда ее достаточно.


<P>
  Может оказаться удобным запретить использование настоящих знаков
табуляции в рисунках.  Например, это помешает <KBD>C-x <KBD>TAB</KBD></KBD>
испортить рисунок.  Вы можете сделать так, установив переменную
<CODE>indent-tabs-mode</CODE> в значение <CODE>nil</CODE>.  See section <A HREF="emacs_25.html#SEC216">Табуляция по сравнению с пробелами</A>.




<H2><A NAME="SEC338" HREF="emacs_toc.html#TOC338">Команды прямоугольника в режиме Picture</A></H2>
<P>
<A NAME="IDX1730"></A>
<A NAME="IDX1731"></A>
<A NAME="IDX1732"></A>


<P>
  Режим Picture определяет команды для работы с прямоугольными кусками
текста таким способом, который подходит для квадрантной модели.
Стандартные команды для прямоугольников также могут быть полезны
(see section <A HREF="emacs_14.html#SEC72">Прямоугольники</A>).


<DL COMPACT>

<DT><KBD>C-c C-k</KBD>
<DD>
Очистить текущую область-прямоугольник (<CODE>picture-clear-rectangle</CODE>).
С аргументом -- удалить ее.
<DT><KBD>C-c C-w <VAR>r</VAR></KBD>
<DD>
То же самое, но сначала сохранить содержимое прямоугольника в регистре
<VAR>r</VAR> (<CODE>picture-clear-rectangle-to-register</CODE>).
<DT><KBD>C-c C-y</KBD>
<DD>
Скопировать последний уничтоженный прямоугольник в буфер путем
перезаписи, при этом левый верхний угол находится в точке
(<CODE>picture-yank-rectangle</CODE>).  С аргументом -- вставка вместо
перезаписи.
<DT><KBD>C-c C-x <VAR>r</VAR></KBD>
<DD>
То же самое, но использовать прямоугольник из регистра <VAR>r</VAR>
(<CODE>picture-yank-rectangle-from-register</CODE>).
</DL>

<P>
<A NAME="IDX1733"></A>
<A NAME="IDX1734"></A>
<A NAME="IDX1735"></A>
<A NAME="IDX1736"></A>
  Команды работы с прямоугольниками для рисунков, это <KBD>C-c C-k</KBD>
(<CODE>picture-clear-rectangle</CODE>) и <KBD>C-c C-w</KBD>
(<CODE>picture-clear-rectangle-to-register</CODE>), отличаются от стандартных
команд прямоугольника тем, что они обычно очищают прямоугольник вместо
его удаления; это аналогично тому, как в режиме Picture изменяется
<KBD>C-d</KBD>.


<P>
  Однако, удаление прямоугольников может быть удобным и в режиме
Picture, поэтому эти команды удаляют прямоугольник, если им передан
числовой аргумент.  <KBD>C-c C-k</KBD> с числовым аргументом или без него
сохраняет прямоугольник для <KBD>C-c C-y</KBD>.


<P>
<A NAME="IDX1737"></A>
<A NAME="IDX1738"></A>
<A NAME="IDX1739"></A>
<A NAME="IDX1740"></A>
  Команды режима Picture для восстановления прямоугольников отличаются
от стандартных тем, что они перезаписывают, а не вставляют.  Точно так
же вставка другого текста в режиме Picture отличается от вставки в
других режимах.  <KBD>C-c C-y</KBD> (<CODE>picture-yank-rectangle</CODE>) вставляет
(при помощи перезаписи) прямоугольник, который был уничтожен самым
последним, в то время как <KBD>C-c C-x</KBD>
(<CODE>picture-yank-rectangle-from-register</CODE>) делает то же самое для
прямоугольника, находящегося в указанном регистре.
<P><HR><P>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_29.html">previous</A>, <A HREF="emacs_31.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
</BODY>
</HTML>
