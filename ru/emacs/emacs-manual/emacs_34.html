<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from emacs.texi on 29 October 2002 -->

<TITLE>Руководство по GNU Emacs - Календарь и дневник</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_33.html">previous</A>, <A HREF="emacs_35.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC387" HREF="emacs_toc.html#TOC387">Календарь и дневник</A></H1>
<P>
<A NAME="IDX2114"></A>
<A NAME="IDX2115"></A>


<P>
  Emacs может работать как настольный календарь с ежедневником для
планируемых и прошедших событий.  Чтобы войти в календарь, наберите
<KBD>M-x calendar</KBD>; это покажет календарь на три месяца,
отцентрированный на текущем месяце, а точка будет находиться на текущей
дате.  С числовым аргументом, как в <KBD>C-u M-x calendar</KBD>, эта команда
запрашивает у вас месяц и год, которые должны оказаться в центре
трехмесячного календаря.  Календарь использует свой собственный буфер c
основным режимом Calendar.


<P>
  <KBD>Mouse-2</KBD> в календаре выводит меню операций для даты;
<KBD>C-Mouse-3</KBD> выводит меню часто используемых средств календаря,
которые не зависят от конкретной даты.  Чтобы выйти из календаря,
введите <KBD>q</KBD>.  @xref{Calendar, Customizing the Calendar and Diary,, @external{elisp}, The Emacs Lisp Reference Manual}, для получения
информации о настройке календаря и дневника.




<H2><A NAME="SEC388" HREF="emacs_toc.html#TOC388">Перемещение по календарю</A></H2>

<P>
<A NAME="IDX2116"></A>
  Режим Calendar позволяет вам перемещаться по календарю через
логические промежутки времени, такие как дни, недели, месяцы и годы.
Если вы переместитесь за те три месяца, которые показываются изначально,
календарь автоматически "прокручивается" на столько, сколько нужно,
чтобы выбранная дата стала видимой.  Перемещение к дате позволяет вам
просмотреть приходящиеся на нее праздники или записи в дневнике или
преобразовать ее в другие календарные системы; перемещение на большие
интервалы времени также полезно просто для прокрутки календаря.




<H3><A NAME="SEC389" HREF="emacs_toc.html#TOC389">Перемещение по обычным календарным единицам</A></H3>

<P>
  Команды для перемещения в буфере календаря аналогичны командам для
перемещения в тексте.  Вы можете переходить вперед и назад по дням,
неделям, месяцам и годам.


<DL COMPACT>

<DT><KBD>C-f</KBD>
<DD>
Перемещает на день вперед (<CODE>calendar-forward-day</CODE>).
<DT><KBD>C-b</KBD>
<DD>
Перемещает на день назад (<CODE>calendar-backward-day</CODE>).
<DT><KBD>C-n</KBD>
<DD>
Перемещает на неделю вперед (<CODE>calendar-forward-week</CODE>).
<DT><KBD>C-p</KBD>
<DD>
Перемещает на неделю назад (<CODE>calendar-backward-week</CODE>).
<DT><KBD>M-}</KBD>
<DD>
Перемещает на месяц вперед (<CODE>calendar-forward-month</CODE>).
<DT><KBD>M-{</KBD>
<DD>
Перемещает на месяц назад (<CODE>calendar-backward-month</CODE>).
<DT><KBD>C-x ]</KBD>
<DD>
Перемещает на год вперед (<CODE>calendar-forward-year</CODE>).
<DT><KBD>C-x [</KBD>
<DD>
Перемещает на год назад (<CODE>calendar-backward-year</CODE>).
</DL>

<P>
<A NAME="IDX2117"></A>
<A NAME="IDX2118"></A>
<A NAME="IDX2119"></A>
<A NAME="IDX2120"></A>
<A NAME="IDX2121"></A>
<A NAME="IDX2122"></A>
<A NAME="IDX2123"></A>
<A NAME="IDX2124"></A>
  Команды для перемещения по дням и неделям -- это естественные аналоги
обычных команд Emacs для перемещения по знакам или строкам.  Так же, как
<KBD>C-n</KBD> обычно перемещает к тому же столбцу в следующей строке, в
режиме Calendar она перемещает к тому же дню следующей недели.  А
<KBD>C-p</KBD> перемещает к тому же дню предыдущей недели.


<P>
  Курcорные стрелки эквивалентны <KBD>C-f</KBD>, <KBD>C-b</KBD>, <KBD>C-n</KBD> и
<KBD>C-p</KBD>, как и в других режимах.


<P>
<A NAME="IDX2125"></A>
<A NAME="IDX2126"></A>
<A NAME="IDX2127"></A>
<A NAME="IDX2128"></A>
<A NAME="IDX2129"></A>
<A NAME="IDX2130"></A>
<A NAME="IDX2131"></A>
<A NAME="IDX2132"></A>
  Команды для перемещения по месяцам и годам работают так же, как
команды для недель, но переносят на большие расстояния.  Команды для
месяцев <KBD>M-}</KBD> и <KBD>M-{</KBD> перемещают вперед или назад на целый
месяц.  Команды для лет <KBD>C-x ]</KBD> и <KBD>C-x [</KBD> перемещают вперед
или назад на целый год.


<P>
  Простейший способ запомнить эти команды -- рассматривать месяцы и
годы как аналоги абзацев и страниц, соответственно.  Но сами команды не
вполне аналогичны.  Обычные команды Emacs для абзацев передвигают к
началу или концу абзаца, тогда как эти команды для месяцев и лет
перемещают по целому месяцу или году, что обычно подразумевает переход
за конец месяца или года.


<P>
  Все эти команды принимают числовой аргумент в качестве счетчика
повторов.  Для удобства, в режиме Calendar цифры и знак минус задают
числовой аргумент даже без модификатора Meta.  Например, <KBD>100 C-f</KBD>
перемещает точку на 100 дней вперед от ее текущей позиции.




<H3><A NAME="SEC390" HREF="emacs_toc.html#TOC390">Начало или конец недели, месяца или года</A></H3>

<P>
  Неделя (или месяц, или год) -- это не просто некоторое количество
дней; мы полагаем, что недели (месяцы, года) начинаются с определенных
дат.  Поэтому режим Calendar предоставляет команды для перехода к началу
или концу недели, месяца или года:


<DL COMPACT>

<DT><KBD>C-a</KBD>
<DD>
<A NAME="IDX2133"></A>
 <A NAME="IDX2134"></A>
 
Переход к началу недели (<CODE>calendar-beginning-of-week</CODE>).
<A NAME="IDX2135"></A>
<A NAME="IDX2136"></A>
<DT><KBD>C-e</KBD>
<DD>
Переход к концу недели (<CODE>calendar-end-of-week</CODE>).
<A NAME="IDX2137"></A>
<A NAME="IDX2138"></A>
<DT><KBD>M-a</KBD>
<DD>
Переход к началу месяца (<CODE>calendar-beginning-of-month</CODE>).
<A NAME="IDX2139"></A>
<A NAME="IDX2140"></A>
<DT><KBD>M-e</KBD>
<DD>
Переход к концу месяца (<CODE>calendar-end-of-month</CODE>).
<A NAME="IDX2141"></A>
<A NAME="IDX2142"></A>
<DT><KBD>M-&#60;</KBD>
<DD>
Переход к началу года (<CODE>calendar-beginning-of-year</CODE>).
<A NAME="IDX2143"></A>
<A NAME="IDX2144"></A>
<DT><KBD>M-&#62;</KBD>
<DD>
Переход к концу года (<CODE>calendar-end-of-year</CODE>).
</DL>

<P>
  Эти команды также принимают числовые аргументы в качестве счетчиков
повторений, который указывает, на сколько недель, месяцев или лет нужно
переместиться вперед или назад.


<P>
<A NAME="IDX2145"></A>
<A NAME="IDX2146"></A>
<A NAME="IDX2147"></A>
  По умолчанию недели начинаются с воскресенья.  Чтобы сделать так,
чтобы они начинались с понедельника, установите переменную
<CODE>calendar-week-start-day</CODE> в значение 1.




<H3><A NAME="SEC391" HREF="emacs_toc.html#TOC391">Указанные даты</A></H3>

<P>
  Режим Calendar предоставляет команды для перехода к конкретной дате,
которую можно задать многими способами.


<DL COMPACT>

<DT><KBD>g d</KBD>
<DD>
Перемещает точку к указанной дате (<CODE>calendar-goto-date</CODE>).
<DT><KBD>o</KBD>
<DD>
Центрирует календарь вокруг указанного месяца
(<CODE>calendar-other-month</CODE>).
<DT><KBD>.</KBD>
<DD>
Перемещает к сегодняшней дате (<CODE>calendar-goto-today</CODE>).
</DL>

<P>
<A NAME="IDX2148"></A>
<A NAME="IDX2149"></A>
  <KBD>g d</KBD> (<CODE>calendar-goto-date</CODE>) запрашивает год, месяц и день
месяца, а затем перемещает к этой дате.  Поскольку календарь включает
все даты от начала нашей эры, вы должны вводить год полностью; то есть
пишите <SAMP>`1990'</SAMP>, а не <SAMP>`90'</SAMP>.


<P>
<A NAME="IDX2150"></A>
<A NAME="IDX2151"></A>
  <KBD>o</KBD> (<CODE>calendar-other-month</CODE>) запрашивает месяц и год, а затем
центрирует трехмесячный календарь вокруг этого месяца.


<P>
<A NAME="IDX2152"></A>
<A NAME="IDX2153"></A>
  Вы можете вернуться к сегодняшней дате с помощью команды <KBD>.</KBD>
(<CODE>calendar-goto-today</CODE>).




<H2><A NAME="SEC392" HREF="emacs_toc.html#TOC392">Прокрутка календаря</A></H2>

<P>
<A NAME="IDX2154"></A>
  Изображение календаря автоматически прокручивается, когда вы
сдвигаетесь за пределы видимой части.  Вы также можете прокручивать его
вручную.  Представьте, что окно календаря содержит длинную ленту бумаги
с месяцами.  Прокрутка ее означает, что в этом окне станут видимыми
новые месяцы.


<DL COMPACT>

<DT><KBD>C-x &#60;</KBD>
<DD>
Прокручивает календарь на один месяц вперед
(<CODE>scroll-calendar-left</CODE>).
<DT><KBD>C-x &#62;</KBD>
<DD>
Прокручивает календарь на один месяц назад
(<CODE>scroll-calendar-right</CODE>).
<DT><KBD>C-v</KBD>
<DD>
<DT><KBD><KBD>NEXT</KBD></KBD>
<DD>
Прокручивает календарь на три месяца вперед
(<CODE>scroll-calendar-left-three-months</CODE>).
<DT><KBD>M-v</KBD>
<DD>
<DT><KBD><KBD>PRIOR</KBD></KBD>
<DD>
Прокручивает календарь на три месяца назад
(<CODE>scroll-calendar-right-three-months</CODE>).
</DL>

<P>
<A NAME="IDX2155"></A>
<A NAME="IDX2156"></A>
<A NAME="IDX2157"></A>
<A NAME="IDX2158"></A>
  Самые основные команды прокрутки календаря прокручивают по одному
месяцу за раз.  Это означает, что между отображением до команды и
отображением после делается два месяца перекрытия.  <KBD>C-x &#60;</KBD>
прокручивает содержимое календаря на месяц влево; то есть она перемещает
вид вперед по времени.  <KBD>C-x &#62;</KBD> прокручивает содержимое календаря
вправо, что перемещает назад во времени.


<P>
<A NAME="IDX2159"></A>
<A NAME="IDX2160"></A>
<A NAME="IDX2161"></A>
<A NAME="IDX2162"></A>
  Команды <KBD>C-v</KBD> и <KBD>M-v</KBD> прокручивают календарь по целым экранам
--- по три месяца -- по аналогии с обычным значением этих команд.
<KBD>C-v</KBD> делает видимыми более поздние даты, а <KBD>M-v</KBD> -- более
ранние.  Эти команды принимают числовой аргумент в качестве счетчика
повторов; в частности, так как <KBD>C-u</KBD> умножает следующую команду на
четыре, набор <KBD>C-u C-v</KBD> прокручивает календарь на год вперед, а
<KBD>C-u M-v</KBD> прокручивает на год назад.


<P>
  Функциональные клавиши <KBD>NEXT</KBD> и <KBD>PRIOR</KBD> эквивалентны <KBD>C-v</KBD>
и <KBD>M-v</KBD>, как и в других режимах.




<H2><A NAME="SEC393" HREF="emacs_toc.html#TOC393">Посчет дней</A></H2>

<DL COMPACT>

<DT><KBD>M-=</KBD>
<DD>
Выводит число дней в текущей области
(<CODE>calendar-count-days-region</CODE>).
</DL>

<P>
<A NAME="IDX2163"></A>
<A NAME="IDX2164"></A>
  Чтобы определить число дней в области, наберите <KBD>M-=</KBD>
(<CODE>calendar-count-days-region</CODE>).  Количество дней выводится
<EM>включительно</EM>; то есть дни, указываемые точкой и меткой,
учитываются.




<H2><A NAME="SEC394" HREF="emacs_toc.html#TOC394">Другие команды календаря</A></H2>

<DL COMPACT>

<DT><KBD>p d</KBD>
<DD>
Выводит номер дня в году (<CODE>calendar-print-day-of-year</CODE>).
<DT><KBD>C-c C-l</KBD>
<DD>
Заново генерирует окно календаря (<CODE>redraw-calendar</CODE>).
<DT><KBD>SPC</KBD>
<DD>
Прокручивает следующее окно (<CODE>scroll-other-window</CODE>).
<DT><KBD>q</KBD>
<DD>
Выходит из календаря (<CODE>exit-calendar</CODE>).
</DL>

<P>
<A NAME="IDX2165"></A>
<A NAME="IDX2166"></A>
<A NAME="IDX2167"></A>
  Чтобы напечатать число дней, прошедших с начала года или остающихся до
конца года, наберите команду <KBD>p d</KBD>
(<CODE>calendar-print-day-of-year</CODE>).  Она покажет оба этих числа в
эхо-области.  Количество прошедших дней включает выбранную дату.  Число
оставшихся дней не включает ее.


<P>
<A NAME="IDX2168"></A>
<A NAME="IDX2169"></A>
  Если окно календаря окажется испорчено, наберите <KBD>C-c C-l</KBD>
(<CODE>redraw-calendar</CODE>) чтобы его перерисовать.  (Такое может
случиться, только если вы используете команды редактирования не из
режима Calendar.)


<P>
<A NAME="IDX2170"></A>
  В режиме Calendar вы можете использовать <KBD>SPC</KBD>
(<CODE>scroll-other-window</CODE>) для прокрутки другого окна.  Это удобно,
если вы смотрите в другом окне список праздников или записи ежедневника.


<P>
<A NAME="IDX2171"></A>
<A NAME="IDX2172"></A>
  Чтобы выйти из календаря, наберите <KBD>q</KBD> (<CODE>exit-calendar</CODE>).
Эта команда прячет все буферы, связанные с календарем, и выбирает другие
буферы.  (Если фрейм содержит специально назначенное окно календаря,
выход из календаря минимизирует этот фрейм.)




<H2><A NAME="SEC395" HREF="emacs_toc.html#TOC395">LaTeX и календарь</A></H2>
<P>
<A NAME="IDX2173"></A>


<P>
  Команды календаря для работы с LaTeX генерируют буфер с
LaTeX-кодом, который печатает календарь.  В зависимости от
использованой команды напечатанный календарь покрывает день, неделю,
месяц или год, в котором находится точка.


<P>
<A NAME="IDX2174"></A>
<DL COMPACT>

<DT><KBD>t m</KBD>
<DD>
Генерирует календарь на один месяц (<CODE>cal-tex-cursor-month</CODE>).
<DT><KBD>t M</KBD>
<DD>
Генерирует горизонтальный календарь на один месяц
(<CODE>cal-tex-cursor-month-landscape</CODE>).
<DT><KBD>t d</KBD>
<DD>
Генерирует календарь на один день (<CODE>cal-tex-cursor-day</CODE>).
<DT><KBD>t w 1</KBD>
<DD>
Генерирует одностраничный календарь на одну неделю
(<CODE>cal-tex-cursor-week</CODE>).
<DT><KBD>t w 2</KBD>
<DD>
Генерирует двухстраничный календарь на одну неделю
(<CODE>cal-tex-cursor-week2</CODE>).
<DT><KBD>t w 3</KBD>
<DD>
Генерирует календарь в стиле ISO на одну неделю
(<CODE>cal-tex-cursor-week-iso</CODE>).
<DT><KBD>t w 4</KBD>
<DD>
Генерирует календарь на одну неделю, начинающуюся с понедельника
(<CODE>cal-tex-cursor-week-monday</CODE>).
<DT><KBD>t f w</KBD>
<DD>
Генерирует двухнедельный календарь на одной странице в стиле Filofax
(<CODE>cal-tex-cursor-filofax-2week</CODE>).
<DT><KBD>t f W</KBD>
<DD>
Генерирует недельный календарь на одной странице в стиле Filofax
(<CODE>cal-tex-cursor-filofax-week</CODE>).
<DT><KBD>t y</KBD>
<DD>
Генерирует календарь на один год (<CODE>cal-tex-cursor-year</CODE>).
<DT><KBD>t Y</KBD>
<DD>
Генерирует горизонтальный календарь на один год
(<CODE>cal-tex-cursor-year-landscape</CODE>).
<DT><KBD>t f y</KBD>
<DD>
Генерирует календарь на один год в стиле Filofax
(<CODE>cal-tex-cursor-filofax-year</CODE>).
</DL>

<P>
  Некоторые из этих команд печатают календарь горизонально (в
"ландшафтном режиме"), поэтому его ширина может быть больше длины.
Некоторые из них используют размер бумаги Filofax (3.75 на 6.75 дюймов).
Все эти команды принимают префиксный аргумент, задающий число печатаемых
дней, недель, месяцев или лет (всегда начиная от текущего).


<P>
  Если переменная <CODE>cal-tex-holidays</CODE> не равна <CODE>nil</CODE> (это
значение по умолчанию), то печатаемые календари показывают праздники из
<CODE>calendar-holidays</CODE>.  Если переменная <CODE>cal-tex-diary</CODE> отлична
от <CODE>nil</CODE> (по умолчанию это <CODE>nil</CODE>), также включаются записи из
дневника (только в недельные и месячные календари).  Если отлична от
<CODE>nil</CODE> переменная <CODE>cal-tex-rules</CODE> (по умолчанию <CODE>nil</CODE>), то
в тех стилях распечатки календаря, где достаточно места, страницы
разлинованы.




<H2><A NAME="SEC396" HREF="emacs_toc.html#TOC396">Праздники</A></H2>
<P>
<A NAME="IDX2175"></A>


<P>
  Календарь Emacs знает обо всех больших и о многих малых праздниках и
может их отображать.


<DL COMPACT>

<DT><KBD>h</KBD>
<DD>
Показать праздники, приходящиеся на выбранную дату
(<CODE>calendar-cursor-holidays</CODE>).
<DT><KBD>Mouse-2 Holidays</KBD>
<DD>
Показать все праздники для даты, на которой вы щелкнули.
<DT><KBD>x</KBD>
<DD>
Пометить праздники (<CODE>mark-calendar-holidays</CODE>).
<DT><KBD>u</KBD>
<DD>
Снять метки в окне календаря (<CODE>calendar-unmark</CODE>).
<DT><KBD>a</KBD>
<DD>
Перечислить в другом окне все праздники для показанных трех месяцев
(<CODE>list-calendar-holidays</CODE>).
<DT><KBD>M-x holidays</KBD>
<DD>
Перечислить в другом окне все праздники для трех месяцев вокруг текущей
даты.
<DT><KBD>M-x list-holidays</KBD>
<DD>
Перечислить в другом окне праздники для заданного промежутка лет.
</DL>

<P>
<A NAME="IDX2176"></A>
<A NAME="IDX2177"></A>
  Чтобы узнать, не приходится ли на данную дату праздников, расположите
точку на этой дате в окне календаря и используйте команду <KBD>h</KBD>.  Или
щелкните на этой дате <KBD>Mouse-2</KBD> и затем выберите из появившегося
меню пункт <KBD>Holidays</KBD>.  В обоих случаях выводятся праздники для
заданной даты, в эхо-области, если они там умещаются, или в отдельном
окне.


<P>
<A NAME="IDX2178"></A>
<A NAME="IDX2179"></A>
<A NAME="IDX2180"></A>
<A NAME="IDX2181"></A>
  Чтобы просмотреть распределение праздников для всех показанных в
календаре дат, используйте команду <KBD>x</KBD>.  Она отображает праздничные
дни другим начертанием (или помещает после этих дат значок <SAMP>`*'</SAMP>,
если множественные начертания недоступны).  Эта команда применяется и к
месяцам, видимым в данный момент, и к тем, что станут впоследствии
видимыми при прокрутке.  Чтобы выключить разметку и стереть текущие
метки, наберите <KBD>u</KBD>, что также стирает метки дневника
(see section <A HREF="emacs_34.html#SEC404">Дневник</A>).


<P>
<A NAME="IDX2182"></A>
<A NAME="IDX2183"></A>
  Чтобы получить еще более подробную информацию, используйте команду
<KBD>a</KBD>, которая показывает отдельный буфер, содержащий список всех
праздников в текущем трехмесячном диапазоне.  Вы можете использовать
<KBD>SPC</KBD> в окне календаря для прокрутки этого списка.


<P>
<A NAME="IDX2184"></A>
  Команда <KBD>M-x holidays</KBD> выводит список праздников для текущего,
предыдущего и следующего месяца; она работает, даже если у вас нет окна
календаря.  Если вы хотите получить перечень праздников, центрированный
вокруг другого месяца, используйте <KBD>C-u M-x holidays</KBD>, которая
спрашивает месяц и год.


<P>
  Известные Emacs праздники включают праздники США и основные
христианские, иудейские и исламские праздники; также он знает о
солнцестояниях и равноденствиях.


<P>
<A NAME="IDX2185"></A>
  Команда <KBD>M-x list-holidays</KBD> выводит список праздников для
нескольких лет.  Эта функция запрашивает у вас начальный и конечный год
и позволяет выбрать все праздники или одну из их категорий.  Вы можете
использовать эту команду, даже если у вас нет окна календаря.


<P>
  Emacs использует для праздников даты, основанные на <EM>текущей
практике</EM>, а не на исторических фактах.  К примеру, исторически момент
сезонного перевода времени и даже само его существование изменялось от
года к году, но текущий закон США говорит, что время переводится в
первое воскресенье апреля.  Когда правила сезонного перевода времени
установлены по американским нормам, Emacs всегда использует текущее
определение, даже если оно было неправильно в некоторые прошлые годы.




<H2><A NAME="SEC397" HREF="emacs_toc.html#TOC397">Время восхода и заката Солнца</A></H2>
<P>
<A NAME="IDX2186"></A>


<P>
  Особые команды календаря могут сообщить вам с точностью до минуты-двух
времена восхода и заката Солнца для любой даты.


<DL COMPACT>

<DT><KBD>S</KBD>
<DD>
Показывает времена восхода и заката Солнца для выбранной даты
(<CODE>calendar-sunrise-sunset</CODE>).
<DT><KBD>Mouse-2 Sunrise/Sunset</KBD>
<DD>
Показывает времена восхода и заката Солнца для даты, на которой вы
щелкнули.
<DT><KBD>M-x sunrise-sunset</KBD>
<DD>
Показывает времена восхода и заката Солнца для сегодняшней даты.
<DT><KBD>C-u M-x sunrise-sunset</KBD>
<DD>
Показывает времена восхода и заката Солнца для заданной даты.
</DL>

<P>
<A NAME="IDX2187"></A>
<A NAME="IDX2188"></A>
<A NAME="IDX2189"></A>
  Чтобы просмотреть в эхо-области <EM>местное время</EM> восхода и заката
Солнца, находясь в календаре, переместите точку к желаемой дате и
нажмите <KBD>S</KBD>.  Или щелкните на этой дате <KBD>Mouse-2</KBD> и выберите из
появившегося меню пункт <KBD>Sunrise/Sunset</KBD>.  Команда <KBD>M-x
sunrise-sunset</KBD>, доступная извне календаря, показывает эту информацию
для текущей или указанной даты.  Чтобы задать отличную от сегодняшней
дату, используйте команду <KBD>C-u M-x sunrise-sunset</KBD>, которая спросит
год, месяц и день.


<P>
  Вы можете просмотреть время восхода и заката Солнца для любой
местности и даты с помощью <KBD>C-u C-u M-x sunrise-sunset</KBD>.  Эта
команда запрашивает вас широту, долготу, разницу от универсального
координированного времени и дату, а затем сообщает вам времена восхода и
заката для этого места и этой даты.


<P>
  Поскольку время восхода и заката Солнца зависит от положения на Земле,
перед использованием этих команд вы должны сказать Emacs вашу широту,
долготу и название местности.  Вот пример задаваемых значений:


<P>
<A NAME="IDX2190"></A>
<A NAME="IDX2191"></A>
<A NAME="IDX2192"></A>

<PRE>
(setq calendar-latitude 40.1)
(setq calendar-longitude -88.2)
(setq calendar-location-name "Urbana, IL")
</PRE>

<P>
Задавайте значения <CODE>calendar-latitude</CODE> и <CODE>calendar-longitude</CODE>
с точностью до одной десятой.


<P>
  Ваш часовой пояс также влияет на время восхода и заката.  Обычно Emacs
получает информацию о часовом поясе от операционной системы, но если это
не те значения, которые вы хотите (или если операционная система их не
предоставляет), вы должны установить их сами.  Вот пример:


<P>
<A NAME="IDX2193"></A>
<A NAME="IDX2194"></A>
<A NAME="IDX2195"></A>

<PRE>
(setq calendar-time-zone -360)
(setq calendar-standard-time-zone-name "CST")
(setq calendar-daylight-time-zone-name "CDT")
</PRE>

<P>
Значение <CODE>calendar-time-zone</CODE> -- это разница между вашим местным
стандартным и универсальным координированным (гринвичским) временем,
выраженная в минутах.  Значения <CODE>calendar-standard-time-zone-name</CODE>
и <CODE>calendar-daylight-time-zone-name</CODE> -- это сокращения, принятые
для обозначения вашего часового пояса.  Emacs показывает время восхода и
заката в <EM>с учетом сезонного перевода часов</EM>.  See section <A HREF="emacs_34.html#SEC411">Сезонный перевод времени</A>, о том, как определяется сезонная
поправка.


<P>
  Как пользователь, вы можете счесть удобным установить переменные
календаря для задания вашего обычного физического местонахождения в
вашем файле <TT>`.emacs'</TT>.  А когда вы устанавливаете Emacs на машине,
вы можете создать файл <TT>`default.el'</TT>, который будет правильно их
устанавливать для типичного местонахождения большинства пользователей
этой машины.  See section <A HREF="emacs_36.html#SEC470">Файл инициализации, <TT>`~/.emacs'</TT></A>.




<H2><A NAME="SEC398" HREF="emacs_toc.html#TOC398">Фазы Луны</A></H2>
<P>
<A NAME="IDX2196"></A>
<A NAME="IDX2197"></A>


<P>
  Эти команды календаря показывают даты и времена лунных фаз (новолуние,
первая четверть, полнолуние, последняя четверть).  Эта возможность
полезна при отладке проблем, которые "зависят от фазы Луны".


<DL COMPACT>

<DT><KBD>M</KBD>
<DD>
Выводит даты и времена всех четвертей Луны для показанного трехмесячного
периода (<CODE>calendar-phases-of-moon</CODE>).
<DT><KBD>M-x phases-of-moon</KBD>
<DD>
Выводит даты и времена четвертей Луны для трех месяцев вокруг
сегодняшней даты.
</DL>

<P>
<A NAME="IDX2198"></A>
<A NAME="IDX2199"></A>
  Внутри календаря, для показа в отдельном буфере фаз Луны для текущего
трехмесячного периода используется команда <KBD>M</KBD>.  Перечислямые даты и
времена точны до нескольких минут.


<P>
<A NAME="IDX2200"></A>
  Вне календаря, для показа фаз Луны для текущего, предыдущего и
следующего месяца используйте команду <KBD>M-x phases-of-moon</KBD>.  Чтобы
получить сведения для какого-то другого месяца, используйте <KBD>C-u M-x
phases-of-moon</KBD>, она спросит вас о месяце и годе.


<P>
  Даты и времена лунных фаз даются в местном времени (с учетом сезонных
поправок, если это необходимо); но если переменная
<CODE>calendar-time-zone</CODE> не определена, используется универсальное
координированное время (гринвичский часовой пояс).  See section <A HREF="emacs_34.html#SEC411">Сезонный перевод времени</A>.




<H2><A NAME="SEC399" HREF="emacs_toc.html#TOC399">Преобразование в другие календарные системы и из них</A></H2>

<P>
<A NAME="IDX2201"></A>
  В Emacs <EM>всегда</EM> показывается григорианский календарь, иногда
называемый календарем "нового стиля", который в наши дни применяется
почти везде.  Однако, этот календарь не существовал до шестнадцатого
столетия и не использовался широко до восемнадцатого; только в начале
девятнадцатого века он полностью вытеснил юлианский календарь и получил
всемирное признание.  Календарь Emacs может отобразить любой месяц
начиная от января первого года нашей эры, но всегда показывает
григорианский календарь, даже для дат, когда его еще не существовало.


<P>
  Хотя Emacs не может показывать другие календари, он умеет
преобразовавать даты из нескольких других календарных систем.




<H3><A NAME="SEC400" HREF="emacs_toc.html#TOC400">Поддерживаемые календарные системы</A></H3>

<P>
<A NAME="IDX2202"></A>
  Коммерческий календарь ISO используется в основном в Европе.


<P>
<A NAME="IDX2203"></A>
  Юлианский календарь, названный в честь Юлия Цезаря, использовался в
Европе в средние века и во многих других странах вплоть до
девятнадцатого века.


<P>
<A NAME="IDX2204"></A>
<A NAME="IDX2205"></A>
  Астрономы используют простой подсчет дней, истекших от полудня
понедельника, первого января, 4713-го года до нашей эры по юлианскому
календарю.  Число прошедших дней называется <EM>юлианским</EM> или
<EM>астрономическим номером дня</EM>.


<P>
<A NAME="IDX2206"></A>
  Иудейский календарь по традиции используется в еврейской религии.
Календарная программа Emacs использует иудейский календарь для
определения дат еврейских праздников.  Даты иудейского календаря
начинаются и завершаются при заходе Солнца.


<P>
<A NAME="IDX2207"></A>
  Исламский календарь используется во многих мусульманских странах.
Emacs использует его для определения дат исламских праздников.  В
исламском мире нет всеобщей договоренности о календаре; в Emacs
применяется широко распространенная версия, но точные даты исламского
календаря часто основываются на высказываниях религиозных авторитетов, а
не на вычислениях.  Как следствие, действительные даты наблюдения могут
слегка отличаться от вычисленных в Emacs.  Даты исламского календаря
начинаются и завершаются при заходе Солнца.


<P>
<A NAME="IDX2208"></A>
  Календарь французской революции был создан якобинцами после революции
1789-го года для введения более светского и основанного на
представлениях о природе взгляда на годовой цикл и для установления
десятидневной недели, более рационалистической, как метрическая система.
Французское правительство официально отменило этот календарь в конце
1805-го года.


<P>
<A NAME="IDX2209"></A>
  Центральноамериканские Майя использовали три разные, перекрывающиеся
календарные системы, <EM>долгий счет</EM>, <EM>тцолкин</EM> и <EM>хааб</EM>.
Emacs знает обо всех трех календарях.  Эксперты обсуждают точное
соответствие между календарем Майя и нашим календарем; Emacs использует
для вычислений корреляцию Гудмана-Мартинеса-Томсона.


<P>
<A NAME="IDX2210"></A>
<A NAME="IDX2211"></A>
  Копты используют календарь, основанный на древнеегипетском солнечном
календаре.  Он состоит из двенадцати тридцатидневных месяцев, за которым
идет дополнительный пятидневный период.  Раз в четыре года к этому
периоду добавляется шестой, високосный день.  Эфиопский календарь
обладает такой же структурой, но в нем другие номера лет и названия
месяцев.


<P>
<A NAME="IDX2212"></A>
  Персы используют солнечный календарь, основанный на разработках Омара
Хайама.  Их календарь состоит из двенадцати месяцев, первые шесть из
которых содержат 31 дней, следующие пять -- 30 дней, а в последнем 29
дней в обычные года и 30 дней в високосные.  Високосные года случаются
по сложному образцу каждые четыре или пять лет.


<P>
<A NAME="IDX2213"></A>
  Китайский календарь -- это сложная система лунных месяцев,
скомбинированных с солнечными годами.  Годы проходят по циклам из
шестидесяти лет, обычный год содержит 12 месяцев, високосный -- 13; в
каждом месяце либо 29, либо 30 дней.  Каждый год, обычный месяц и день
именуется комбинацией одного из десяти "небесных стеблей" и одной из
двенадцати "земных ветвей", в общей сложности есть шестьдесят имен,
которые проходят по кругу.




<H3><A NAME="SEC401" HREF="emacs_toc.html#TOC401">Преобразование в другой календарь</A></H3>

<P>
  Следующие команды описывают выбранную дату (дату, в которой находится
точка) в различных календарных системах:


<DL COMPACT>

<DT><KBD>Mouse-2  Other Calendars</KBD>
<DD>
Выводит дату, на которой вы щелкнули, выраженную через различные другие
календари.
<A NAME="IDX2214"></A>
<A NAME="IDX2215"></A>
<DT><KBD>p c</KBD>
<DD>
Выводит эквивалент выбранного дня в коммерческом календаре ISO
(<CODE>calendar-print-iso-date</CODE>).
<A NAME="IDX2216"></A>
<DT><KBD>p j</KBD>
<DD>
Выводит юлианскую дату для выбранного дня
(<CODE>calendar-print-julian-date</CODE>).
<A NAME="IDX2217"></A>
<DT><KBD>p a</KBD>
<DD>
Выводит астрономический (юлианский) номер дня для выбранной даты
(<CODE>calendar-print-astro-day-number</CODE>).
<A NAME="IDX2218"></A>
<DT><KBD>p h</KBD>
<DD>
Показывает иудейскую дату для выбранного дня
(<CODE>calendar-print-hebrew-date</CODE>).
<A NAME="IDX2219"></A>
<DT><KBD>p i</KBD>
<DD>
Показывает исламскую дату для выбранного дня
(<CODE>calendar-print-islamic-date</CODE>).
<A NAME="IDX2220"></A>
<DT><KBD>p f</KBD>
<DD>
Показывает французскую революционную дату для выбранного дня
(<CODE>calendar-print-french-date</CODE>).
<A NAME="IDX2221"></A>
<DT><KBD>p C</KBD>
<DD>
Показывает китайскую дату для выбранного дня
(<CODE>calendar-print-chinese-date</CODE>).
<A NAME="IDX2222"></A>
<DT><KBD>p k</KBD>
<DD>
Показывает коптскую дату для выбранного дня
(<CODE>calendar-print-coptic-date</CODE>).
<A NAME="IDX2223"></A>
<DT><KBD>p e</KBD>
<DD>
Показывает эфиопскую дату для выбранного дня
(<CODE>calendar-print-ethiopic-date</CODE>).
<A NAME="IDX2224"></A>
<DT><KBD>p p</KBD>
<DD>
Показывает дату персидского календаря для выбранного дня
(<CODE>calendar-print-persian-date</CODE>).
<A NAME="IDX2225"></A>
<DT><KBD>p m</KBD>
<DD>
Показывает дату календаря Майя для выбранного дня
(<CODE>calendar-print-mayan-date</CODE>).
</DL>

<P>
  Если вы используете X, простейший способ перевести дату в другие
календари -- щелкнуть на ней <KBD>Mouse-2</KBD> и выбрать из появившегося
меню пункт <KBD>Other Calendars</KBD>.  Это покажет в виде меню эквивалентные
формы для данной даты во всех календарях, которые понимает Emacs.
(Выбор альтернатив из этого меню не делает ничего -- оно используется
только для показа.)


<P>
  Переместите точку к желаемой дате в григорианском календаре и нажмите
подходящие клавиши.  <KBD>p</KBD> -- это мнемоника для "print", поскольку
Emacs "печатает" эквивалентную дату в эхо-области.




<H3><A NAME="SEC402" HREF="emacs_toc.html#TOC402">Преобразование из другого календаря</A></H3>

<P>
  Вы можете использовать поддерживаемые календари для задания даты, к
которой следует переместиться.  Этот раздел описывает команды для
проделывания этого во всех календарях, кроме майянского; чтобы узнать,
как это сделать для календаря Майя, смотрите следующий раздел.


<P>
<A NAME="IDX2226"></A>
<A NAME="IDX2227"></A>
<A NAME="IDX2228"></A>
<A NAME="IDX2229"></A>
<A NAME="IDX2230"></A>
<A NAME="IDX2231"></A>
<A NAME="IDX2232"></A>
<A NAME="IDX2233"></A>
<A NAME="IDX2234"></A>
<A NAME="IDX2235"></A>
<A NAME="IDX2236"></A>
<DL COMPACT>

<DT><KBD>g c</KBD>
<DD>
Переход к дате, заданной в коммерческом календаре ISO
(<CODE>calendar-goto-iso-date</CODE>).
<DT><KBD>g j</KBD>
<DD>
Переход к дате, заданной в юлианском календаре
(<CODE>calendar-goto-julian-date</CODE>).
<DT><KBD>g a</KBD>
<DD>
Переход к дате, заданной астрономическим (юлианским) номером дня
(<CODE>calendar-goto-astro-day-number</CODE>).
<DT><KBD>g h</KBD>
<DD>
Переход к дате, заданной в иудейском календаре
(<CODE>calendar-goto-hebrew-date</CODE>).
<DT><KBD>g i</KBD>
<DD>
Переход к дате, заданной в исламском календаре
(<CODE>calendar-goto-islamic-date</CODE>).
<DT><KBD>g f</KBD>
<DD>
Переход к дате, заданной во французском революционном календаре
(<CODE>calendar-goto-french-date</CODE>).
<DT><KBD>g C</KBD>
<DD>
Переход к дате, заданной в китайском календаре
(<CODE>calendar-goto-chinese-date</CODE>).
<DT><KBD>g p</KBD>
<DD>
Переход к дате, заданной в персидском календаре
(<CODE>calendar-goto-persian-date</CODE>).
<DT><KBD>g k</KBD>
<DD>
Переход к дате, заданной в коптском календаре
(<CODE>calendar-goto-coptic-date</CODE>).
<DT><KBD>g e</KBD>
<DD>
Переход к дате, заданной в эфиопском календаре
(<CODE>calendar-goto-ethiopic-date</CODE>).
</DL>

<P>
  Эти команды запрашивают у вас дату из другого календаря, перемещают
точку к эквивалентной дате григорианского календаря и показывают дату
другого календаря в эхо-области.  При считывании названия месяца Emacs
использует строгое завершение (see section <A HREF="emacs_10.html#SEC39">Завершение</A>), поэтому вам не нужно
беспокоиться о правильности написания иудейских, исламских или
французских названий.


<P>
<A NAME="IDX2237"></A>
<A NAME="IDX2238"></A>
  Один из вопросов, часто возникающих в связи с иудейским календарем,
--- вычисление годовщины смерти, называемой "yahrzeit".  Календарь
Emacs включает средства для таких вычислений.  Если вы находитесь в
календаре, команда <KBD>M-x list-yahrzeit-dates</KBD> спрашивает вас о
промежутке лет и затем показывает для этого промежутка список yahrzeit
для даты в точке.  Если вы не в календаре, эта команда сначала спросит о
дате смерти и промежутке лет, а затем покажет список дат yahrzeit.




<H3><A NAME="SEC403" HREF="emacs_toc.html#TOC403">Преобразование из календаря Майя</A></H3>

<P>
  Это команды для выбора дат, оснаванных на календаре Майя:


<DL COMPACT>

<DT><KBD>g m l</KBD>
<DD>
Переходит к дате, заданной календарем долгого счета
(<CODE>calendar-goto-mayan-long-count-date</CODE>).
<DT><KBD>g m n t</KBD>
<DD>
Переходит к следующему появлению некоторого места в календаре тцолкин
(<CODE>calendar-next-tzolkin-date</CODE>).
<DT><KBD>g m p t</KBD>
<DD>
Переходит к предыдущему появлению некоторого места в календаре тцолкин
(<CODE>calendar-previous-tzolkin-date</CODE>).
<DT><KBD>g m n h</KBD>
<DD>
Переходит к следующему появлению некоторого места в календаре хааб
(<CODE>calendar-next-haab-date</CODE>).
<DT><KBD>g m p h</KBD>
<DD>
Переходит к предыдущему появлению некоторого места в календаре хааб
(<CODE>calendar-previous-haab-date</CODE>).
<DT><KBD>g m n c</KBD>
<DD>
Переходит к следующему появлению некоторого места в календарном круге
(<CODE>calendar-next-calendar-round-date</CODE>).
<DT><KBD>g m p c</KBD>
<DD>
Переходит к предыдущему появлению некоторого места в календарном круге
(<CODE>calendar-previous-calendar-round-date</CODE>).
</DL>

<P>
<A NAME="IDX2239"></A>
  Чтобы понять эти команды, вы должны понимать календари Майя.
<EM>Долгий счет</EM> -- это подсчет дней в следующих единицах:



<PRE>
1 кин = 1 день   1 уинал = 20 кин   1 тун = 18 уинал
1 катун = 20 тун   1 бактун = 20 катун
</PRE>

<P>
<A NAME="IDX2240"></A>
<A NAME="IDX2241"></A>
Таким образом, дата 12.16.11.16.6 в долгом счете означает 12 бактун, 16
катун, 11 тун, 16 уинал и 6 кин.  Календарь Emacs может обрабатывать
майянские даты долгого счета от 7.17.18.13.1, но не более ранние.  Когда
вы используете команду <KBD>g m l</KBD>, набирайте майянскую дату долгого
счета, разделяя бактун, катун, тун, уинал и кин точками.


<P>
<A NAME="IDX2242"></A>
<A NAME="IDX2243"></A>
<A NAME="IDX2244"></A>
  Майянский календарь тцолкин -- это цикл из 260 дней, формируемый
парой независимых циклов из 13 и 20 дней.  Поскольку этот цикл
повторяется бесконечно, Emacs предоставляет команды для перемещения
назад и вперед к предыдущей или следующей точке цикла.  Наберите <KBD>g
m p t</KBD>, чтобы перейти к предыдущей дате в тцолкин; Emacs спросит у вас
дату в тцолкин и переместит точку к предыдущему появлению этой даты.
Аналогично, наберите <KBD>g m n t</KBD>, чтобы перейти к следующему появлению
даты в тцолкин.


<P>
<A NAME="IDX2245"></A>
<A NAME="IDX2246"></A>
<A NAME="IDX2247"></A>
  Майянский календарь хааб -- это цикл из 365 дней, собранный из 18
месяцев по 20 в каждом, за которыми следует пятидневный период без
месяца.  Подобно циклу тцолкин, этот цикл повторяется бесконечно, и есть
команды для перехода назад и вперед к предыдущей или следующей точке
этого цикла.  Наберите <KBD>g m p h</KBD>, чтобы перейти к предыдущей дате
хааб; Emacs спросит у вас дату в хааб и переместит точку к предыдущему
появлению этой даты.  Аналогично, наберите <KBD>g m n h</KBD>, чтобы перейти
к следующему появлению даты в хааб.


<P>
<A NAME="IDX2248"></A>
<A NAME="IDX2249"></A>
 Майя также использовали комбинацию дат тцолкин и хааб.  Эта комбинация
--- цикл примерно в 52 года, назыавемый <EM>календарным кругом</EM>.  Если
вы наберете <KBD>g m p c</KBD>, Emacs спросит у вас даты хааб и тцолкин и
затем переместит точку к предыдущему появлению этой комбинации.
Используйте <KBD>g m n c</KBD> для перемещения точки к следующему появлению
комбинации.  Эти команды сообщают об ошибке, если набранная вами
комбинация дат хааб/тцолкин невозможна.


<P>
  При запросе майянской даты Emacs использует строгое завершение
(see section <A HREF="emacs_10.html#SEC42">Строгое завершение</A>), поэтому вам не нужно беспокоиться о
правильности написания.




<H2><A NAME="SEC404" HREF="emacs_toc.html#TOC404">Дневник</A></H2>
<P>
<A NAME="IDX2250"></A>


<P>
  С помощью дневника Emacs можно прослеживать назначенные встречи и
другие события на ежедневной основе и в совокупности с календарем.
Чтобы воспользоваться этими возможностями, вы должны сначала создать
<EM>файл дневника</EM>, содержащий перечень событий и их дат.  Тогда Emacs
сможет автоматически подобрать и показать вам события на сегодняшний
день, на ближайшее будущее или для указанной даты.


<P>
  По умолчанию в качестве файла дневника Emacs использует файл
<TT>`~/diary'</TT>.  Это тот же самый файл, что применяеися в утилите
@command{calendar}.  Вот пример файла <TT>`~/diary'</TT>:



<PRE>
12/22/1988  Twentieth wedding anniversary!!
&#38;1/1.       Happy New Year!
10/22       Ruth's birthday.
* 21, *:    Payday
Tuesday--weekly meeting with grad students at 10am
         Supowit, Shen, Bitner, and Kapoor to attend.
1/13/89     Friday the thirteenth!!
&#38;thu 4pm    squash game with Lloyd.
mar 16      Dad's birthday
April 15, 1989 Income tax due.
&#38;* 15       time cards due.
</PRE>

<P>
В данном примере для выравнивания описаний в большинстве вхождений
событий использованы пробелы.  Такое форматирование полностью является
делом вкуса.


<P>
  Хотя вероятнее всего вы начнете составлять ежедневник вручную, Emacs
предоставляет вам несколько команд для просмотра, добавления и изменения
записей дневника.




<H3><A NAME="SEC405" HREF="emacs_toc.html#TOC405">Команды для просмотра записей в дневнике</A></H3>

<P>
  После того как вы создали файл <TT>`~/diary'</TT>, вы можете просматривать
его из календаря.  Вы также можете просмотреть список сегодняшних
событий извне режима Calendar.


<DL COMPACT>

<DT><KBD>d</KBD>
<DD>
Показывает все записи дневника для выбранной даты
(<CODE>view-diary-entries</CODE>).
<DT><KBD>Mouse-2 Diary</KBD>
<DD>
Показывает все записи дневника для даты, на которой вы щелкнули.
<DT><KBD>s</KBD>
<DD>
Показывает весь файл дневника (<CODE>show-all-diary-entries</CODE>).
<DT><KBD>m</KBD>
<DD>
Помечает все видимые даты, для которых есть записи в дневнике
(<CODE>mark-diary-entries</CODE>).
<DT><KBD>u</KBD>
<DD>
Убирает метки из окна календаря (<CODE>calendar-unmark</CODE>).
<DT><KBD>M-x print-diary-entries</KBD>
<DD>
Печатает твердую копию отображаения дневника в том виде, в каком он есть
на экране.
<DT><KBD>M-x diary</KBD>
<DD>
Показывает все вхождения дневника для сегодняшней даты.
<DT><KBD>M-x diary-mail-entries</KBD>
<DD>
Отправляет вам по почте напоминание о предстоящих событиях.
</DL>

<P>
<A NAME="IDX2251"></A>
<A NAME="IDX2252"></A>
  
  Отображение записей дневника с помощью <KBD>d</KBD> показывает в отдельном
окне вхождения дневника для выбранной в календаре даты.  Строка режима
нового окна показывает дату для этих записей и все выпадающие на нее
праздники.  Если вы зададите для <KBD>d</KBD> числовой аргумент, она покажет
все записи дневника на указанное число дней.  То есть, <KBD>2 d</KBD> покажет
все записи для выбранной даты и для следующего дня.


<P>
  Другой способ просмотреть записи дневника для какой-либо даты ---
щелкнуть на этой дате <KBD>Mouse-2</KBD>, а затем выбрать из появившегося
меню пункт <KBD>Diary</KBD>.


<P>
<A NAME="IDX2253"></A>
<A NAME="IDX2254"></A>
  Чтобы получить более широкий обзор упомянутых в календаре дней,
используйте команду <KBD>m</KBD>.  Она показывает даты, для которых в
дневнике есть записи, другим начертанием (или помещает после них знак
<SAMP>`+'</SAMP>, если дисплей не может отобразить несколько начертаний).  Эта
команда применяется как к видимым в данный момент месяцам, так и к
остальным, которые становятся видимыми при последующей прокрутке.  Чтобы
выключить разметку и стереть текущие метки, нажмите <KBD>u</KBD>, что
выключает также и метки праздников (see section <A HREF="emacs_34.html#SEC396">Праздники</A>).


<P>
<A NAME="IDX2255"></A>
<A NAME="IDX2256"></A>
  Чтобы увидеть файл дневника полностью, а не только некоторые его
вхождения, используйте команду <KBD>s</KBD>.


<P>
  При выводе избранных записей дневника применяется средство выборочного
показа, чтобы скрыть ненужные записи.


<P>
  Буфер дневника в той форме, как вы его видите -- это иллюзия, поэтому
простая его печать не даст то, что вы видите на экране.  Для получения
твердой копии буфера дневника <EM>таким, каким он виден</EM>, есть особая
команда; это команда <KBD>M-x print-diary-entries</KBD>.  Она посылает данные
непосредственно на принтер.  Вы можете настраивать ее, как
<CODE>lpr-region</CODE> (see section <A HREF="emacs_35.html#SEC428">Вывод твердой копии</A>).


<P>
<A NAME="IDX2257"></A>
  Команда <KBD>M-x diary</KBD> показывает записи дневника для текущей даты,
независимо от того, виден ли календарь, и кроме того, возможно, для
нескольких следующих дней; переменная <CODE>number-of-diary-entries</CODE>
задает число включаемых дней.  @xref{Calendar, Customizing the Calendar and Diary,, @external{elisp}, The Emacs Lisp Reference Manual}.


<P>
  Если вы поместите в ваш файл <TT>`.emacs'</TT> строку <CODE>(diary)</CODE>, то
при входе в Emacs вам будет автоматически показываться окно с записями
дневника на сегодняшний день.  Строка режима этого окна показывает дату
и выпадающие на нее праздники.


<P>
<A NAME="IDX2258"></A>
<A NAME="IDX2259"></A>
  Многим пользователям нравится получать напоминания о событиях из
ежедневника по почте.  Чтобы послать себе такие сообщения, используйте
команду <KBD>M-x diary-mail-entries</KBD>.  Префиксный аргумент указывает,
сколько дней (начиная с сегодняшнего) следует проверять; иначе число
дней определяется по переменной <CODE>diary-mail-days</CODE>.




<H3><A NAME="SEC406" HREF="emacs_toc.html#TOC406">Файл дневника</A></H3>
<P>
<A NAME="IDX2260"></A>
<A NAME="IDX2261"></A>


<P>
<A NAME="IDX2262"></A>
  Ваш <EM>файл дневника</EM> -- это файл, в котором записаны события,
связанные с определенными датами.  Имя этого файла задается переменной
<CODE>diary-file</CODE>; по умолчанию это <TT>`~/diary'</TT>.  Программа
@command{calendar} поддерживает подмножество формата, допускаемого
средствами дневника в Emacs, так что вы можете использовать эту утилиту
для просмотра файла дневника с разумными результатами, если не считать
вхождений, которые она не понимает.


<P>
  Каждая запись в файле дневника описывает одно событие и состоит из
одной или нескольких строк.  Запись всегда начинается со спецификации
даты с левого края.  Остальная часть записи -- это просто текст,
описывающий событие.  Если запись содержит более одной строки, то строки
после первой должны начинаться с отступа, как указание на то, что они
продолжают предыдущее вхождение.  Строки, которые не начинаются с
правильной даты и не продолжают предыдущее вхождение, игнорируются.


<P>
  Вы можете подавить разметку определенных записей из дневника в окне
календаря; чтобы сделать так, вставьте в начале записи перед датой знак
<SAMP>`&#38;'</SAMP>.  Это не влияет на отображение записи в окне дневника; это
затрагивает только метки дат в окне календаря.  Запрет пометки записи
особенно полезен для обобщенных вхождений, которые иначе пометили бы
слишком много разных дней.


<P>
  Если первая строка записи состоит только из даты или названия дня
недели, и после нее нет пропусков или пунктуации, то такая строка не
выводится в окне дневника; там появляются только строки продолжения.
Например, такая запись:



<PRE>
02/11/1989
      Bill B. visits Princeton today
      2pm Cognitive Studies Committee meeting
      2:30-5:30 Liz at Lawrenceville
      4:00pm Dentist appt
      7:30pm Dinner at George's
      8:00-10:00pm concert
</PRE>

<P>
появляется в окне дневника без строки с датой в начале.  Такой стиль
записей выглядит красивее, если вы просматриваете вхождения для одного
дня, но может запутать, если вы попросите показать записи для нескольких
дней.


<P>
  Вы можете редактировать записи дневника в том виде, как они появляются
в окне, но важно помнить, что этот показанный буфер содержит
<EM>полный</EM> файл дневника, но некоторые его части скрыты из вида.  Это
означает в частности, что команда <KBD>C-f</KBD> (<CODE>forward-char</CODE>) может
поместить точку в таком месте, которое кажется концом строки, но на
самом деле это середина какой-то скрытой строки.


<P>
  <STRONG>Будьте внимательны при редактировании записей дневника!</STRONG>
Вставка новых строк или добавление/удаление знаков в середине видимой
строки не могут причинить проблем, но редактирование в конце строки
может делать не то, что вы ожидаете.  Удаление строки может удалить
другие невидимые записи, которые следуют за ней.  Перед редактированием
дневника лучше всего отобразить файл полностью с помощью команды <KBD>s</KBD>
(<CODE>show-all-diary-entries</CODE>).




<H3><A NAME="SEC407" HREF="emacs_toc.html#TOC407">Формат дат</A></H3>

<P>
  Вот несколько примерных записей дневника, иллюстрирующих различные
способы форматирования даты.  Все эти примеры показывают даты,
записанные в американском порядке (месяц, день, год), но режим Calendar
поддерживает европейский порядок (день, месяц, год) как альтернативу.



<PRE>
4/20/93  Switch-over to new tabulation system
apr. 25  Start tabulating annual results
4/30  Results for April are due
*/25  Monthly cycle finishes
Friday  Don't leave without backing up files
</PRE>

<P>
  Первая запись появляется только один раз, 20 апреля 1993 года.  Вторая
и третья появляются каждый год в заданные дни, а четвертая использует
для месяца символ подстановки (звездочку), поэтому она появляется 25-го
числа каждого месяца.  Последняя запись появляется каждую неделю в
пятницу.


<P>
  Для выражения даты вы можете использовать только числа, как
<SAMP>`<VAR>месяц</VAR>/<VAR>день</VAR>'</SAMP> или
<SAMP>`<VAR>месяц</VAR>/<VAR>день</VAR>/<VAR>год</VAR>'</SAMP>.  После этого должна идти
не-цифра.  В самой дате, <VAR>месяц</VAR> и <VAR>день</VAR> должны быть
однозначными или двузначными числами.  Необязательный <VAR>год</VAR> -- это
тоже число, его можно сокращать до последних двух цифр; то есть вы
можете писать как <SAMP>`11/12/1989'</SAMP>, так и <SAMP>`11/12/89'</SAMP>.


<P>
  Даты также можно записывать в формате <SAMP>`<VAR>название-месяца</VAR>
<VAR>день</VAR>'</SAMP> или <SAMP>`<VAR>название-месяца</VAR> <VAR>день</VAR>, <VAR>год</VAR>'</SAMP>, где
название месяца можно писать полностью или сокращать до трех букв (с
точкой или без).  Регистр значения не имеет.


<P>
  Дата может быть <EM>обобщенной</EM>, то есть частично недоопределенной.
Тогда она применяется ко всем датам, соответствующим спецификации.  Если
дата не содержит год, то она обобщенная и относится ко всем годам.  Или
же <VAR>месяц</VAR>, <VAR>день</VAR> или <VAR>год</VAR> могут быть знаком <SAMP>`*'</SAMP>; это
соответствует любому месяцу, дню или году.  Таким образом, вхождение
дневника <SAMP>`3/*/*'</SAMP> соответствует любому дню марта в каждом году; то
же и для <SAMP>`march *'</SAMP>.


<P>
<A NAME="IDX2263"></A>
<A NAME="IDX2264"></A>
<A NAME="IDX2265"></A>
  Если вы предпочитаете европейский стиль написания дат -- когда день
идет перед месяцем -- наберите в календаре <KBD>M-x european-calendar</KBD>
или установите переменную <CODE>european-calendar-style</CODE> в значение
<CODE>t</CODE> <EM>перед</EM> использованием любой команды календаря или
дневника.  Этот режим интерпретирует все даты в дневнике в европейском
стиле, а также применяет европейский стиль при отображении дат дневника.
(Заметьте, что после <VAR>названия-месяца</VAR> в европейском стиле нет
запятой.)  Чтобы вернуться к американскому (принимаемому по умолчанию)
стилю написания дат, наберите <KBD>M-x american-calendar</KBD>.


<P>
  Вы можете использовать название дня недели в качестве обобщенной даты,
которая относится к любой дате, приходящейся на этот день недели.
Названия дней недели можно сокращать до трех букв (с точкой или без) или
писать полностью; регистр значения не имеет.




<H3><A NAME="SEC408" HREF="emacs_toc.html#TOC408">Команды для добавления к дневнику</A></H3>

<P>
  Когда вы находитесь в календаре, вам доступны несколько команд для
создания записей в дневнике:


<DL COMPACT>

<DT><KBD>i d</KBD>
<DD>
Добавляет в дневник запись для выбранной даты
(<CODE>insert-diary-entry</CODE>).
<DT><KBD>i w</KBD>
<DD>
Добавляет в дневник запись для выбранного дня недели
(<CODE>insert-weekly-diary-entry</CODE>).
<DT><KBD>i m</KBD>
<DD>
Добавляет в дневник запись для выбранного дня месяца
(<CODE>insert-monthly-diary-entry</CODE>).
<DT><KBD>i y</KBD>
<DD>
Добавляет в дневник запись для выбранного дня года
(<CODE>insert-yearly-diary-entry</CODE>).
</DL>

<P>
<A NAME="IDX2266"></A>
<A NAME="IDX2267"></A>
  Вы можете создать в дневнике запись для конкретной даты, выбрав эту
дату в окне календаря и выполнив команду <KBD>i d</KBD>.  Эта команда
показывает конец вашего файла дневника в другом окне и вставляет дату;
затем вы можете напечатать остальную часть записи.


<P>
<A NAME="IDX2268"></A>
<A NAME="IDX2269"></A>
<A NAME="IDX2270"></A>
<A NAME="IDX2271"></A>
<A NAME="IDX2272"></A>
<A NAME="IDX2273"></A>
  Если вы хотите сделать в дневнике запись, которая относится к
какому-то дню недели, выберите этот день (можно любое его появление) и
наберите <KBD>i w</KBD>.  Это вставит название дня недели как обобщенную
дату; потом вы можете ввести остальную часть записи.  Таким же способом
вы можете создать ежемесячную запись.  Выберите день месяца, примените
команду <KBD>i m</KBD> и введите остаток записи.  Аналогично вы можете
вставить ежегодную запись при помощи команды <KBD>i y</KBD>.


<P>
  Все описанные выше команды по умолчанию создают помечаемые записи.
Чтобы сделать в дневнике непомечаемую запись, дайте команде числовой
аргумент.  Например, <KBD>C-u i w</KBD> создает в дневнике непомечаемую
еженедельную запись.


<P>
  Когда вы измените файл дневника, убедитесь, что вы сохранили его перед
выходом из Emacs.




<H3><A NAME="SEC409" HREF="emacs_toc.html#TOC409">Особые записи дневника</A></H3>

<P>
  Помимо вхождений, основанных на календарных датах, файл дневника может
содержать <EM>sexp-вхождения</EM> для регулярных событий, таких как
годовщины.  Такие записи основаны на лисповских выражениях
(s-выражениях), которые Emacs выполняет по мере сканирования файла
дневника.  Вместо даты sexp-вхождение содержит строку <SAMP>`%%'</SAMP>, за
которой идет лисповское выражение, заключенное в круглые скобки.  Это
выражение определяет, к каким датам относится данная запись.


<P>
  Режим Calendar предоставляет команды для вставки некоторых часто
используемых sexp-вхождений:


<DL COMPACT>

<DT><KBD>i a</KBD>
<DD>
Добавляет в дневник запись о годовщине события для текущей даты
(<CODE>insert-anniversary-diary-entry</CODE>).
<DT><KBD>i b</KBD>
<DD>
Добавляет блочную запись дневника для текущей области
(<CODE>insert-block-diary-entry</CODE>).
<DT><KBD>i c</KBD>
<DD>
Добавляет циклическую запись дневника, начинающуюся от текущей даты
(<CODE>insert-cyclic-diary-entry</CODE>).
</DL>

<P>
<A NAME="IDX2274"></A>
<A NAME="IDX2275"></A>
  Если вы хотите создать в дневнике запись, которая относится к
годовщине какой-то даты, переместите точку к этой дате и используйте
команду <KBD>i a</KBD>.  Это покажет конец вашего файла дневника в другом
окне и вставит описание годовщины; затем вы можете набрать остальную
часть записи.  Запись выглядит так:


<P>
<A NAME="IDX2276"></A>

<PRE>
%%(diary-anniversary 10 31 1948) Arthur's birthday
</PRE>

<P>
Эта запись относится к 31 октября каждого года после 1948; <SAMP>`10 31
1948'</SAMP> задает дату.  (Если вы используете европейский стиль календаря,
месяц и день меняются местами.)  Причина того, что это выражение требует
указания начального года, состоит в том, что продвинутые функции
календаря могут использовать его для подсчета истекших лет.


<P>
  <EM>Блочная</EM> запись дневника применяется к заданному промежутку
последовательных дат.  Вот блочная запись, которая относится ко всем
датам от 24 июня 1990 до 10 июля 1990 года.


<P>
<A NAME="IDX2277"></A>

<PRE>
%%(diary-block 6 24 1990 7 10 1990) Vacation
</PRE>

<P>
<SAMP>`6 24 1990'</SAMP> обозначает начальную дату, а <SAMP>`7 10 1990'</SAMP> ---
конечную.  (Опять же, если вы используете европейский стиль календаря,
месяц и день меняются местами.)


<P>
<A NAME="IDX2278"></A>
<A NAME="IDX2279"></A>
  Чтобы вставить блочную запись, поместите точку и метку на двух датах,
которые начинают и завершают промежуток, и наберите <KBD>i b</KBD>.  Эта
команда показывает конец вашего файла дневника в другом окне и вставляет
описание блока; потом вы можете напечатать остальную часть записи.


<P>
<A NAME="IDX2280"></A>
<A NAME="IDX2281"></A>
   <EM>Циклические</EM> записи дневника повторяются после фиксированного
интервала дней.  Чтобы создать такую запись, выберите начальную дату и
используйте команду <KBD>i c</KBD>.  Эта команда спросит у вас длину
интервала, а затем вставит запись, выглядящую следующим образом:


<P>
<A NAME="IDX2282"></A>

<PRE>
%%(diary-cyclic 50 3 1 1990) Renew medication
</PRE>

<P>
Эта запись относится к 1 марта 1990 года и к каждому 50-ому последующему
дню; <SAMP>`3 1 1990'</SAMP> задает начальную дату.  (Если вы используете
европейский стиль календаря, месяц и день меняются местами.)


<P>
  Все три эти команды создают помечаемые записи.  Чтобы вставить
непомечаемую запись, дайте команде числовой аргумент.  Например,
<KBD>C-u i a</KBD> создает непомечаемую запись для годовщины некоторого
события.


<P>
  Пометка sexp-вхождений дневника в календаре <EM>чрезвычайно</EM>
требовательна ко времени, поскольку должна быть отдельно проверена
каждая видимая в окне календаря дата.  Поэтому лучше делать
sexp-вхождения дневника непомечаемыми (с <SAMP>`&#38;'</SAMP>), если возможно.


<P>
  Другой, усложненный вид sexp-вхождения, <EM>плавающая</EM> запись, задает
регулярно случающееся событие по сдвигу, выраженному в днях, неделях и
месяцах.  Ее можно сравнить с записями crontab, интерпретируемыми
утилитой @command{cron}.  Вот непомечаемая плавающая запись, которая
относится к последнему четвергу ноября:


<P>
<A NAME="IDX2283"></A>

<PRE>
&#38;%%(diary-float 11 4 -1) American Thanksgiving
</PRE>

<P>
Число 11 обозначает ноябрь (одиннадцатый месяц), 4 обозначает четверг
(четвертый день недели, где воскресенье считается нулем), а -1
обозначает "последний" (1 обозначало бы "первый", 2 обозначало бы
"второй", -2 -- "предпоследний" и так далее).  Месяц может
быть единственным или списком месяцев.  Таким образом, вы могли бы
изменить 11 выше на <SAMP>`'(1 2 3)'</SAMP> и получить запись, относящуюся к
последнему четвергу января, февраля и марта.  Если месяц задан как
<CODE>t</CODE>, запись относится ко всем месяцам года.


<P>
  В самом общем виде, sexp-вхождения дневника могут производить для
определения своей применимости любые вычисления.  @xref{Sexp Diary Entries,, Sexp Diary Entries, @external{elisp}, The Emacs Lisp Reference
Manual}.




<H2><A NAME="SEC410" HREF="emacs_toc.html#TOC410">Напоминания о назначенных событиях</A></H2>
<P>
<A NAME="IDX2284"></A>


<P>
  Если у вас в дневнике есть запись о назначенном событии, и эта запись
начинается с распознаваемого описания времени, Emacs может предупредить
вас за несколько минут о приближении этого времени.  Emacs предупреждает
вас о назначении, показывая сообщение в строке режима.


<P>
<A NAME="IDX2285"></A>
<A NAME="IDX2286"></A>
  Чтобы включить напоминание о назначенных событиях, вы должны
задействовать средство Emacs для показа времени, <KBD>M-x display-time</KBD>
(see section <A HREF="emacs_6.html#SEC15">Строка режима</A>).  Вы также должны добавить к ловушке
<CODE>diary-hook</CODE> функцию <CODE>appt-make-list</CODE> следующим образом:



<PRE>
(add-hook 'diary-hook 'appt-make-list)
</PRE>

<P>
Помещение такого текста в ваш файл <TT>`.emacs'</TT> делает все сразу:



<PRE>
(display-time)
(add-hook 'diary-hook 'appt-make-list)
(diary 0)
</PRE>

<P>
  Если сделана такая подготовка, то когда вы отображаете дневник (с
помощью команды <KBD>d</KBD> в окне календаря или через <KBD>M-x diary</KBD>), для
всех записей дневника, в которых есть распознаваемые описания времени,
настраивается список назначенных событий, и перед каждым из них вам
делается напоминание.


<P>
  Предположим например, что файл дневника содержит такие строки:



<PRE>
Monday
  9:30am Coffee break
 12:00pm Lunch        
</PRE>

<P>
Тогда по понедельникам, после того как вы отобразите дневник, вам будут
напоминать в 9:20 о перерыве для кофе и в 11:50 об обеде.


<P>
  Вы можете записывать время в стиле am/pm (где <SAMP>`12:00am'</SAMP>
обозначает полночь, а <SAMP>`12:00pm'</SAMP> -- полдень) или в
двадцатичетырехчасовом европейском/военном стиле.  Необязательно быть
постоянным; файл дневника может содержать смесь этих двух стилей.


<P>
<A NAME="IDX2287"></A>
  Emacs автоматически обновляет список напоминаний сразу после полуночи.
Это также отображает в буфере дневника записи для следующего дня, если
только вы не установили <CODE>appt-display-diary</CODE> равной <CODE>nil</CODE>.


<P>
<A NAME="IDX2288"></A>
<A NAME="IDX2289"></A>
<A NAME="IDX2290"></A>
  Вы также можете использовать средства напоминания о назначенных
событиях в качестве будильника.  Команда <KBD>M-x appt-add</KBD> добавляет
записи в список напоминаний, не затрагивая ваш файл дневника.  Для
удаления записей из списка напоминаний применяется команда <KBD>M-x
appt-delete</KBD>.


<P>
<A NAME="IDX2291"></A>
  Вы можете в любое время выключить средство напоминания о назначенных
событиях, установив <CODE>appt-issue-message</CODE> в значение <CODE>nil</CODE>.




<H2><A NAME="SEC411" HREF="emacs_toc.html#TOC411">Сезонный перевод времени</A></H2>
<P>
<A NAME="IDX2292"></A>


<P>
  Emacs понимает разницу между стандартным и сезонным временем ---
времена, выдаваемые для восходов и закатов Солнца, солнцестояний,
равноденствий и фаз Луны, учитывают его.  Правила сезонного перевода
времени меняются от места к месту и кроме того колебались исторически от
года к году.  Чтобы делать свою работу правильно, Emacs должен знать,
какое правило использовать.


<P>
<A NAME="IDX2293"></A>
<A NAME="IDX2294"></A>
  Некоторые операционные системы отслеживают правила, применяющиеся в
той местности, где вы находитесь; на таких системах Emacs получает
необходимую информацию от системы автоматически.  Если часть этой
информации или вся она неизвестна, Emacs заполняет пробелы правилами,
используемыми в данное время в Кембридже, Массачусетс.  Если
получившиеся правила -- это не то, что вы хотите, вы можете сообщить
Emacs нужные правила, устанавливая определенные переменные:
<CODE>calendar-daylight-savings-starts</CODE> и
<CODE>calendar-daylight-savings-ends</CODE>.


<P>
  Значениями этих переменных должны быть лисповские выражения,
ссылающиеся на переменную <CODE>year</CODE> и вычисляющие григорианскую дату
перехода на зимнее и летнее время в форме списка <CODE>(<VAR>месяц</VAR>
<VAR>день</VAR> <VAR>год</VAR>)</CODE>.  Эти значения должны быть равны <CODE>nil</CODE>, если
в вашей местности не бывает сезонного перевода времени.


<P>
  Emacs использует эти выражения для определения даты перевода времени
при создании списка праздников и для корректровки времени при
вычислениях, связанных с Луной и Солнцем.


<P>
  Для массачусетского Кембриджа эти значения таковы:



<PRE>
(calendar-nth-named-day 1 0 4 year)
(calendar-nth-named-day -1 0 10 year)
</PRE>

<P>
Это обозначает первый нулевой день недели (воскресенье) четвертого
месяца (апреля) в году, задаваемом переменной <CODE>year</CODE>, и последнее
воскресенье десятого месяца (октября) в этом же году.  Если момент
перевода времени сменился бы на 1 октября, вы установили бы переменную
<CODE>calendar-daylight-savings-starts</CODE> в такое значение:



<PRE>
(list 10 1 year)
</PRE>

<P>
  Если в вашей местности время не переводится, или если вы хотите
получать всегда стандартное время, установите
<CODE>calendar-daylight-savings-starts</CODE> и
<CODE>calendar-daylight-savings-ends</CODE> равными <CODE>nil</CODE>.


<P>
<A NAME="IDX2295"></A>
  Переменная <CODE>calendar-daylight-time-offset</CODE> задает разницу во
времени после перевода, измеряемую в минутах.  Для массачусетского
Кембриджа это 60.


<P>
<A NAME="IDX2296"></A>
  Переменные <CODE>calendar-daylight-savings-starts-time</CODE> и
<CODE>calendar-daylight-savings-ends-time</CODE> задают число минут после
полуночи по местному времени, когда происходит перевод часов.  Для
массачусетского Кембриджа значения обоих этих переменных равны 120.
<P><HR><P>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_33.html">previous</A>, <A HREF="emacs_35.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">_uacct = "UA-78697-3"; urchinTracker(); </script></body>
</HTML>
