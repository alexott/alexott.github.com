<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from emacs.texi on 29 October 2002 -->

<TITLE>Руководство по GNU Emacs - Чтение почты с помощью Rmail</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_31.html">previous</A>, <A HREF="emacs_33.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC350" HREF="emacs_toc.html#TOC350">Чтение почты с помощью Rmail</A></H1>
<P>
<A NAME="IDX1810"></A>
<A NAME="IDX1811"></A>
<A NAME="IDX1812"></A>
<A NAME="IDX1813"></A>
<A NAME="IDX1814"></A>


<P>
  Rmail -- это подсистема Emacs для чтения и размещения получаемой вами
почты.  Rmail хранит почтовые сообщения в файлах, называемых
Rmail-файлами.  Чтение сообщений в Rmail-файле осуществляется в
специальном основном режиме, режиме Rmail, который переопределяет
большинство букв для запуска команд управления почтой.  Команда
<CODE>rmail-mode</CODE> используется для входа в режим Rmail, она запускает
ловушку <CODE>rmail-mode-hook</CODE>, как обычно; но не выполняйте эту команду
вручную, она не может делать ничего существенного, если этот буфер не
обращается к правильному Rmail-файлу.




<H2><A NAME="SEC351" HREF="emacs_toc.html#TOC351">Основные понятия Rmail</A></H2>

<P>
<A NAME="IDX1815"></A>
<A NAME="IDX1816"></A>
  При простейшем использовании Rmail, у вас есть один Rmail-файл
<TT>`~/RMAIL'</TT>, в котором сохраняется вся ваша почта.  Этот файл
называется <EM>первичным Rmail-файлом</EM>.  Команда <KBD>M-x rmail</KBD>
считывает ваш первичный Rmail-файл, вставляет в него новую почту из
ваших входных файлов, отображает первое непрочитанное сообщение и
позволяет вам начать чтение.  Переменная <CODE>rmail-file-name</CODE> задает
имя первичного Rmail-файла.


<P>
  Rmail использует сужение, чтобы скрыть из Rmail-файла все сообщения,
кроме одного.  Показанное сообщение называется <EM>текущим</EM>.
Специальные команды режима Rmail могут осуществлять такие вещи, как
удаление текущего сообщения, копирование его в другой файл, посылка
ответа или перемещение к другому сообщению.  Вы также можете создать
несколько Rmail-файлов и использовать Rmail для обмена сообщениями между
ними.


<P>
<A NAME="IDX1817"></A>
<A NAME="IDX1818"></A>
  В пределах Rmail-файла сообщения расположены последовательно в порядке
поступления; вы можете использовать другие способы сортировки.
Сообщениям присваиваются последовательные целые числа в качестве их
<EM>номеров сообщений</EM>.  Номер текущего сообщения показывается в строке
режима Rmail, за ним идет общее число сообщений в файле.  Вы можете
перейти на сообщение, задавая его номер с помощью ключа <KBD>j</KBD>
(see section <A HREF="emacs_32.html#SEC353">Перемещение по сообщениям</A>).


<P>
<A NAME="IDX1819"></A>
<A NAME="IDX1820"></A>
  Следуя обычным правилам Emacs, изменения в Rmail-файле становятся
постоянными только после сохранения этого файла.  Вы можете осуществить
это с помощью команды <KBD>s</KBD> (<CODE>rmail-save</CODE>), которая также сперва
вычеркивает удаляемые сообщения из файла (see section <A HREF="emacs_32.html#SEC354">Удаление сообщений</A>).  Для записи файла без вычеркивания
следует использовать <KBD>C-x C-s</KBD>.  Rmail также сохраняет Rmail-файл
при поступлении новой почты из входного почтового файла (see section <A HREF="emacs_32.html#SEC355">Rmail-файлы и входные почтовые ящики</A>).


<P>
<A NAME="IDX1821"></A>
<A NAME="IDX1822"></A>
<A NAME="IDX1823"></A>
<A NAME="IDX1824"></A>
  Выйти из Rmail можно с помощью <KBD>q</KBD> (<CODE>rmail-quit</CODE>), при этом
Rmail-файл очищается и сохраняется, и происходит переход в другой буфер.
Но формально нет необходимости `выходить'.  Если вы переключились из
Rmail к редактированию в других буферах и больше не возвращались
обратно, на самом деле вы вышли.  (Команда Rmail <KBD>b</KBD> делает это для
вас.)  Достаточно просто убедиться, что вы сохранили Rmail-файл (как и
любой другой измененный вами файл).  Достаточно удобный способ сделать
это предоставляет команда <KBD>C-x s</KBD> (see section <A HREF="emacs_19.html#SEC111">Сохранение файлов</A>).




<H2><A NAME="SEC352" HREF="emacs_toc.html#TOC352">Прокрутка в сообщении</A></H2>

<P>
  Когда Rmail показывает сообщение, не помещающееся на экране, вам
придется прокручивать это сообщение, чтобы прочитать оставшуюся часть.
Вы могли бы сделать это с помощью <KBD>C-v</KBD>, <KBD>M-v</KBD> и <KBD>M-&#60;</KBD>, но в
Rmail прокруткой приходится пользоваться настолько часто, что ее команды
заслуживают более простого набора.


<DL COMPACT>

<DT><KBD><KBD>SPC</KBD></KBD>
<DD>
Прокручивает вперед (<CODE>scroll-up</CODE>).
<DT><KBD><KBD>DEL</KBD></KBD>
<DD>
Прокручивает назад (<CODE>scroll-down</CODE>).
<DT><KBD>.</KBD>
<DD>
Прокручивает к началу сообщения (<CODE>rmail-beginning-of-message</CODE>).
</DL>

<P>
<A NAME="IDX1825"></A>
<A NAME="IDX1826"></A>
  Так как во время чтения сообщения наиболее частой процедурой является
прокрутка по целому экрану, Rmail делает <KBD>SPC</KBD> и <KBD>DEL</KBD>
синонимами <KBD>C-v</KBD> (<CODE>scroll-up</CODE>) и <KBD>M-v</KBD>
(<CODE>scroll-down</CODE>).


<P>
<A NAME="IDX1827"></A>
<A NAME="IDX1828"></A>
   Команда <KBD>.</KBD> (<CODE>rmail-begining-of-message</CODE>) прокручивает к
началу выбранного сообщения.  Это не совсем то же, что и <KBD>M-&#60;</KBD>:
во-первых, она не оставляет метку, а во-вторых, она переустанавливает
границы буфера до пределов текущего сообщения, если вы их изменили.




<H2><A NAME="SEC353" HREF="emacs_toc.html#TOC353">Перемещение по сообщениям</A></H2>

<P>
  Самое основное, что вы можете сделать с сообщением -- прочитать его.
В Rmail вы можете прочитать сообщение, сделав его текущим.  Обычно при
этом последовательно перемещаются по файлу, так как сообщения в нем
расположены в порядке получения.  При входе в Rmail вы попадаете на
первое сообщение, которое никогда еще не было текущим (это первое
сообщения, имеющее атрибут <SAMP>`unseen'</SAMP>; see section <A HREF="emacs_32.html#SEC359">Атрибуты в Rmail</A>).  Чтобы увидеть другие новые сообщения,
двигайтесь вперед, для повторного просмотра старых двигайтесь назад.


<DL COMPACT>

<DT><KBD>n</KBD>
<DD>
Перейти к следующему неудаленному сообщению, пропуская все промежуточные
удаленные сообщения (<CODE>rmail-next-undeleted-message</CODE>).
<DT><KBD>p</KBD>
<DD>
Перейти к предыдущему неудаленному сообщению
(<CODE>rmail-previous-undeleted-message</CODE>).
<DT><KBD>M-n</KBD>
<DD>
Перейти к следующему сообщению, включая удаленные
(<CODE>rmail-next-message</CODE>).
<DT><KBD>M-p</KBD>
<DD>
Перейти к предыдущему сообщению, включая удаленные
(<CODE>rmail-previous-message</CODE>).
<DT><KBD>j</KBD>
<DD>
Перейти к первому сообщению.  С аргументом <VAR>n</VAR> -- перейти к
сообщению с номером <VAR>n</VAR> (<CODE>rmail-show-message</CODE>).
<DT><KBD>&#62;</KBD>
<DD>
Перейти к последнему сообщению (<CODE>rmail-last-message</CODE>).
<DT><KBD>&#60;</KBD>
<DD>
Перейти к первому сообщению (<CODE>rmail-first-message</CODE>).

<DT><KBD>M-s <VAR>regexp</VAR> <KBD>RET</KBD></KBD>
<DD>
Перейти к следующему сообщению, содержащему совпадение с регулярным
выражением <VAR>regexp</VAR> (<CODE>rmail-search</CODE>).

<DT><KBD>- M-s <VAR>regexp</VAR> <KBD>RET</KBD></KBD>
<DD>
Перейти к предыдущему сообщению, содержащему совпадение с <VAR>regexp</VAR>.
</DL>

<P>
<A NAME="IDX1829"></A>
<A NAME="IDX1830"></A>
<A NAME="IDX1831"></A>
<A NAME="IDX1832"></A>
<A NAME="IDX1833"></A>
<A NAME="IDX1834"></A>
<A NAME="IDX1835"></A>
<A NAME="IDX1836"></A>
  <KBD>n</KBD> and <KBD>p</KBD> -- это обычный способ перемещения по сообщениям в
Rmail.  Они перемещают по сообщениям последовательно, но пропускают
удаленные сообщения, что обычно вы и хотели бы делать.  Эти команды
называются <CODE>rmail-next-undeleted-message</CODE> и
<CODE>rmail-previous-undeleted-message</CODE>.  Если вы не хотите пропускать
удаленные сообщения, например, если вы хотите переместиться к сообщению,
чтобы отменить его удаление, используйте варианты <KBD>M-n</KBD> и <KBD>M-p</KBD>
(<CODE>rmail-next-message</CODE> и <CODE>rmail-previous-message</CODE>).  Числовой
аргумент в любой из этих команд используется как счетчик повторов.


<P>
  В Rmail вы можете задать числовой аргумент, набрав только цифру.  При
этом не требуется сначала набирать <KBD>C-u</KBD>.


<P>
<A NAME="IDX1837"></A>
<A NAME="IDX1838"></A>
<A NAME="IDX1839"></A>
  Команда <KBD>M-s</KBD> (<CODE>rmail-search</CODE>) -- это версия поиска для
Rmail.  Обычная команда наращиваемого поиска <KBD>C-s</KBD> работает в Rmail,
но она осуществляет поиск только в пределах текущего сообщения.  Цель
команды <KBD>M-s</KBD> -- поиск другого сообщения.  Она считывает регулярное
выражение (see section <A HREF="emacs_17.html#SEC95">Синтаксис регулярных выражений</A>) без наращивания и затем
осуществляет поиск совпадения, начиная с начала следующего сообщения.
Потом она выбирает сообщение, содержащее совпадение.  Если <VAR>regexp</VAR>
пусто, <KBD>M-s</KBD> использует регулярное выражение, заданное при
предыдущем поиске.


<P>
  Чтобы найти в файле другое сообщения в обратном направлении, задайте
команде <KBD>M-s</KBD> отрицательный аргумент.  В Rmail это можно сделать как
<KBD>- M-s</KBD>.


<P>
  Также возможен поиск сообщения по метке.  See section <A HREF="emacs_32.html#SEC358">Метки</A>.


<P>
<A NAME="IDX1840"></A>
<A NAME="IDX1841"></A>
<A NAME="IDX1842"></A>
<A NAME="IDX1843"></A>
<A NAME="IDX1844"></A>
<A NAME="IDX1845"></A>
  Для передвижения к сообщению, задаваемому абсолютным номером,
используйте команду <KBD>j</KBD> (<CODE>rmail-show-message</CODE>) с номером
сообщения в качестве аргумента.  Без аргумента, команда <KBD>j</KBD> выбирает
первое сообщение.  <KBD>&#60;</KBD> (<CODE>rmail-first-message</CODE>) также выбирает
первое сообщение.  Команда <KBD>&#62;</KBD> (<CODE>rmail-last-message</CODE>) выбирает
последнее.




<H2><A NAME="SEC354" HREF="emacs_toc.html#TOC354">Удаление сообщений</A></H2>

<P>
<A NAME="IDX1846"></A>
  Когда вам больше не нужно хранить какое-то сообщение, его можно
<EM>удалить</EM>.  При этом удаляемое сообщение метится как возможно
игнорируемое и некоторые команды Rmail не будут замечать его
присутствия, но тем не менее оно продолжает существовать в Rmail-файле и
сохраняет свой номер.


<P>
<A NAME="IDX1847"></A>
  <EM>Вычеркивание</EM> в Rmail-файле (или его <EM>очистка</EM>) действительно
уничтожает удаленные сообщения.  Остальные сообщения последовательно
перенумеровываются.  Вычеркивание -- это единственное действие, кроме
разбора дайджеста (see section <A HREF="emacs_32.html#SEC367">Сообщения-дайджесты</A>), которое
изменяет номера сообщений.


<DL COMPACT>

<DT><KBD>d</KBD>
<DD>
Удалить текущее сообщение и перейти к следующему неудаленному
(<CODE>rmail-delete-forward</CODE>).
<DT><KBD>C-d</KBD>
<DD>
Удалить текущее сообщение и перейти к предыдущему неудаленному
(<CODE>rmail-delete-backward</CODE>).
<DT><KBD>u</KBD>
<DD>
Отменить удаление текущего сообщения или перейти назад к удаленному
сообщению и отменить его удаление
(<CODE>rmail-undelete-previous-message</CODE>).
<DT><KBD>x</KBD>
<DD>
Очистить Rmail-файл (<CODE>rmail-expunge</CODE>).
</DL>

<P>
<A NAME="IDX1848"></A>
<A NAME="IDX1849"></A>
<A NAME="IDX1850"></A>
<A NAME="IDX1851"></A>
  Существуют две команды Rmail для удаления сообщений.  Обе они удаляют
текущее сообщение и выбирают другое.  Команда <KBD>d</KBD>
(<CODE>rmail-delete-forward</CODE>) переходит к следующему сообщению,
пропуская уже удаленные, в то время как <KBD>C-d</KBD>
(<CODE>rmail-delete-backward</CODE>) передвигает к предыдущему неудаленному
сообщению.  Если же нет неудаленного сообщения, к которому можно перейти
в указанном направлении, то текущим остается сообщение, которое было
только что удалено.  Числовой аргумент меняет направление движения после
удаления.


<P>
<A NAME="IDX1852"></A>
Всякий раз, когда Rmail удаляет сообщение, он вызывает функции,
перечисленные в <CODE>rmail-delete-message-hook</CODE>.  Когда вызываются
функции этой ловушки, сообщение уже помечено как удаленное, но все еще
является текущим в этом буфере Rmail.


<P>
<A NAME="IDX1853"></A>
<A NAME="IDX1854"></A>
<A NAME="IDX1855"></A>
<A NAME="IDX1856"></A>
<A NAME="IDX1857"></A>
  Для того чтобы все удаленные сообщения окончательно исчезли из
Rmail-файла, надо набрать <KBD>x</KBD> (<CODE>rmail-expunge</CODE>).  Пока это не
сделано, есть возможность <EM>отмены удаления</EM> сообщений.  Команда
отмены удаления, <KBD>u</KBD> (<CODE>rmail-undelete-previous-message</CODE>),
предназначена для отмены действия команды <KBD>d</KBD> в большинстве случаев.
Она отменяет удаление текущего сообщения, если оно было удалено.  В
противном случае она двигается к предыдущему сообщению до тех пор, пока
не будет найдено удаленное сообщение, и производит отмену удаления этого
сообщения.


<P>
  Обычно вы можете отменить действие <KBD>d</KBD> с помощью команды <KBD>u</KBD>,
так как <KBD>u</KBD> передвигает назад и отменяет удаление сообщения,
произведенное командой <KBD>d</KBD>.  Но это не работает, когда <KBD>d</KBD>
пропускает несколько уже удаленных сообщений, которые следуют за
удаляемым сообщением; в этом случае команда <KBD>u</KBD> будет отменять
удаление последнего сообщения из тех, что были пропущены.  Не существует
совершенного способа обойти эту проблему.  Однако, повторяя команду
<KBD>u</KBD>, можно в конце концов вернуться к сообщению, для которого вы
собирались отменить удаление.  Можно также добраться до этого сообщения
с помощью команды <KBD>M-p</KBD> и затем набрать <KBD>u</KBD>.


<P>
  Удаленное сообщение имеет атрибут <SAMP>`deleted'</SAMP>, и как результат при
удалении текущего сообщения в строке режима появляется слово
<SAMP>`deleted'</SAMP>.  На самом деле, удаление или отмена удаления сообщения
--- это не более чем добавление или уничтожение этого атрибута.
See section <A HREF="emacs_32.html#SEC359">Атрибуты в Rmail</A>.




<H2><A NAME="SEC355" HREF="emacs_toc.html#TOC355">Rmail-файлы и входные почтовые ящики</A></H2>
<P>
<A NAME="IDX1858"></A>


<P>
  Операционная система помещает приходящую вам почту в файл, который мы
называем вашим <EM>входным почтовым ящиком</EM>.  Когда вы запускаете
Rmail, он выполняет написанную на Си программу @command{movemail}, чтобы
скопировать новые сообщения из входного почтового ящика в первичный
Rmail-файл, который также содержит другие сообщения, сохранившиеся от
предыдущих сеансов Rmail.  Именно в этом файле находится та
корреспонденция, которую вы читаете с помощью Rmail.  Эта процедура
называется <EM>получением новой почты</EM>.  В любой момент она может быть
повторена в Rmail с помощью команды <KBD>g</KBD>.


<P>
<A NAME="IDX1859"></A>
<A NAME="IDX1860"></A>
  Переменная <CODE>rmail-primary-inbox-list</CODE> содержит список имен
файлов, являющихся входными почтовыми ящиками вашего первичного
Rmail-файла.  Если вы не установили эту переменную явно, она
инициализируется значением переменной среды @env{MAIL}, или, в крайнем
случае, устанавливается в значение <CODE>nil</CODE>, что означает
использование входного почтового ящика по умолчанию; это могут быть
файлы <TT>`/var/mail/<VAR>имя-пользователя</VAR>'</TT>,
<TT>`/usr/mail/<VAR>имя-пользователя</VAR>'</TT> или
<TT>`/usr/spool/mail/<VAR>имя-пользователя</VAR>'</TT> в зависимости от вашей
операционной системы.


<P>
  Чтобы узнать значение по умолчанию для вашей системы, используйте
<KBD>C-h v rmail-primary-inbox <KBD>RET</KBD></KBD>.  Вы можете указать входной
файл (или файлы) для любого Rmail-файла с помощью команды
<CODE>set-rmail-inbox-list</CODE>; смотрите section <A HREF="emacs_32.html#SEC356">Множество почтовых файлов</A>.


<P>
  Есть две причины для разделения Rmail-файлов и входных почтовых
ящиков.



<OL>
<LI>

Формат входных почтовых файлов изменяется от одной операционной системы
к другой и зависит от других почтовых программ.  Только одна часть Rmail
должна знать об этих альтернативах и должна лишь понимать, как
преобразовывать их все к собственному формату Rmail.

<LI>

Обеспечение доступа в файл входного почтового ящика без возникновения
опасности потери почты -- очень громоздкая вещь, поскольку требует
взаимных блокировок с доставкой почты.  Кроме того, различные
операционные системы используют разную технику блокировок.  Стратегия
перемещения почты из входного почтового ящика раз и навсегда в отдельный
Rmail-файл устраняет необходимость блокировки всего остального в Rmail,
так как только Rmail работает с Rmail-файлом.
</OL>

<P>
  Rmail был написан с использованием Babyl в качестве внутреннего
формата.  С тех пор мы поняли, что обычный для систем Unix и GNU формат
входных почтовых ящиков подходит для этой цели, и мы планируем изменить
Rmail, чтобы он использовал этот формат.  Однако, Rmail-файл все так же
будет отдельным от входного файла, даже на системах, где их форматы
одинаковы.




<H2><A NAME="SEC356" HREF="emacs_toc.html#TOC356">Множество почтовых файлов</A></H2>

<P>
  По умолчанию Rmail действует в вашем <EM>первичном Rmail-файле</EM>,
называемом <TT>`~/RMAIL'</TT>, и получает вашу приходящую почту из
системного входного почтового файла.  Но вы можете также иметь другие
Rmail-файлы и редактировать их с помощью Rmail.  Эти файлы могут
получать почту через их собственные файлы входных почтовых ящиков, или
вы можете перемещать в них сообщения с помощью явных команд Rmail
(see section <A HREF="emacs_32.html#SEC357">Копирование сообщений в файлы</A>).


<DL COMPACT>

<DT><KBD>i <VAR>файл</VAR> <KBD>RET</KBD></KBD>
<DD>
Считать <VAR>файл</VAR> в Emacs и запустить в нем Rmail (<CODE>rmail-input</CODE>).

<DT><KBD>M-x set-rmail-inbox-list <KBD>RET</KBD> <VAR>файлы</VAR> <KBD>RET</KBD></KBD>
<DD>
Задать имена входных почтовых файлов, откуда будет получать почту
текущий Rmail-файл.

<DT><KBD>g</KBD>
<DD>
Получить новую почту из входных почтовых ящиков текущего Rmail-файла
(<CODE>rmail-get-new-mail</CODE>).

<DT><KBD>C-u g <VAR>файл</VAR> <KBD>RET</KBD></KBD>
<DD>
Получить новую почту из входного почтового ящика <VAR>файл</VAR>.
</DL>

<P>
<A NAME="IDX1861"></A>
<A NAME="IDX1862"></A>
  Чтобы запустить Rmail для файла, отличного от вашего первичного
почтового файла, можно использовать в Rmail команду <KBD>i</KBD>
(<CODE>rmail-input</CODE>).  Она обращается к этому файлу в режиме Rmail.  Вы
также можете использовать команду <KBD>M-x rmail-input</KBD>, даже не
находясь в Rmail.


<P>
  Файл, считываемый с помощью команды <KBD>i</KBD>, как правило, должен быть
правильным Rmail-файлом.  Если это не так, Rmail пытается преобразовать
его в поток сообщений в нескольких известных форматах.  Если это
удается, он преобразует весь этот файл в Rmail-файл.  Если вы задали
имя несуществующего файла, <KBD>i</KBD> инициализирует новый буфер для
создания нового Rmail-файла.


<P>
<A NAME="IDX1863"></A>
<A NAME="IDX1864"></A>
  Вы также можете выбрать Rmail-файл из меню.  Сначала выберите пункт
меню Classify, из меню Classify выберите пункт Input Rmail File; затем
выберите нужный вам файл.  Переменные
<CODE>rmail-secondary-file-directory</CODE> и
<CODE>rmail-secondary-file-regexp</CODE> указывают, какие файлы предлагает это
меню: первая переменная говорит, в каком каталоге их искать; вторая
говорит, какие файлы в этом каталоге предлагать (все, чьи имена
соответствуют регулярному выражению).  Эти переменные также относятся к
выбору файла для вывода (see section <A HREF="emacs_32.html#SEC357">Копирование сообщений в файлы</A>).


<P>
<A NAME="IDX1865"></A>
  Каждый Rmail-файл может содержать список имен файлов входных почтовых
ящиков; вы можете задать этот список с помощью <KBD>M-x
set-rmail-inbox-list <KBD>RET</KBD> files <KBD>RET</KBD></KBD>.  Аргумент может
содержать любое число имен файлов, разделенных запятыми.  Он может быть
также пустым, и это означает, что этот файл не должен иметь входных
почтовых ящиков.  Как только указан список входных почтовых
ящиков, Rmail-файл запоминает его и сохраняет до тех пор, пока он явно
не будет изменен.


<P>
  Как особое исключение, если ваш первичный Rmail-файл не указывает
входных почтовых файлов, он использует стандартный системный.


<P>
<A NAME="IDX1866"></A>
<A NAME="IDX1867"></A>
  Команда <KBD>g</KBD> (<CODE>rmail-get-new-mail</CODE>) вносит почту в текущий
Rmail-файл из его входных файлов.  Если у этого Rmail-файла нет входных
файлов, <KBD>g</KBD> ничего не делает.  Команда <KBD>M-x rmail</KBD> также вносит
новую почту в ваш первичный Rmail-файл.


<P>
  Чтобы перенести почту из файла, не являющегося обычным входным
почтовым ящиком, задайте ключу <KBD>g</KBD> числовой аргумент, как в <KBD>C-u
g</KBD>.  Тогда он считает имя файла и перенесет почту из него.  Когда
<KBD>g</KBD> используется с аргументом, файл входного почтового ящика ни в
коем случае не удаляется и не изменяется.  Поэтому это основной способ
переноса одного файла сообщений в другой.




<H2><A NAME="SEC357" HREF="emacs_toc.html#TOC357">Копирование сообщений в файлы</A></H2>

<P>
  Эти команды копируют сообщения из Rmail-файла в другой файл.


<DL COMPACT>

<DT><KBD>o <VAR>файл</VAR> <KBD>RET</KBD></KBD>
<DD>
Добавить копию текущего сообщения в конец <VAR>файла</VAR>, по умолчанию в
формате Rmail-файлов (<CODE>rmail-output-to-rmail-file</CODE>).

<DT><KBD>C-o <VAR>файл</VAR> <KBD>RET</KBD></KBD>
<DD>
Добавить копию текущего сообщения в конец <VAR>файла</VAR>, по умолчанию в
формате системных почтовых ящиков (<CODE>rmail-output</CODE>).

<DT><KBD>w <VAR>файл</VAR> <KBD>RET</KBD></KBD>
<DD>
Вывести только тело сообщения в <VAR>файл</VAR>, по умолчанию имя файла
берется из поля <SAMP>`Subject'</SAMP>.
</DL>

<P>
<A NAME="IDX1868"></A>
<A NAME="IDX1869"></A>
<A NAME="IDX1870"></A>
<A NAME="IDX1871"></A>
  Команды <KBD>o</KBD> и <KBD>C-o</KBD> копируют текущее сообщение в указанный
файл.  Это может быть Rmail-файл или файл в формате системных почтовых
ящиков; команды вывода выясняют формат этого файла и записывают
копируемое сообщение в этом формате.


<P>
  При копировании сообщения в файл в формате Unix, эти команды включают
все поля заголовков, которые видимы в данный момент.  Если хотите,
используйте сначала команду <KBD>t</KBD>, чтобы указать, какие заголовки
показывать (и копировать).


<P>
  Команды <KBD>o</KBD> и <KBD>C-o</KBD> различаются с двух сторон: каждая
предлагает свое имя файла по умолчанию и каждая задает свой выбор
формата, когда файл еще не существует.  Команда <KBD>o</KBD> использует при
создании нового файла формат Rmail, тогда как <KBD>C-o</KBD> использует для
нового файла системный формат.  По умолчанию <KBD>o</KBD> использует имя
файла, заданное последней <KBD>o</KBD>, а <KBD>C-o</KBD> -- последней <KBD>C-o</KBD>.


<P>
  Если к выходному Rmail-файлу в данный момент обращается какой-нибудь
буфер, команды вывода копируют сообщение в этот буфер.  Нужно ли
действительно сохранять буфер в его файл решаете вы.


<P>
<A NAME="IDX1872"></A>
<A NAME="IDX1873"></A>
  Иногда вы можете получить сообщение, чье тело несет содержимое файла.
Вы можете сохранить его тело в файл (исключая заголовки сообщения) с
помощью команды <KBD>w</KBD> (<CODE>rmail-output-body-to-file</CODE>).  Часто эти
сообщения содержат имя целевого файла в поле <SAMP>`Subject'</SAMP>, поэтому
команда <KBD>w</KBD> использует это поле как имя выходного файла по
умолчанию.  Однако, имя файла считывается из минибуфера, поэтому при
желании вы можете указать другое имя.


<P>
  Вы также можете вывести сообщение в Rmail-файл, выбранный из меню.
Сначала выберите пункт меню Classify, из меню Classify выберите пункт
Output Rmail File; затем выберите нужный вам пункт меню.  Это выведет
текущее сообщение в указанный файл, как команда <KBD>o</KBD>.  Переменные
<CODE>rmail-secondary-file-directory</CODE> и
<CODE>rmail-secondary-file-regexp</CODE> указывают, какие файлы предлагает это
меню: первая переменная говорит в каком каталоге их искать; вторая
говорит, какие файлы в этом каталоге предлагать (все, чьи имена
соответствуют регулярному выражению).


<P>
<A NAME="IDX1874"></A>
  Копирование сообщения придает его исходной копии атрибут <SAMP>`filed'</SAMP>,
так что когда такое сообщение становится текущим, в строке режима
появляется слово <SAMP>`filed'</SAMP>.  Если вы хотите хранить только одну копию
каждого почтового сообщения, установите переменную
<CODE>rmail-delete-after-output</CODE> равной <CODE>t</CODE>; тогда команды <KBD>o</KBD>
и <KBD>C-o</KBD> после копирования удаляют оригинал.  (Впоследствии вы можете
отменить удаление оригинального сообщения, если захотите.)


<P>
  При копировании в файлы в системном формате почтовых ящиков
используются поля заголовка, которые показаны в это время в Rmail.
Таким образом, если вы используете команду <KBD>t</KBD> для просмотра всего
заголовка и затем скопируете сообщение, скопируется весь заголовок.
See section <A HREF="emacs_32.html#SEC365">Отображение сообщений</A>.


<P>
<A NAME="IDX1875"></A>
  Переменная <CODE>rmail-output-file-alist</CODE> позволяет вам указать
интеллектуальные значения по умолчанию для выходного файла, основанные
на содержимом текущего сообщения.  Ее значением должен быть список, чьи
элементы имеют такую форму:



<PRE>
(<VAR>regexp</VAR> . <VAR>имя</VAR>)
</PRE>

<P>
Если в текущем сообщении есть совпадение с <VAR>regexp</VAR>, то по умолчанию
именем выходного файла будет <VAR>имя</VAR>.  Если совпадения найдены для
нескольких элементов, то имя файла по умолчанию определяется первым
совпавшим элементом.  Подвыражение <VAR>имя</VAR> может быть константной
строкой, дающей имя файла, или, в более общем случае, любым лисповским
выражением, возвращающим имя файла в виде строки.
<CODE>rmail-output-file-alist</CODE> относится как к <KBD>o</KBD>, так и к
<KBD>C-o</KBD>.




<H2><A NAME="SEC358" HREF="emacs_toc.html#TOC358">Метки</A></H2>
<P>
<A NAME="IDX1876"></A>
<A NAME="IDX1877"></A>


<P>
  У каждого сообщения могут быть различные <EM>метки</EM>, приписываемые
ему в качестве средства классификации.  Метка имеет имя; разные имена
означают разные метки.  Любая данная метка либо присутствует, либо
отсутствует в конкретном сообщении.  Ряд имен меток имеют стандартные
значения и присваиваются сообщениям в Rmail автоматически в нужный
момент; такие специальные метки называются <EM>атрибутами</EM>.


<P>
Все другие метки приписываются пользователем.


<DL COMPACT>

<DT><KBD>a <VAR>метка</VAR> <KBD>RET</KBD></KBD>
<DD>
Приписать <VAR>метку</VAR> текущему сообщению (<CODE>rmail-add-label</CODE>).
<DT><KBD>k <VAR>метка</VAR> <KBD>RET</KBD></KBD>
<DD>
Удалить <VAR>метку</VAR> из текущего сообщения (<CODE>rmail-kill-label</CODE>).
<DT><KBD>C-M-n <VAR>метки</VAR> <KBD>RET</KBD></KBD>
<DD>
Передвинуться на следующее сообщение, которое имеет одну из <VAR>меток</VAR>
(<CODE>rmail-next-labeled-message</CODE>).
<DT><KBD>C-M-p <VAR>метки</VAR> <KBD>RET</KBD></KBD>
<DD>
Передвинуться на предыдущее сообщение, которое имеет одну из <VAR>меток</VAR>
(<CODE>rmail-previous-labeled-message</CODE>).
<DT><KBD>C-M-l <VAR>метки</VAR> <KBD>RET</KBD></KBD>
<DD>
Cделать резюме всех сообщений, содержащих какую-либо из <VAR>меток</VAR>
(<CODE>rmail-summary-by-labels</CODE>).
</DL>

<P>
<A NAME="IDX1878"></A>
<A NAME="IDX1879"></A>
<A NAME="IDX1880"></A>
<A NAME="IDX1881"></A>
  Команды <KBD>a</KBD> (<CODE>rmail-add-label</CODE>) и <KBD>k</KBD>
(<CODE>rmail-kill-label</CODE>) позволяют вам приписывать или удалять любую
метку из текущего сообщения.  Если аргумент <VAR>метка</VAR> пустой, то это
означает приписывание или удаление той самой метки, которая была
приписана или удалена самой последней.


<P>
  Как только вы присвоили сообщениям метки, чтобы классифицировать их
так, как вам хочется, появляются два способа использования этих меток: в
перемещении и в резюме.


<P>
<A NAME="IDX1882"></A>
<A NAME="IDX1883"></A>
<A NAME="IDX1884"></A>
<A NAME="IDX1885"></A>
  Команда <KBD>C-M-n <VAR>метки</VAR> <KBD>RET</KBD></KBD>
(<CODE>rmail-next-labeled-message</CODE>) передвигает к следующему сообщению,
которое имеет одну из <VAR>меток</VAR>.  Аргумент <VAR>метки</VAR> -- это одно
или несколько имен меток, разделенных запятыми.  <KBD>C-M-p</KBD>
(<CODE>rmail-previous-labeled-message</CODE>) -- аналогичная команда, но
передвигает назад к предыдущим сообщениям.  Числовой аргумент в этих
командах работает как счетчик повторов.


<P>
  Команда <KBD>C-M-l <VAR>метки</VAR> <KBD>RET</KBD></KBD>
(<CODE>rmail-summary-by-labels</CODE>) показывает резюме, содержащее только
сообщения, имеющие по крайней мере одну из описанного набора меток.
Аргумент <VAR>метки</VAR> -- это одно или более имен меток, разделенных
запятыми.  See section <A HREF="emacs_32.html#SEC361">Резюме</A>, для получения
информации о резюме.


<P>
  Если аргумент <VAR>метки</VAR> для <KBD>C-M-n</KBD>, <KBD>C-M-p</KBD> или <KBD>C-M-l</KBD>
пустой, то это предполагает использование последнего набора меток,
указанного для какой-либо из этих команд.




<H2><A NAME="SEC359" HREF="emacs_toc.html#TOC359">Атрибуты в Rmail</A></H2>

<P>
  Некоторые метки, такие, как <SAMP>`deleted'</SAMP> и <SAMP>`filed'</SAMP>, имеют
встроенные значения и приписываются сообщениям или удаляются из них
автоматически в соответствующее время; эти метки называются
<EM>атрибутами</EM>.  Ниже приводится список атрибутов Rmail.


<DL COMPACT>

<DT><SAMP>`unseen'</SAMP>
<DD>
Означает, что сообщение никогда не было текущим.  Приписывается
сообщениям, когда они поступают из файла входного почтового ящика, и
удаляется, когда сообщение становится текущим.  Когда вы запускаете
Rmail, он изначально показывает первое сообщение с этим атрибутом.
<DT><SAMP>`deleted'</SAMP>
<DD>
Означает, что сообщение удаляется.  Приписывается командами удаления и
уничтожается командами отмены удаления (see section <A HREF="emacs_32.html#SEC354">Удаление сообщений</A>).
<DT><SAMP>`filed'</SAMP>
<DD>
Означает, что сообщение было скопировано в какой-нибудь другой файл.
Приписывается командами вывода файла (see section <A HREF="emacs_32.html#SEC356">Множество почтовых файлов</A>).
<DT><SAMP>`answered'</SAMP>
<DD>
Означает, что вы послали ответ на это сообщение.  Приписывается командой
<KBD>r</KBD> (<CODE>rmail-reply</CODE>).  See section <A HREF="emacs_32.html#SEC360">Посылка ответов</A>.
<DT><SAMP>`forwarded'</SAMP>
<DD>
Означает, что вы перенаправляли сообщение другим.  Приписывается
командой <KBD>f</KBD> (<CODE>rmail-forward</CODE>).  See section <A HREF="emacs_32.html#SEC360">Посылка ответов</A>.
<DT><SAMP>`edited'</SAMP>
<DD>
Означает, что вы редактировали текст сообщения внутри Rmail.
See section <A HREF="emacs_32.html#SEC366">Редактирование внутри сообщения</A>.
<DT><SAMP>`resent'</SAMP>
<DD>
Означает, что вы пересылали это сообщение.  Приписывается командой
<KBD>M-x rmail-resend</KBD>.  See section <A HREF="emacs_32.html#SEC360">Посылка ответов</A>.
</DL>

<P>
  Все другие метки приписываются или удаляются только пользователем и не
имеют стандартного смысла.




<H2><A NAME="SEC360" HREF="emacs_toc.html#TOC360">Посылка ответов</A></H2>

<P>
  Rmail имеет ряд команд, которые используют режим Mail для посылки
исходящей корреспонденции.  See section <A HREF="emacs_31.html#SEC339">Посылка почты</A>, для справок по
использованию режима Mail, включая некоторые средства, предназначенные
для работы с Rmail.  А в этом разделе описываются специальные команды
Rmail для входа в режим Mail.  Следует отметить, что обычные команды для
посылки почты, <KBD>C-x m</KBD> и <KBD>C-x 4 m</KBD>, применимы в режиме Rmail и
работают точно так же, как обычно.


<DL COMPACT>

<DT><KBD>m</KBD>
<DD>
Послать сообщение (<CODE>rmail-mail</CODE>).
<DT><KBD>c</KBD>
<DD>
Продолжить редактирование уже начатого выходного сообщения
(<CODE>rmail-continue</CODE>).
<DT><KBD>r</KBD>
<DD>
Послать ответ на текущее сообщение Rmail (<CODE>rmail-reply</CODE>).
<DT><KBD>f</KBD>
<DD>
Перенаправить текущее сообщение другим пользователям (<CODE>rmail-forward</CODE>).
<DT><KBD>C-u f</KBD>
<DD>
Переслать сообщение другим пользователям (<CODE>rmail-resend</CODE>).
<DT><KBD>M-m</KBD>
<DD>
Попробовать послать отскочившее письмо еще раз
(<CODE>rmail-retry-failure</CODE>).
</DL>

<P>
<A NAME="IDX1886"></A>
<A NAME="IDX1887"></A>
<A NAME="IDX1888"></A>
  Самая распространенная причина посылки сообщения во время пребывания в
Rmail -- это необходимость ответа на сообщение, которое вы читаете.
Чтобы сделать это, наберите <KBD>r</KBD> (<CODE>rmail-reply</CODE>).  Это вызовет
появление буфера <TT>`*mail*'</TT> в другом окне, что очень похоже на
<KBD>C-x 4 m</KBD>, но при этом заранее инициализируются поля заголовка
<SAMP>`Subject'</SAMP>, <SAMP>`To'</SAMP>, <SAMP>`CC'</SAMP> и <SAMP>`In-reply-To'</SAMP>, основываясь
на сообщении, на которое формируется ответ.  Полю <SAMP>`To'</SAMP>
присваивается имя отправителя этого сообщения, а в поле <SAMP>`CC'</SAMP>
помещаются имена всех остальных его получателей.


<P>
<A NAME="IDX1889"></A>
  Вы можете предотвратить появление некоторых адресов в поле <SAMP>`CC'</SAMP>,
используя переменную <CODE>rmail-dont-reply-to-names</CODE>.  Ее значением
должно быть регулярное выражение (в виде строки): все получатели, чьи
адреса совпадают с этим регулярным выражением, будут исключены из поля
<SAMP>`CC'</SAMP>.  По умолчанию она соответствует вашему собственному имени и
любому имени, начинающемуся с <SAMP>`info-'</SAMP>.  (Эти имена исключаются,
потому что есть соглашение об использовании их для больших списков
рассылки для широкой публикации анонсов.)


<P>
  Чтобы полностью опустить поле <SAMP>`CC'</SAMP> в каком-то ответе, введите
команду ответа с числовым аргументом: <KBD>C-u r</KBD> или <KBD>1 r</KBD>.


<P>
  После того, как буфер <TT>`*mail*'</TT> проинициализирован, редактирование
и отправка почты идет как обычно (see section <A HREF="emacs_31.html#SEC339">Посылка почты</A>).  Если с вашей
точки зрения ранее подготовленные поля заголовка неправильны, то их
можно отредактировать.  Вы также можете использовать команды режима Mail
(see section <A HREF="emacs_31.html#SEC343">Режим Mail</A>), включая <KBD>C-c C-y</KBD>, которая вставляет
сообщение, на которое вы отвечаете.  Вы можете вернуться в буфер Rmail,
выбрать там другое сообщение, переключиться назад и вставить новое
текущее сообщение.


<P>
<A NAME="IDX1890"></A>
<A NAME="IDX1891"></A>
<A NAME="IDX1892"></A>
<A NAME="IDX1893"></A>
  Иногда сообщения не доходят по назначению.  Почтовые программы обычно
возвращают вам это письмо, заключив его в <EM>сообщение об отказе</EM>.
Команда Rmail <KBD>M-m</KBD> (<CODE>rmail-retry-failure</CODE>) подготавливает
этого же сообщение к повторной посылке: она создает буфер <TT>`*mail*'</TT>
с тем же телом и полями заголовка, какие были раньше.  Если вы сразу
нажмете <KBD>C-c C-c</KBD>, вы пошлете сообщение точно таким же, каким оно
было в первый раз.  Иначе, вы можете отредактировать его текст или
заголовки и затем отправить.  Переменная
<CODE>rmail-retry-ignored-headers</CODE>, в том же формате, что и
<CODE>rmail-ignored-headers</CODE> (see section <A HREF="emacs_32.html#SEC365">Отображение сообщений</A>), контролирует, какие заголовки будут удалены из сообщения об
отказе при попытке повторной отправки; по умолчанию она равна
<CODE>nil</CODE>.


<P>
<A NAME="IDX1894"></A>
<A NAME="IDX1895"></A>
<A NAME="IDX1896"></A>
  Еще одна достаточно частая причина отправки почты в Rmail заключается
в необходимости <EM>перенаправить</EM> текущее сообщение другим
пользователям.  Команда <KBD>f</KBD> (<CODE>rmail-forward</CODE>) облегчает это,
заранее инициализируя буфер <TT>`*mail*'</TT> текстом текущего сообщения и
указывая в поле <SAMP>`Subject'</SAMP>, что это перенаправленное письмо.  От вас
требуется только записать получателей и отправить.  Когда вы
перенаправляете сообщение, адресаты получают его "от вас", а его
содержимым является оригинальное сообщение.


<P>
<A NAME="IDX1897"></A>
  Перенаправленное сообщение заключается между двумя разделительными
строками.  Кроме этого, все строки в нем, начинающиеся с дефисов,
изменяются добавлением <SAMP>`- '</SAMP> в начало.  Когда вы получаете
перенаправленное сообщение, если оно содержит что-то кроме обычного
текста -- исходный код программы, например -- вы можете счесть удобным
проделать обратное преобразование.  Вы можете сделать это, выбрав
перенаправленное сообщение и напечатав <KBD>M-x
unforward-rmail-message</KBD>.  Эта команда извлекает оригинальное сообщение,
удаляя вставленные строки <SAMP>`- '</SAMP>, и вставляет его в Rmail-файл
как отдельное сообщение сразу после текущего.


<P>
<A NAME="IDX1898"></A>
  <EM>Пересылка</EM> -- это вариант, похожий на перенаправление; разница в
том, что при пересылке письмо отправляется "от начального посылателя",
таким же, каким оно пришло к вам, но с добавлением полей заголовка
<SAMP>`Resent-from'</SAMP> и <SAMP>`Resent-to'</SAMP>, чтобы обозначить, что оно исходит
от вас.  Чтобы переслать сообщение в Rmail, используйте <KBD>C-u f</KBD>.
(<KBD>f</KBD> запускает <CODE>rmail-forward</CODE>, которая запрограммирована так,
чтобы вызывать <CODE>rmail-resend</CODE>, если вы задали числовой аргумент.)


<P>
<A NAME="IDX1899"></A>
<A NAME="IDX1900"></A>
  Команда <KBD>m</KBD> (<CODE>rmail-mail</CODE>) используется для начала
редактирования исходящего сообщения, которое не является ответом.  Она
оставляет поля заголовка пустыми.  Единственное отличие ее от <KBD>C-x 4
m</KBD> состоит в том, что она обеспечивает доступность буфера Rmail для
<KBD>C-c C-y</KBD>, так же, как это делает <KBD>r</KBD>.  Таким образом, <KBD>m</KBD>
может быть использована для отправки ответа на сообщение или для
перенаправления; она может делать все, что делают команды <KBD>r</KBD> и
<KBD>f</KBD>.


<P>
<A NAME="IDX1901"></A>
<A NAME="IDX1902"></A>
  Команда <KBD>c</KBD> (<CODE>rmail-continue</CODE>) возобновляет редактирование
буфера <TT>`*mail*'</TT>, чтобы вы могли завершить сообщение, которое уже
составляли, а также для изменения сообщения, которое вы отправили.


<P>
<A NAME="IDX1903"></A>
  Если вы установите переменную <CODE>rmail-mail-new-frame</CODE> в значение,
не равное <CODE>nil</CODE>, то все команды Rmail для начала отправки сообщения
будут создавать для его редактирования новый фрейм.  Этот фрейм
удаляется, когда вы отсылаете сообщение, или когда вы используете пункт
<SAMP>`Don't Send'</SAMP> в меню <SAMP>`Mail'</SAMP>.


<P>
  Все команды Rmail для отправки сообщения используют тот метод
составления, который вы выбрали (see section <A HREF="emacs_31.html#SEC349">Способы составления сообщений</A>).




<H2><A NAME="SEC361" HREF="emacs_toc.html#TOC361">Резюме</A></H2>
<P>
<A NAME="IDX1904"></A>


<P>
  <EM>Резюме</EM> -- это буфер, который содержит по одной строке на
сообщение и дает вам возможность обзора почты в Rmail-файле.  В каждой
такой строке показан номер сообщения, его отправитель, метки и тема.
Почти все команды Rmail можно использовать также и в буфере резюме; они
относятся к сообщению, описанному на текущей строке.  Перемещение точки
в буфере резюме выбирает другие сообщения, когда вы переходите к их
строкам.


<P>
  Каждый буфер резюме относится только к одному Rmail-файлу; если
редактируется множество Rmail-файлов, то они имеют отдельные буферы
резюме.  Имя буфера резюме создается добавлением <SAMP>`-summary'</SAMP> в конец
имени буфера Rmail.  Как правило, в один и тот же момент показывается
только один буфер резюме.




<H3><A NAME="SEC362" HREF="emacs_toc.html#TOC362">Создание резюме</A></H3>

<P>
  Ниже приводятся команды для создания резюме для текущего Rmail-файла.
Если Rmail-файл имеет буфер резюме, изменения в этом файле (такие как
удаление или вычеркивание сообщений и получение новой почты)
автоматически обновляют резюме.


<DL COMPACT>

<DT><KBD>h</KBD>
<DD>
<DT><KBD>C-M-h</KBD>
<DD>
Создает резюме всех сообщений (<CODE>rmail-summary</CODE>).
<DT><KBD>l <VAR>метки</VAR> <KBD>RET</KBD></KBD>
<DD>
<DT><KBD>C-M-l <VAR>метки</VAR> <KBD>RET</KBD></KBD>
<DD>
Создает резюме сообщений, которые имеют одну или несколько указанных
меток (<CODE>rmail-summary-by-labels</CODE>).
<DT><KBD>C-M-r <VAR>получатели</VAR> <KBD>RET</KBD></KBD>
<DD>
Создает резюме сообщений, отправленных одному или нескольким из
указанных получателей (<CODE>rmail-summary-by-recipients</CODE>).
<DT><KBD>C-M-t <VAR>тема</VAR> <KBD>RET</KBD></KBD>
<DD>
Создает резюме сообщений, которые имеют совпадение с регулярным
выражением <VAR>тема</VAR> в полях заголовка <SAMP>`Subject'</SAMP>
(<CODE>rmail-summary-by-topic</CODE>).
</DL>

<P>
<A NAME="IDX1905"></A>
<A NAME="IDX1906"></A>
  Команда <KBD>h</KBD> или <KBD>C-M-h</KBD> (<CODE>rmail-summary</CODE>) заполняет буфер
резюме для текущего Rmail-файла перечнем всех сообщений из этого файла.
Потом она показывает и выбирает этот буфер резюме в другом окне.


<P>
<A NAME="IDX1907"></A>
<A NAME="IDX1908"></A>
<A NAME="IDX1909"></A>
  <KBD>C-M-l <VAR>метки</VAR> <KBD>RET</KBD></KBD> (<CODE>rmail-summary-by-labels</CODE>)
делает частичное резюме, упоминающее только сообщения, которые имеют
одну или несколько <VAR>меток</VAR>.  <VAR>Метки</VAR> должны содержать имена
меток, разделенные запятыми.


<P>
<A NAME="IDX1910"></A>
<A NAME="IDX1911"></A>
  <KBD>C-M-r <VAR>получатели</VAR> <KBD>RET</KBD></KBD>
(<CODE>rmail-summary-by-recipients</CODE>) делает частичное резюме,
упоминающее только сообщения, которые имеют одного или нескольких
<VAR>получателей</VAR>.  Аргумент <VAR>получатели</VAR> должен содержать почтовые
адреса, разделенные запятыми.


<P>
<A NAME="IDX1912"></A>
<A NAME="IDX1913"></A>
  <KBD>C-M-t <VAR>тема</VAR> <KBD>RET</KBD></KBD> (<CODE>rmail-summary-by-topic</CODE>)
создает частичное резюме, упоминающее только сообщения, чьи поля
<SAMP>`Subject'</SAMP> имеют совпадения с регулярным выражением <VAR>тема</VAR>.


<P>
  Следует отметить, что для любого Rmail-файла существует только один
буфер резюме; создание резюме одного вида отменяет любое ранее сделанное
резюме.


<P>
<A NAME="IDX1914"></A>
<A NAME="IDX1915"></A>
  Переменная <CODE>rmail-summary-window-size</CODE> говорит, сколько строк
должно использовать окно резюме.  Переменная
<CODE>rmail-summary-line-count-flag</CODE> указывает, должны ли строки резюме
содержать число, показывающее количество строк в сообщении.




<H3><A NAME="SEC363" HREF="emacs_toc.html#TOC363">Редактирование резюме</A></H3>

<P>
  Вы можете делать в буфере резюме Rmail практически все, что вы можете
делать в самом буфере Rmail.  На самом деле, если у вас есть буфер
резюме, нет необходимости переключаться назад в буфер Rmail.


<P>
  Вы можете выбирать и просматривать различные сообщения в буфере Rmail
из буфера резюме просто перемещая в нем точку к разным строкам.  Не
играет роли, какую именно команду Emacs вы используете для перемещения
точки; на какой строке окажется точка после команды, то сообщение и
будет выбрано в буфере Rmail.


<P>
  Почти все команды Rmail работают и в буфере резюме, также как и в
буфере Rmail.  А именно, <KBD>d</KBD> в буфере резюме удаляет текущее
сообщение, <KBD>u</KBD> отменяет удаление, а <KBD>x</KBD> вычеркивает.  <KBD>o</KBD> и
<KBD>C-o</KBD> выводят текущее сообщение в файл; <KBD>r</KBD> позволяет написать
ответ.  Вы можете прокручивать текущее сообщение, оставаясь в буфере
резюме, с помощью <KBD>SPC</KBD> и <KBD>DEL</KBD>.


<P>
  Команды Rmail для передвижения по сообщениям работают также и в буфере
резюме, но с особенностью: они перемещают по тем сообщениям, которые
перечислены в резюме.  Они также убеждаются, что буфер Rmail появляется
на экране (в отличие от команд движения курсора, которые обновляют
содержимое буфера Rmail, но не показывают его в окне, если он уже не
виден).  Вот перечень этих команд:


<DL COMPACT>

<DT><KBD>n</KBD>
<DD>
Перейти к следующей строке, пропуская удаленные, и выбрать ее сообщение.
<DT><KBD>p</KBD>
<DD>
Перейти к предыдущей строке, пропуская удаленные, и выбрать ее
сообщение.
<DT><KBD>M-n</KBD>
<DD>
Перейти к следующей строке и выбрать ее сообщение.
<DT><KBD>M-p</KBD>
<DD>
Перейти к предыдущей строке и выбрать ее сообщение.
<DT><KBD>&#62;</KBD>
<DD>
Перейти к последней строке и выбрать ее сообщение.
<DT><KBD>&#60;</KBD>
<DD>
Перейти к первой строке и выбрать ее сообщение.
<DT><KBD>M-s <VAR>образец</VAR> <KBD>RET</KBD></KBD>
<DD>
Производит поиск <VAR>образца</VAR> в сообщениях начиная с текущего; выбирает
найденное сообщение и перемещает точку в буфере резюме к его строке.
</DL>

<P>
<A NAME="IDX1916"></A>
  Удаление, отмена удаления, получение новой почты и даже выбор другого
сообщения -- все обновляют буфер резюме, когда вы делаете эти операции
в буфере Rmail.  Если переменная <CODE>rmail-redisplay-summary</CODE> не равна
<CODE>nil</CODE>, эти действия также возвращают буфер резюме на экран.


<P>
<A NAME="IDX1917"></A>
<A NAME="IDX1918"></A>
<A NAME="IDX1919"></A>
<A NAME="IDX1920"></A>
  Когда вы завершили использование резюме, наберите <KBD>Q</KBD>
(<CODE>rmail-summary-wipe</CODE>), чтобы удалить окно буфера резюме.  Вы также
можете выйти из Rmail, находясь в буфере резюме: <KBD>q</KBD>
(<CODE>rmail-summary-quit</CODE>) удаляет окно резюме, а затем выходит из
Rmail, записывая Rmail-файл и переключая в другой буфер.




<H2><A NAME="SEC364" HREF="emacs_toc.html#TOC364">Сортировка Rmail-файла</A></H2>

<DL COMPACT>

<DT><KBD>M-x rmail-sort-by-date</KBD>
<DD>
Сортирует сообщения текущего Rmail-файла по дате.

<DT><KBD>M-x rmail-sort-by-subject</KBD>
<DD>
Сортирует сообщения текущего Rmail-файла по теме.

<DT><KBD>M-x rmail-sort-by-author</KBD>
<DD>
Сортирует сообщения текущего Rmail-файла по имени автора.

<DT><KBD>M-x rmail-sort-by-recipient</KBD>
<DD>
Сортирует сообщения текущего Rmail-файла по именам получателей.

<DT><KBD>M-x rmail-sort-by-correspondent</KBD>
<DD>
Сортирует сообщения текущего Rmail-файла по имени другого
корреспондента.

<DT><KBD>M-x rmail-sort-by-lines</KBD>
<DD>
Сортирует сообщения текущего Rmail-файла по размеру (числу строк).

<DT><KBD>M-x rmail-sort-by-keywords <KBD>RET</KBD> <VAR>метки</VAR> <KBD>RET</KBD></KBD>
<DD>
Сортирует сообщения текущего Rmail-файла по меткам.  Аргумент
<VAR>метки</VAR> должен быть списком меток, разделенных запятыми.  Порядок
этих меток определяет порядок сообщений; сообщения с первой меткой идут
первыми, сообщения со второй меткой идут вторыми, и так далее.
Сообщения, не имеющие ни одну из этих меток, идут последними.
</DL>

<P>
  Команды Rmail для сортировки производят <EM>устойчивую сортировку</EM>:
если нет причины предпочитать одно из двух сообщений, их порядок не
изменяется.  Вы можете использовать это для сортировки по нескольким
критериям.  Например, если вы применили <CODE>rmail-sort-by-date</CODE> и
затем <CODE>rmail-sort-by-author</CODE>, сообщения от одного автора появятся в
порядке возрастания даты.


<P>
  С числовым аргументом, все эти команды изменяют порядок сравнения на
противоположный.  Это означает, что они сортируют сообщения от новых к
старым, от больших в меньшим или в обратном алфавитном порядке.




<H2><A NAME="SEC365" HREF="emacs_toc.html#TOC365">Отображение сообщений</A></H2>

<P>
  Rmail переформатирует заголовок каждого сообщения перед его показом.
При этом удаляются неинтересные поля заголовков, чтобы уменьшить
беспорядок.  Чтобы посмотреть заголовок целиком или повторить операцию
переформатирования, вы можете использовать команду <KBD>t</KBD>
(<CODE>rmail-toggle-headers</CODE>).


<DL COMPACT>

<DT><KBD>t</KBD>
<DD>
Включает или выключает показ полного заголовка
(<CODE>rmail-toggle-header</CODE>).
</DL>

<P>
<A NAME="IDX1921"></A>
  При переформатировании удаляются большинство полей заголовка,
поскольку они не представляют интереса.  Переменная
<CODE>rmail-ignored-headers</CODE> содержит регулярное выражение, указывающее
какие поля надо скрывать таким способом -- если оно соответствует
началу поля, то это поле скрывается.


<P>
<A NAME="IDX1922"></A>
<A NAME="IDX1923"></A>
  Rmail сохраняет полные исходные заголовки перед переформатированием;
чтобы посмотреть их, используйте команду <KBD>t</KBD>
(<CODE>rmail-toggle-headers</CODE>).  Она сбрасывает переформатированные
заголовки текущего сообщения и показывает его с исходными заголовками.
Повтор команды <KBD>t</KBD> снова переформатирует сообщение.  Повторный выбор
сообщения тоже приводит к переформатированию.


<P>
  Одно из последствий этого состоит в том, что если вы редактировали
переформатированный заголовок (с помощью <KBD>e</KBD>; see section <A HREF="emacs_32.html#SEC366">Редактирование внутри сообщения</A>), последующее использование
<KBD>t</KBD> сбросит ваши изменения.  С другой стороны, если вы использовали
<KBD>e</KBD> после <KBD>t</KBD>, чтобы редактировать первоначальный (не
переформатированный) заголовок, эти изменения останутся.


<P>
  Когда команде <KBD>t</KBD> дан префиксный аргумент, положительный аргумент
обозначает показ переформатированного заголовка, а нулевой или
отрицательный -- полного.


<P>
<A NAME="IDX1924"></A>
  При использовании в оконной системе, которая поддерживает несколько
шрифтов, Rmail подсвечивает некоторые поля заголовка, которые особенно
интересны -- по умолчанию это поля <SAMP>`From'</SAMP> и <SAMP>`Subject'</SAMP>.
Переменная <CODE>rmail-highlighted-headers</CODE> хранит регулярное выражение,
задающее поля заголовка, которые нужно подсвечивать; если оно
соответствует началу поля, все это поле подсвечивается.


<P>
 Если вы зададите необычные цвета для текста и фона, то цвета,
используемые для подсветки, могут с ними плохо смотреться.  В таком
случае задайте другие цвета для начертания <CODE>highlight</CODE>.  Это стоит
сделать, потому что начертание <CODE>highlight</CODE> используется и других
видах выделения.  See section <A HREF="emacs_22.html#SEC189">Использование разных начертаний</A>, чтобы узнать, как это сделать.


<P>
  Чтобы полностью выключить подсветку в Rmail, установите
<CODE>rmail-highlighted-headers</CODE> равной <CODE>nil</CODE>.




<H2><A NAME="SEC366" HREF="emacs_toc.html#TOC366">Редактирование внутри сообщения</A></H2>

<P>
  Большинство обычных команд Emacs доступны в режиме Rmail, хотя
некоторые, такие как <KBD>C-M-n</KBD> и <KBD>C-M-h</KBD>, переопределяются в Rmail
для других целей.  Однако обычно буфер Rmail предназначен только для
чтения, и большинство букв переопределены как команды Rmail.  Если вы
хотите отредактировать текст сообщения, вы должны использовать команду
Rmail <KBD>e</KBD>.


<DL COMPACT>

<DT><KBD>e</KBD>
<DD>
Редактировать текущее сообщение как обычный текст.
</DL>

<P>
<A NAME="IDX1925"></A>
<A NAME="IDX1926"></A>
  Команда <KBD>e</KBD> (<CODE>rmail-edit-current-message</CODE>) переключает из
режима Rmail в режим Rmail Edit, другой основной режим, практически
эквивалентный режиму Text.  Это изменение отображается в строке режима.


<P>
  В режиме Rmail Edit буквы вставляют себя как обычно, а команды Rmail
недоступны.  Когда вы закончите редактирование сообщения и будете готовы
вернуться в Rmail, наберите команду <KBD>C-c C-c</KBD>, которая переключит
вас назад в режим Rmail.  С другой стороны, можно вернуться в режим
Rmail, но отменить все сделанные изменения, набрав <KBD>C-c C-]</KBD>.


<P>
<A NAME="IDX1927"></A>
  Вход в режим Rmail Edit вызывает ловушку <CODE>text-mode-hook</CODE>, а
затем ловушку <CODE>rmail-edit-mode-hook</CODE> (see section <A HREF="emacs_36.html#SEC449">Ловушки</A>).  При этом в
сообщению присваивается атрибут <SAMP>`edited'</SAMP>.  Она также показывает
полный заголовок сообщения, так что вы можете редактировать как тело,
так и заголовки сообщения, и ваши изменения в заголовках останутся
навсегда.




<H2><A NAME="SEC367" HREF="emacs_toc.html#TOC367">Сообщения-дайджесты</A></H2>
<P>
<A NAME="IDX1928"></A>
<A NAME="IDX1929"></A>


<P>
  <EM>Сообщение-дайджест</EM> -- это сообщение, которое создано для
передачи нескольких других сообщений.  Дайджесты используются в
некоторых списках рассылки с ведущим; все сообщения, которые пришли для
рассылки в течение какого-то периода времени, например одного дня,
помещаются в единый дайджест, который затем рассылается подписчикам.
Пересылка одного такого дайджеста занимает гораздо меньше машинного
времени, чем пересылка отдельных сообщений, хоть и при одинаковом общем
объеме, поскольку затраты ресурсов на одно сообщение при передаче почты
по сети довольно значительны.


<P>
<A NAME="IDX1930"></A>
  При получении сообщения-дайджеста наиболее удобным способом для его
прочтения является <EM>разброшюровка</EM>: обратное разделение его на
несколько отдельных сообщений.  После этого можно читать и удалять
отдельные сообщения как вам угодно.


<P>
  Чтобы сделать это, необходимо выбрать сообщение-дайджест и затем
набрать команду <KBD>M-x undigestify-rmail-message</KBD>.  Она извлекает
каждое подсообщение как отдельное сообщение Rmail и вставляет их вслед
за дайджестом.  Само сообщение-дайджест помечается как удаленное.




<H2><A NAME="SEC368" HREF="emacs_toc.html#TOC368">Преобразование Rmail-файла в системный формат</A></H2>

<P>
<A NAME="IDX1931"></A>
  Команда <KBD>M-x unrmail</KBD> преобразует файл в формате Rmail в формат
входных почтовых ящиков (также известный как системный почтовый формат),
чтобы вы могли использовать его с другими программами для редактирования
почты.  Вы должны указать два аргумента, имя Rmail-файла и имя для
преобразованного файла.  <KBD>M-x unrmail</KBD> не изменяет сам Rmail-файл.




<H2><A NAME="SEC369" HREF="emacs_toc.html#TOC369">Чтение сообщений в Rot13</A></H2>
<P>
<A NAME="IDX1932"></A>


<P>
  Сообщения из списков рассылки, которые могут оскорбить некоторых
читателей, иногда кодируются простым методом, называемым <EM>rot13</EM> ---
потому что он сдвигает алфавит на 13 букв.  Этот код служит не для
секретности, он не предоставляет ее; скорее, он позволяет тем, кто может
быть оскорблен, избежать возможности даже увидеть настоящий текст
сообщения.


<P>
<A NAME="IDX1933"></A>
  Чтобы просмотреть буфер, использующий код rot13, запустите команду
<KBD>M-x rot13-other-window</KBD>.  Она показывает текущий буфер в другом
окне, применяя код при отображении текста.




<H2><A NAME="SEC370" HREF="emacs_toc.html#TOC370"><CODE>movemail</CODE> и POP</A></H2>
<P>
<A NAME="IDX1934"></A>


<P>
<A NAME="IDX1935"></A>
  При получении новой почты Rmail сначала копирует ее из входного файла
в Rmail-файл; затем он записывает Rmail-файл; затем усекает входной
файл.  Таким образом, сбой в системе может вызвать дублирование почты во
входном файле и в Rmail-файле, но не может вызвать потери.  Если
<CODE>rmail-preserve-inbox</CODE> не равна <CODE>nil</CODE>, то Rmail будет
копировать новую почту из входного файла в Rmail-файл, не усекая входной
файл.  Вы можете сделать такую установку, например, на портативном
компьютере, который вы используете для проверки почты через POP во время
путешествий, чтобы ваша почта оставалась на сервере, и вы могли
сохранить ее позднее на своей рабочей станции.


<P>
  В некоторых случаях Rmail копирует новую почту из входного файла не
прямым путем.  Сначала он запускает программу @command{movemail}, чтобы
переместить почту из входного файла в промежуточный файл, называемый
<TT>`~/.newmail-<VAR>входной-файл</VAR>'</TT>.  Затем Rmail вносит новую почту из
этого файла, сохраняет Rmail-файл и только затем удаляет промежуточный
файл.  Если в неподходящий момент случится фатальный сбой, этот файл
останется на месте, и Rmail будет использовать его в следующий раз при
получении новой почты из этого входного файла.


<P>
<A NAME="IDX1936"></A>
  Если Rmail по какой-то причине не может преобразовать данные из файла
<TT>`~/.newmail-<VAR>входной-файл</VAR>'</TT> в формат Babyl, он переименовывает
его в <TT>`~/RMAILOSE.<VAR>n</VAR>'</TT> (<VAR>n</VAR> -- это целое число, выбранное
так, чтобы оно было уникальным), так что Rmail не будет иметь проблем с
этими данными снова.  Вам стоит просмотреть этот файл, найти сообщение,
которое сбивает с толку Rmail (вероятно, оно содержит знак
control-подчерк, восьмеричный код 037), и удалить его.  Тогда вы можете
использовать <KBD>1 g</KBD>, чтобы получить почту из исправленного файла.


<P>
  Некоторые системы используют для доступа к данным почтовых ящиков
пользователей метод, называемый POP, вместо записи этих данных в
почтовые файлы.  @command{movemail} может работать с POP, если вы
скомпилировали ее с определенным макросом <CODE>MAIL_USE_POP</CODE>.  (Вы
можете получить это, задав ключ <SAMP>`--with-pop'</SAMP>, когда запускаете
@command{configure} во время установки Emacs.)  @command{movemail}
работает только с POP3, но не с более ранними версиями POP.


<P>
<A NAME="IDX1937"></A>
<A NAME="IDX1938"></A>
В предположении, что вы правильно скомпилировали и установили
@command{movemail}, вы можете указать входной почтовый ящик POP, написав
"имя файла" в форме <SAMP>`po:<VAR>имя-пользователя</VAR>'</SAMP> в списке входных
почтовых ящиков Rmail-файла.  @command{movemail} обрабатывает такие
имена путем установки соединения с POP-сервером.  Переменная среды
@env{MAILHOST} задает машину, на которой будет производиться поиск
сервера.


<P>
<A NAME="IDX1939"></A>
<A NAME="IDX1940"></A>
  Для доступа к почте через POP может потребоваться пароль.  Если
переменная <CODE>rmail-pop-password</CODE> отлична от <CODE>nil</CODE>, то она
задает пароль для использования с POP.  Иначе, если
<CODE>rmail-pop-password-required</CODE> не равна <CODE>nil</CODE>, то Rmail
спрашивает пароль у вас.


<P>
<A NAME="IDX1941"></A>
  Если вам нужно передать @command{movemail} дополнительные флаги
командной строки, установите переменную <CODE>rmail-movemail-flags</CODE>
равной списку желаемых флагов.  Не используйте эту переменную для
передачи флага @option{-p}, который предотвращает затирание содержимого
входного файла; пользуйтесь вместо этого переменной
<CODE>rmail-preserve-inbox</CODE>.


<P>
<A NAME="IDX1942"></A>
  Установленная в вашей системе программа @command{movemail} может
поддерживать аутенфикацию Kerberos.  Если она поддерживается, то это
будет использоваться по умолчанию всегда, когда вы будете пытаться
получить почту через POP при неустановленных <CODE>rmail-pop-password</CODE> и
<CODE>rmail-pop-password-required</CODE>.


<P>
<A NAME="IDX1943"></A>
  Некоторые POP-серверы хранят сообщения в обратном порядке.  Если ваш
сервер делает так, а вам хотелось бы читать почту в том порядке, в каком
она поступала, вы можете велеть @command{movemail} перевернуть
очередность загружаемых сообщений, добавив к <CODE>rmail-movemail-flags</CODE>
флаг @option{-r}.
<P><HR><P>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_31.html">previous</A>, <A HREF="emacs_33.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
<script src="http://www.google-analytics.com/urchin.js" type="text/javascript"></script><script type="text/javascript">_uacct = "UA-78697-3"; urchinTracker(); </script></body>
</HTML>
