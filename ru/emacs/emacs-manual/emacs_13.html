<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from emacs.texi on 29 October 2002 -->

<TITLE>Руководство по GNU Emacs - Пометка и область</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_12.html">previous</A>, <A HREF="emacs_14.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC55" HREF="emacs_toc.html#TOC55">Пометка и область</A></H1>
<P>
<A NAME="IDX254"></A>
<A NAME="IDX255"></A>
<A NAME="IDX256"></A>


<P>
  Существует множество команд Emacs, которые работают с произвольной
непрерывной частью текущего буфера.  Чтобы задать текст, над которым
работают такие команды, вы устанавливаете <EM>метку</EM> в одном конце
этого текста, и передвигаете точку в другой его конец.  Текст,
расположенный между точкой и меткой, называется <EM>областью</EM>.  Если вы
задействовали режим Transient Mark, Emacs выделяет область цветом
(see section <A HREF="emacs_13.html#SEC57">Режим Transient Mark</A>).


<P>
  Чтобы регулировать границы области, вы можете двигать точку или метку.
Не имеет значения, которая из них установлена первой в хронологическом
порядке, или какая появляется первой в тексте.  Как только метка
установлена, она остается до тех пор, пока не будет установлена снова в
другом месте.  Каждый буфер имеет свою собственную метку, таким образом,
когда вы возвращаетесь в буфер, который выбирался прежде, он сохраняет
ту же самую метку, что и прежде.


<P>
  Многие команды, которые вставляют текст, например <KBD>C-y</KBD>
(<CODE>yank</CODE>) и <KBD>M-x insert-buffer</KBD>, располагают метку в одном из
концов вставленного текста, противоположном тому, где помещается точка,
таким образом, область содержит только что вставленный текст.


<P>
  Помимо ограничения области, пометка также полезна для запоминания
места, к которому вы, возможно, захотите вернуться.  Чтобы сделать эту
возможность более полезной, Emacs запоминает 16 предыдущих позиций метки
в <EM>списке пометок</EM>.




<H2><A NAME="SEC56" HREF="emacs_toc.html#TOC56">Установка метки</A></H2>

<P>
   Здесь приводятся некоторые команды для установки метки:


<DL COMPACT>

<DT><KBD>C-<KBD>SPC</KBD></KBD>
<DD>
Установить метку в точке (<CODE>set-mark-command</CODE>).
<DT><KBD>C-@</KBD>
<DD>
То же самое.
<DT><KBD>C-x C-x</KBD>
<DD>
Поменять местами метку и точку (<CODE>exchange-point-and-mark</CODE>).
<DT><KBD>Drag-Mouse-1</KBD>
<DD>
Установить точку и пометить текст, по которому вы провели.
<DT><KBD>Mouse-3</KBD>
<DD>
Установить метку в точке и переместить точку к позиции, на которой вы
щелкнули.  (<CODE>mouse-save-then-kill</CODE>).
</DL>

<P>
  Например, если вы хотите преобразовать часть буфера так, чтобы он весь
был набран прописными буквами, вы можете использовать команду <KBD>C-x
C-u</KBD> (<CODE>upcase-region</CODE>), которая оперирует с текстом в области.  Вы
можете сначала отправится в начало текста, который должен быть написан
прописными буквами, набрать <KBD>C-<KBD>SPC</KBD></KBD>, чтобы установить там
метку, передвинуться в конец текста и затем набрать <KBD>C-x C-u</KBD>.  Либо
вы можете установить метку в конце текста, сдвинуться в начало и затем
набрать <KBD>C-x C-u</KBD>.


<P>
<A NAME="IDX257"></A>
<A NAME="IDX258"></A>
  Наиболее общий способ установки метки -- делать это с помощью команды
<KBD>C-<KBD>SPC</KBD></KBD> (<CODE>set-mark-command</CODE>).  Так устанавливается
пометка в позиции точки.  Затем вы можете отодвинуть точку, оставляя
метку на месте.


<P>
  Есть два способа установить метку с помощью мыши.  Вы можете провести
мышью с нажатой первой кнопкой по отрезку текста; это поместит точку
там, где вы отпустили кнопку мыши, и установит метку на другом конце
этого отрезка.  Или вы можете щелкнуть третьей кнопкой мыши, что
устанавливает метку в точке (как <KBD>C-<KBD>SPC</KBD></KBD>) и затем перемещает
точку (как <KBD>Mouse-1</KBD>).  Оба этих способа помимо установки метки
копируют область в список уничтожений; такое поведение соответствует
поведению других оконных приложений, но если вы не хотите изменять
список уничтожений, вы должны использовать для установки метки команды
клавиатуры.  See section <A HREF="emacs_22.html#SEC177">Команды мыши для редактирования</A>.


<P>
<A NAME="IDX259"></A>
<A NAME="IDX260"></A>
  На обычных терминалах есть только один курсор, так что Emacs не может
показать вам местонахождение метки.  Вы должны его помнить.  Обычный
выход из ситуации -- установить метку, а затем быстро ее использовать
до того, как вы забудете, где она расположена.  Но вы можете увидеть
позицию метки с помощью команды <KBD>C-x C-x</KBD>
(<CODE>exchange-point-and-mark</CODE>), которая устанавливает метку туда, где
была точка, а точку туда, где была метка.  Положение области остается
неизменным, а курсор и точка находятся теперь в предыдущей позиции
метки.  В режиме Transient Mark эта команда активизирует пометку.


<P>
  <KBD>C-x C-x</KBD> также полезна, когда вы удовлетворены положением точки,
но хотите передвинуть другой конец области (где находится метка);
сделайте <KBD>C-x C-x</KBD> для того, чтобы установить точку на место метки,
и затем вы можете двигать метку.  Используя <KBD>C-x C-x</KBD> во второй раз,
если это необходимо, вы установите метку в новой позиции, а точку
вернете в ее прежнюю позицию.


<P>
<A NAME="IDX261"></A>
  В ASCII не существует знака <KBD>C-<KBD>SPC</KBD></KBD>; когда вы набираете
<KBD>SPC</KBD>, удерживая <KBD>CTRL</KBD> в нажатом положении, на большинстве
обычных терминалов вы получите знак <KBD>C-@</KBD>.  Это и есть ключ,
фактически привязанный к <CODE>set-mark-command</CODE>.  Но если вы не
настолько неудачливы, чтобы получить терминал, где набирая
<KBD>C-<KBD>SPC</KBD></KBD>, вы не получаете <KBD>C-@</KBD>, вы можете думать об этом
знаке как о <KBD>C-<KBD>SPC</KBD></KBD>.  Под X, <KBD>C-<KBD>SPC</KBD></KBD> на самом деле
является отдельным знаком, но привязан он все равно к
<CODE>set-mark-command</CODE>.




<H2><A NAME="SEC57" HREF="emacs_toc.html#TOC57">Режим Transient Mark</A></H2>
<P>
<A NAME="IDX262"></A>
<A NAME="IDX263"></A>
<A NAME="IDX264"></A>
<A NAME="IDX265"></A>
<A NAME="IDX266"></A>
<A NAME="IDX267"></A>
<A NAME="IDX268"></A>


<P>
  Emacs может подсвечивать текущую область, используя X Windows.  Но
обычно он этого не делает.  Почему?


<P>
  Подсветка области обычно не работает в Emacs хорошо, потому что как
только вы поставили метку, <EM>всегда</EM> есть область (в этом буфере).
А постоянная подсветка области раздражала бы.


<P>
  Вы можете включить подсветку помеченной области, задействовав режим
Transient Mark.  Это более жесткий режим действий, в котором область
"существует" только временно, так что вы должны задавать область для
каждой команды, которая ее использует.  В режиме Transient Mark большую
часть времени области нет; таким образом, подсветка области, когда она
существует, удобна.


<P>
<A NAME="IDX269"></A>
  Чтобы включить режим Transient Mark, выполните команду <KBD>M-x
transient-mark-mode</KBD>.  Эта команда переключает данный режим, а значит вы
можете повторить ее для выключения этого режима.


<P>
  Вот подробности о режиме Transient Mark:



<UL>
<LI>

Чтобы установить метку, введите <KBD>C-<KBD>SPC</KBD></KBD>
(<CODE>set-mark-command</CODE>).  Это сделает метку активной; при перемещении
точки вы увидите, что область увеличивается или уменьшается.

<LI>

Команды мыши для задания пометки также делают ее активной.  То же делают
и команды клавиатуры, чья цель -- установить область, включая
<KBD>M-@</KBD>, <KBD>C-M-@</KBD>, <KBD>M-h</KBD>, <KBD>C-M-h</KBD>, <KBD>C-x C-p</KBD> и
<KBD>C-x h</KBD>.

<LI>

Когда метка активна, вы можете выполнять команды, действующие на
область, такие как уничтожение, создание отступа или запись в файл.

<LI>

Любое изменение буфера, например вставка или удаление знака,
деактивизирует пометку.  Это означает, что последующие команды,
действующие на область, получат ошибку и не смогут работать.  Вы можете
сделать область снова активной, введя <KBD>C-x C-x</KBD>.

<LI>

Команды вроде <KBD>M-&#62;</KBD> и <KBD>C-s</KBD>, которые "оставляют метку" помимо
какой-то другой основной цели, не активизируют новую метку.  Вы можете
активизировать новую область, выполнив <KBD>C-x C-x</KBD>
(<CODE>exchange-point-and-mark</CODE>).

<LI>

<KBD>C-s</KBD> не изменяет метку, если она активна.

<LI>

Выход с помощью <KBD>C-g</KBD> деактивизирует метку.
</UL>

<P>
  Для подсветки области используется начертание <CODE>region</CODE>; вы можете
настроить способ подсветки области, изменив это начертание.
See section <A HREF="emacs_36.html#SEC447">Настройка начертаний</A>.


<P>
<A NAME="IDX270"></A>
  Когда несколько окон показывают один и тот же буфер, они имеют разные
области, потому что у них могут быть разные значения точки (хотя все они
имеют одинаковую позицию метки.)  Обычно только выбранное окно
подсвечивает область (see section <A HREF="emacs_21.html#SEC169">Множество окон</A>).  Однако, если переменная
<CODE>highlight-nonselected-windows</CODE> не равна <CODE>nil</CODE>, то каждое окно
подсвечивает свою область (если включен режим Transient Mark, и метка в
буфере этого окна активна).


<P>
  Когда режим Transient Mark не включен, каждая команда, устанавливающая
метку, также и активизирует ее, но ничто не деактивизирует метку.


<P>
<A NAME="IDX271"></A>
  Если в режиме Transient Mark переменная <CODE>mark-even-if-inactive</CODE>
не равна <CODE>nil</CODE>, то команды могут использовать метку и область, даже
если они не активны.  Подсветка области появляется и исчезает так же, как
обычно в режиме Transient Mark, но метка на самом деле не исчезает,
когда исчезает подсветка.


<P>
<A NAME="IDX272"></A>
<A NAME="IDX273"></A>
  Режим Transient Mark также известен как "режим Zmacs", потому что
редактор Zmacs на MIT Lisp Machine обращался с пометкой похожим образом.




<H2><A NAME="SEC58" HREF="emacs_toc.html#TOC58">Работа с областью</A></H2>

<P>
<A NAME="IDX274"></A>
  Как только вы создали область, и метка активна, вы можете делать
различные вещи с текстом этой области:



<UL>
<LI>

Уничтожить его с помощью <KBD>C-w</KBD> (see section <A HREF="emacs_14.html#SEC63">Удаление и уничтожение</A>).
<LI>

Записать его в регистр с помощью <KBD>C-x r s</KBD> (see section <A HREF="emacs_15.html#SEC73">Регистры</A>).
<LI>

Записать его в буфер или файл (see section <A HREF="emacs_14.html#SEC71">Накопление текста</A>).
<LI>

Преобразовать регистр с помощью <KBD>C-x C-l</KBD> или <KBD>C-x C-u</KBD>
(see section <A HREF="emacs_26.html#SEC227">Команды преобразования регистра</A>).
<LI>

Сделать отступ с помощью <KBD>C-x <KBD>TAB</KBD></KBD> или <KBD>C-M-\</KBD>
(see section <A HREF="emacs_25.html#SEC213">Отступы</A>).
<LI>

Заполнить его как текст с помощью <KBD>M-x fill-region</KBD>
(see section <A HREF="emacs_26.html#SEC222">Заполнение текста</A>).
<LI>

Распечатать с помощью <KBD>M-x print-region</KBD> (see section <A HREF="emacs_35.html#SEC428">Вывод твердой копии</A>).
<LI>

Вычислить его как Лисп-код с помощью <KBD>M-x eval-region</KBD>
(see section <A HREF="emacs_28.html#SEC323">Вычисление выражений Emacs-Lisp</A>).
</UL>

<P>
  Большинство команд, которые оперируют с текстом в области, в своем
имени содержат слово <CODE>region</CODE>.




<H2><A NAME="SEC59" HREF="emacs_toc.html#TOC59">Команды для пометки текстуальных объектов</A></H2>

<P>
<A NAME="IDX275"></A>
  Здесь представлены команды для помещения точки и метки вокруг
текстуальных объектов, таких как слово, список, абзац или страница.


<DL COMPACT>

<DT><KBD>M-@</KBD>
<DD>
Установить метку после конца следующего слова (<CODE>mark-word</CODE>).  Эта и
следующая команды не передвигают точку.
<DT><KBD>C-M-@</KBD>
<DD>
Установить метку после конца следующего Лисп-выражения
(<CODE>mark-sexp</CODE>).
<DT><KBD>M-h</KBD>
<DD>
Установить область вокруг абзаца (<CODE>mark-paragraph</CODE>).
<DT><KBD>C-M-h</KBD>
<DD>
Установить область вокруг текущего определения функции Лиспа
(<CODE>mark-defun</CODE>).
<DT><KBD>C-x h</KBD>
<DD>
Установить область вокруг всего текущего буфера
(<CODE>mark-whole-buffer</CODE>).
<DT><KBD>C-x C-p</KBD>
<DD>
Установить область вокруг текущей страницы (<CODE>mark-page</CODE>).
</DL>

<P>
<KBD>M-@</KBD> (<CODE>mark-word</CODE>) устанавливает метку в конце следующего
слова, а <KBD>C-M-@</KBD> (<CODE>mark-sexp</CODE>) устанавливает ее в конец
следующего выражения Лиспа.  Эти команды обрабатывают свои аргументы так
же, как <KBD>M-f</KBD> и <KBD>C-M-f</KBD>.


<P>
<A NAME="IDX276"></A>
<A NAME="IDX277"></A>
   Другие команды устанавливают как метку, так и точку, чтобы ограничить
объект в буфере.  Например, <KBD>M-h</KBD> (<CODE>mark-paragraph</CODE>)
передвигает точку в начало абзаца, который окружает точку или следует за
ней, и устанавливает метку в конце этого абзаца (see section <A HREF="emacs_26.html#SEC220">Абзацы</A>).  Эта
команда подготавливает область, чтобы вы могли сделать отступы,
переключить регистр или уничтожить весь абзац.


<P>
  <KBD>C-M-h</KBD> (<CODE>mark-defun</CODE>) также устанавливает точку впереди, а
метку после текущего или следующего определения функции
(see section <A HREF="emacs_27.html#SEC253">Определения функций</A>).  <KBD>C-x C-p</KBD> (<CODE>mark-page</CODE>)
устанавливает точку перед текущей страницей, а метку -- в конце
страницы (see section <A HREF="emacs_26.html#SEC221">Страницы</A>).  Пометка идет после ограничителя страницы
(чтобы включить и его), точка идет после ограничителя предыдущей
страницы (чтобы исключить его).  Числовой аргумент задает более позднюю
страницу (если аргумент положителен) или более раннюю (если он
отрицателен) вместо текущей страницы.


<P>
  Наконец, <KBD>C-x h</KBD> (<CODE>mark-whole-buffer</CODE>) помечает весь буфер
как область, устанавливая точку в начало, а метку в конец.


<P>
  В режиме Transient Mark все эти команды активизируют метку.




<H2><A NAME="SEC60" HREF="emacs_toc.html#TOC60">Список пометок</A></H2>

<P>
<A NAME="IDX278"></A>
<A NAME="IDX279"></A>
<A NAME="IDX280"></A>
  Помимо ограничения области, пометка служит также для запоминания
места, в которое вы хотели бы вернуться.  Чтобы сделать эту возможность
более полезной, Emacs запоминает 16 предыдущих позиций метки в
<EM>списке пометок</EM>.  Большинство команд, которые устанавливают метку,
вставляют старую метку в этот список.  Чтобы вернуться к отмеченной
позиции, используют <KBD>C-u C-<KBD>SPC</KBD></KBD> (или <KBD>C-u C-@</KBD>), это
команда <KBD>set-mark-command</KBD>, которой дан числовой аргумент.  Она
передвигает точку туда, где была пометка, и восстанавливает метку из
списка прежних пометок.  Так, повторное использование этой команды
передвигает точку ко всем старым пометкам в списке, к одной за другой.
Метки, через которые вы проходите, попадают в конец списка, таким
образом ни одна из них не пропадает.


<P>
  Каждый буфер имеет свой собственный список пометок.  Все команды
редактирования используют список пометок текущего буфера.  В частности,
<KBD>C-u C-<KBD>SPC</KBD></KBD> всегда остается в том же самом буфере.


<P>
  Многие команды, передвигающие на большие расстояния, такие, например,
как <KBD>M-&#60;</KBD> (<CODE>beginning-of-buffer</CODE>), начинают с установки метки и
записи старого значения в список пометок.  Это сделано для того, чтобы
вам было легче впоследствии вернуться назад.  Поиски делают это за
исключением тех случаев, когда они фактически не двигают точку.  Вы
можете видеть, когда какая-либо команда устанавливает метку, по тому,
что она печатает в эхо-области сообщение <SAMP>`Mark Set'</SAMP>.


<P>
  Если вы хотите возвращаться к одному и тому же месту снова и снова,
список пометок может оказаться недостаточно удобным.  В таком случае вы
можете записать позицию в регистр для последующего получения
(see section <A HREF="emacs_15.html#SEC74">Запись позиций в регистры</A>).


<P>
<A NAME="IDX281"></A>
  Переменная <CODE>mark-ring-max</CODE> задает максимальное число элементов в
списке пометок.  Если уже имеется максимальное количество элементов, и
заталкивается еще один, то последний из существующего списка
сбрасывается.  Повторение <KBD>C-u C-<KBD>SPC</KBD></KBD> прокручивает среди
позиций, которые находятся в данный момент в списке.


<P>
<A NAME="IDX282"></A>
  Переменная <CODE>mark-ring</CODE> хранит сам список пометок как список
помеченных объектов, где первым идет записанный самым последним.  Данная
переменная является локальной в каждом буфере.




<H2><A NAME="SEC61" HREF="emacs_toc.html#TOC61">Глобальный список пометок</A></H2>
<P>
<A NAME="IDX283"></A>


<P>
  Кроме обычного списка пометок, который принадлежит каждому буферу, в
Emacs есть единый <EM>глобальный список пометок</EM>.  В нем записывается
последовательность буферов, в которых вы недавно устанавливали метки,
чтобы вы могли вернуться к этим буферам.


<P>
  При установке метки всегда создается вхождение в списке пометок
текущего буфера.  Если вы переключали буферы после предыдущей установки
метки, позиция новой метки вносится также и в глобальный список пометок.
В результате глобальный список пометок хранит последовательность
буферов, в которых вы побывали, и место в каждом из них, где вы
поставили метку.


<P>
<A NAME="IDX284"></A>
<A NAME="IDX285"></A>
  Команда <KBD>C-x C-<KBD>SPC</KBD></KBD> (<CODE>pop-global-mark</CODE>) переводит к
буферу и позиции последнего вхождения в глобальном списке пометок.  Она
также проматывает этот список, чтобы последовательное применение команды
<KBD>C-x C-<KBD>SPC</KBD></KBD> перемещало вас ко все более ранним буферам.
<P><HR><P>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_12.html">previous</A>, <A HREF="emacs_14.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
</BODY>
</HTML>
