<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from emacs.texi on 29 October 2002 -->

<TITLE>Руководство по GNU Emacs - Знаки, ключи и команды</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_6.html">previous</A>, <A HREF="emacs_8.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC17" HREF="emacs_toc.html#TOC17">Знаки, ключи и команды</A></H1>

<P>
  Эта глава рассказывает о наборах знаков, используемых в Emacs для
ввода команд и внутри файлов, а также объясняет концепции <EM>ключей</EM> и
<EM>команд</EM>, которые необходимы для понимания того, как Emacs
воспринимает ввод с клавиатуры и мыши.




<H2><A NAME="SEC18" HREF="emacs_toc.html#TOC18">Виды пользовательского ввода</A></H2>
<P>
<A NAME="IDX21"></A>
<A NAME="IDX22"></A>
<A NAME="IDX23"></A>
<A NAME="IDX24"></A>
<A NAME="IDX25"></A>
<A NAME="IDX26"></A>
<A NAME="IDX27"></A>


<P>
  GNU Emacs использует для ввода с клавиатуры расширение набора знаков
ASCII; он также воспринимает незнаковые события, включая функциональные
клавиши и действия с клавишами мыши.


<P>
  ASCII состоит из 128 знаковых кодов.  Некоторым из этих кодов
приписаны графические обозначения, такие как `а' и `='; остальные
являются управляющими знаками, например <KBD>Cоntrol-a</KBD> (также именуется
<KBD>С-а</KBD> для краткости).  <KBD>C-a</KBD> получил свое имя из-за того, что
вы набираете его, зажав клавишу <KBD>CTRL</KBD> и затем нажав <KBD>а</KBD>.


<P>
  У некоторых управляющих знаков ASCII есть специальные названия, и
большинство терминалов имеют специальные клавиши, с помощью которых их
можно набрать, например: <KBD>RET</KBD>, <KBD>TAB</KBD>, <KBD>DEL</KBD> и <KBD>ESC</KBD>.
Знак пробела обычно обозначается ниже как <KBD>SPC</KBD>, хотя строго говоря,
он является графическим знаком, чье изображение должно быть пустым.  На
некоторых клавиатурах есть клавиша "linefeed"; это другое название для
<KBD>C-j</KBD>.


<P>
  Emacs расширяет множество знаков ASCII тысячами других печатных знаков
(see section <A HREF="emacs_23.html#SEC198">Поддержка разных языков</A>), дополнительными управляющими знаками и несколькими
модификаторами, которые можно комбинировать с любым другим знаком.


<P>
  На ASCII-терминалах существует только 32 управляющих знака.  Это
варианты с модификатором control для букв и знаков <SAMP>`@[]\^_'</SAMP>.
Кроме того, клавиша shift не имеет смысла с управляющими знаками:
<KBD>C-a</KBD> и <KBD>C-A</KBD> -- это одно и то же, и Emacs не может их
различить.


<P>
  Но во множестве знаков Emacs есть место для вариантов с control для
всех печатных знаков и для различения между <KBD>C-a</KBD> и <KBD>C-A</KBD>.  X
Windows позволяет ввести все эти знаки.  Например, <KBD>C--</KBD> (то есть
Control-минус) и <KBD>C-5</KBD> -- допустимые команды Emacs в системе X.


<P>
  Еще одно расширение множества знаков Emacs -- это дополнительные биты
модификаторов.  Чаще всего используется только один бит-модификатор, он
называется Meta.  Для любого знака есть его Meta-вариант; примеры
включают <KBD>Meta-а</KBD> (для краткости <KBD>М-а</KBD>), <KBD>М-А</KBD> (это не то же
самое, что <KBD>М-а</KBD>, но эти два знака имеют обычно одно и то же
значение в Emacs), <KBD>M-<KBD>RET</KBD></KBD> и <KBD>M-C-a</KBD>.  По традиции мы
обычно пишем <KBD>С-М-а</KBD>, а не <KBD>М-С-а</KBD>; но логично говоря, порядок
набора клавиш <KBD>CTRL</KBD> и <KBD>META</KBD> не имеет значения.


<P>
<A NAME="IDX28"></A>
<A NAME="IDX29"></A>
<A NAME="IDX30"></A>
  Некоторые терминалы имеют клавишу <KBD>META</KBD> и позволяют набирать
Meta-знаки, нажав эту клавишу.  Таким образом, <KBD>Meta-а</KBD> набирается
путем одновременного нажатия клавиш <KBD>META</KBD> и <KBD>а</KBD>.  Клавиша
<KBD>META</KBD> работает очень похоже на <KBD>SHIFT</KBD>.  Подобные клавиши не
всегда метятся <KBD>META</KBD>, так как эти функции часто присваиваются
специальными клавишам с каким-то другим первоначальным значением.


<P>
  Если у вас нет клавиши <KBD>META</KBD>, вы все же можете набрать
Meta-знаки, используя последовательность двух знаков, начинающуюся с
<KBD>ESC</KBD>.  Таким образом, чтобы ввести <KBD>M-а</KBD>, вы можете набрать
<KBD><KBD>ESC</KBD> a</KBD>.  Чтобы ввести <KBD>С-М-а</KBD>, вы должны набрать
<KBD><KBD>ESC</KBD> C-a</KBD>.  <KBD>ESC</KBD> разрешена также и на терминалах с
клавишами <KBD>META</KBD>, на случай, если вы привыкли использовать ее.


<P>
  X Windows предоставляет несколько других клавиш-модификаторов, которые
могут быть применены к любому вводимому знаку.  Эти клавиши называются
<KBD>SUPER</KBD>, <KBD>HYPER</KBD> и <KBD>ALT</KBD>.  Мы пишем <SAMP>`s-'</SAMP>, <SAMP>`H-'</SAMP> и
<SAMP>`A-'</SAMP>, чтобы сказать, что знак использует эти модификаторы.  Таким
образом, <KBD>s-H-C-x</KBD> -- это сокращение для
<KBD>Super-Hyper-Control-x</KBD>.  Не все X-терминалы в действительности
предоставляют клавиши для этих модификаторов -- фактически многие
терминалы имеют клавишу, помеченную <KBD>ALT</KBD>, которая на самом деле
является клавишей <KBD>META</KBD>.  Стандартные привязки ключей Emacs не
содержат каких-либо знаков с этими модификаторами.  Но вы можете
придать им свои значения, настраивая Emacs.


<P>
  Ввод с клавиатуры включает клавиши, не являющие знаками: например
функциональные клавиши и курсорные стрелки.  Кнопки мыши также выпадают
из гаммы знаков.  Вы можете модифицировать эти события с помощью
клавиш-модификаторов <KBD>CTRL</KBD>, <KBD>META</KBD>, <KBD>SUPER</KBD>, <KBD>HYPER</KBD> и
<KBD>ALT</KBD> точно так же, как и знаки клавиатуры.


<P>
<A NAME="IDX31"></A>
  Вводимые знаки и незнаковый ввод вместе называются <EM>событиями</EM>.
@xref{Input Events,,, @external{elisp}, The Emacs Lisp Reference
Manual}, для дальнейшей информации.  Если вы не программируете на Лиспе,
а просто хотите переопределить значения некоторых знаков и незнаковых
событий, смотрите section <A HREF="emacs_36.html#SEC440">Настройка</A>.


<P>
  ASCII-терминалы в действительности не могут посылать ничего, кроме
знаков ASCII.  Такие терминалы используют для представления каждой
функциональной клавиши последовательность знаков.  Но это невидимо для
пользователя Emacs, потому что процедуры обработки ввода с клавиатуры
распознают эти особые последовательности и преобразуют их в события
функциональных клавиш до того, как любые другие части Emacs могут их
увидеть.




<H2><A NAME="SEC19" HREF="emacs_toc.html#TOC19">Ключи</A></H2>

<P>
<A NAME="IDX32"></A>
<A NAME="IDX33"></A>
  <EM>Последовательность ключей</EM>, (или коротко, <EM>ключ</EM>) есть
последовательность вводимых событий, которая воспринимается как целое,
как "единая команда".  Некоторые командные последовательности Emacs
--- это просто одиночный знак или одно событие; например, просто
<KBD>C-f</KBD> достаточно для перемещения вперед на один знак.  Но в Emacs
также есть команды, которые вызываются двумя или более событиями.


<P>
<A NAME="IDX34"></A>
<A NAME="IDX35"></A>
  Если последовательность событий достаточна для вызова команды, она
является <EM>законченным ключом</EM>.  Примером законченных ключей могут
быть <KBD>C-a</KBD>, <KBD>X</KBD>, <KBD>RET</KBD>, <KBD>NEXT</KBD> (функциональная клавиша),
<KBD>DOWN</KBD> (стрелка), <KBD>C-x C-f</KBD> и <KBD>C-x 4 C-f</KBD>.  Если
последовательность недостаточна, чтобы составить законченный ключ, она
называется <EM>префиксным ключом</EM>.  В примерах выше <KBD>C-x</KBD> и
<KBD>C-x 4</KBD> являются префиксными ключами.  Любая последовательность
ключей -- это либо законченный, либо префиксный ключ.


<P>
  Большинство одиночных знаков являются законченными ключами в
стандартных привязках команд Emacs.  Немногие из них являются
префиксными ключами.  Префиксный ключ объединяется со следующим событием
в более длинную последовательность ключей, которая сама может быть
законченной или префиксной.  Например, <KBD>C-x</KBD> -- это префиксный
ключ, поэтому <KBD>C-x</KBD> и следующее событие объединяются в
двухзнаковую последовательность ключей.  Большинство этих
последовательностей являются законченными ключами, в том числе <KBD>C-x
C-f</KBD> и <KBD>C-x b</KBD>.  Некоторые, например <KBD>C-x 4</KBD> и <KBD>C-x r</KBD>, сами
являются префиксными ключами, приводящими к трехзнаковым
последовательностям ключей.  Нет ограничения на длину последовательности
ключей, но на практике люди редко используют последовательности длиннее
четырех событий.


<P>
  Напротив, добавить события к законченному ключу вы не можете.
Например, двухзнаковая последовательность <KBD>C-f C-k</KBD> не является
ключом, так как <KBD>C-f</KBD> является законченным ключом сама по себе.
Невозможно дать <KBD>C-f C-k</KBD> независимое значение как команде.
<KBD>C-f C-k</KBD> -- это две команды, а не одна.


<P>
  Из всего сказанного следует, что префиксными ключами в Emacs являются
<KBD>C-c</KBD>, <KBD>C-h</KBD>, <KBD>C-x</KBD>, <KBD>C-x <KBD>RET</KBD></KBD>, <KBD>C-x @</KBD>,
<KBD>C-x a</KBD>, <KBD>C-x n</KBD>, <KBD>C-x r</KBD>, <KBD>C-x v</KBD>, <KBD>C-x 4</KBD>,
<KBD>C-x 5</KBD>, <KBD>C-x 6</KBD>, <KBD>ESC</KBD>, <KBD>M-g</KBD> и <KBD>M-j</KBD>.  Но этот
список не встроен; это просто стандартная привязка ключей в Emacs.  В
процессе настройки Emacs вы можете сделать новые префиксные ключи или
уничтожить эти.  See section <A HREF="emacs_36.html#SEC456">Настройка привязок ключей</A>.


<P>
  Если вы в самом деле создаете или удаляете префиксные ключи, это
изменяет набор возможных последовательностей ключей.  Например, если вы
переопределяете <KBD>C-f</KBD> как префикс, <KBD>C-f C-k</KBD> автоматически
становятся ключом (законченным, если вы не определите его тоже как
префикс).  Наоборот, если вы уничтожите определение префикса <KBD>C-x
4</KBD>, то <KBD>С-х 4 f</KBD> (или <KBD>С-х 4 <VAR>что-нибудь</VAR></KBD>) не будет в
дальнейшем ключом.


<P>
  Напечатав знак вызова справки (<KBD>C-h</KBD> или <KBD>F1</KBD>) после
префиксного знака, вы получите список команд, начинающихся с этого
префикса.  Есть несколько префиксных знаков, для которых <KBD>C-h</KBD> не
работает -- по историческим причинам у них есть другое значение для
<KBD>C-h</KBD>, которое непросто изменить.  Но <KBD>F1</KBD> должна работать для
всех префиксных знаков.




<H2><A NAME="SEC20" HREF="emacs_toc.html#TOC20">Ключи и команды</A></H2>

<P>
<A NAME="IDX36"></A>
<A NAME="IDX37"></A>
<A NAME="IDX38"></A>
<A NAME="IDX39"></A>
  В этом руководстве много отрывков, которые говорят вам, что делают
отдельные ключи.  Но Emacs не определяет значение ключей
непосредственно.  Вместо этого Emacs присваивает значение именованным
<EM>командам</EM> и затем придает ключам значения путем <EM>привязки</EM> их к
командам.


<P>
  Каждая команда имеет имя, выбранное для нее программистом.  Обычно это
имя составляется из нескольких английских слов, разделенных дефисами;
например, <CODE>next-line</CODE> или <CODE>forward-word</CODE>.  У команды также
есть <EM>определение</EM>, являющееся программой на Лиспе; она заставляет
функцию делать то, что она делает.  На самом деле, команда в языке Emacs
Lisp -- это особая разновидность лисповской функции; это такая функция,
которая указывает, как читать аргументы при интерактивном вызове.  Для
получения большей информации о командах и функциях смотрите @xref{What Is a Function,, What Is a Function, @external{elisp}, The Emacs Lisp
Reference Manual}.  (Определение, которое мы использовали в данном
руководстве, слегка упрощено.)


<P>
  Связь между ключами и функциями записывается в различных таблицах,
называемых <EM>таблицами ключей</EM>.  See section <A HREF="emacs_36.html#SEC457">Таблицы ключей</A>.


<P>
  Когда мы говорим, что "<KBD>C-n</KBD> сдвигает вертикально вниз на одну
строку", мы замалчиваем отличие, которое не относится к делу при
обычном использовании, но существенно для понимания того, как
настраивается Emacs.  Это команда <CODE>next-line</CODE>, которая
запрограммирована на сдвиг вниз.  Ключ <KBD>C-n</KBD> имеет такое действие,
<EM>так как</EM> он привязан к этой команде.  Если вы перепривяжете
<KBD>С-n</KBD> к команде <CODE>forward-word</CODE>, то он будет перемещать на одно
слово вперед.  Перепривязка клавиш -- обычный метод настройки.


<P>
  В остальной части этого руководства мы обычно будем игнорировать эту
тонкость, чтобы сохранить простоту.  Чтобы дать необходимую для
настройки информацию, мы ставим имя команды, которая в действительности
выполняет работу, в круглых скобках после ссылки на ключ, который ее
запускает.  Например, мы будем говорить: "Команда <KBD>С-n</KBD>
(<CODE>next-line</CODE>) передвигает точку вниз", имея в виду, что
<CODE>next-line</CODE> -- это команда, которая двигает вниз, а <KBD>С-n</KBD> ---
это ключ, который стандартно привязан к ней.


<P>
  Раз уж мы говорим сейчас только об информации для настройки, то это
подходящий момент, чтобы рассказать вам о <EM>переменных</EM>.  Часто
описание команд будет говорить: "Чтобы изменить это, установите
переменную <CODE>mumble-foo</CODE>".  Переменная -- это имя, используемое
для запоминания значения.  Многие описанные в этом руководстве
переменные существуют просто для облегчения настройки: некоторая команда
или другая часть Emacs проверяет переменную и ведет себя по-разному в
зависимости от ее значения.  Пока вы не интересуетесь настройкой, вы
можете пропустить информацию о переменных.  Когда вы будете готовы,
чтобы заинтересоваться, прочитайте базовые сведения о переменных, и
тогда информация об отдельных переменных будет иметь смысл.
See section <A HREF="emacs_36.html#SEC442">Переменные</A>.




<H2><A NAME="SEC21" HREF="emacs_toc.html#TOC21">Наборы знаков для текста</A></H2>
<P>
<A NAME="IDX40"></A>


<P>
  Текст в буферах Emacs -- это последовательность восьмибитных байт.
Каждый байт может содержать один знак ASCII.  Допустимы как управляющие
знаки ASCII (с восьмеричными кодами от 000 до 037, и 0177), так и
печатные ASCII-знаки (с кодами от 040 до 0176); однако, управляющие
знаки не из ASCII не могут появиться в буфере.  Другие
флаги-модификаторы, используемые при вводе с клавиатуры, такие как Meta,
также недопустимы в буферах.


<P>
  Некоторые управляющие знаки ASCII служат в тексте для особых целей и
имеют особые названия.  Например, знак новой строки (восьмеричный код
012) используется в буфере для завершения строки, а символ табуляции
(восьмеричный код 011) используется для создания отступа до следующей
позиции табуляции (обычно через каждые 8 столбцов).  See section <A HREF="emacs_16.html#SEC87">Как отображается текст</A>.


<P>
  Печатные знаки, не входящие в ASCII, также могут появляться в буферах.
Когда включены многобайтные знаки, вы можете использовать любые печатные
не-ASCII-знаки, которые Emacs поддерживает.  Они имеют коды,
начинающиеся от 256, или восьмеричного 0400, и каждый из них
представляется как последовательность двух или более байт.  See section <A HREF="emacs_23.html#SEC198">Поддержка разных языков</A>.


<P>
  Если вы выключите поддержку многобайтных знаков, то сможете
использовать только один алфавит не-ASCII-знаков, каждый из которых
вмещается в один байт.  Для них используются коды от 0200 до 0377.
See section <A HREF="emacs_23.html#SEC210">Поддержка однобайтных европейских знаков</A>.
<P><HR><P>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_6.html">previous</A>, <A HREF="emacs_8.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
</BODY>
</HTML>
