<HTML>
<HEAD>
<!-- Created by texi2html 1.56k from emacs.texi on 29 October 2002 -->

<TITLE>Руководство по GNU Emacs - Посылка почты</TITLE>
</HEAD>
<BODY>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_30.html">previous</A>, <A HREF="emacs_32.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
<P><HR><P>


<H1><A NAME="SEC339" HREF="emacs_toc.html#TOC339">Посылка почты</A></H1>
<P>
<A NAME="IDX1741"></A>
<A NAME="IDX1742"></A>
<A NAME="IDX1743"></A>


<DL COMPACT>

<DT><KBD>C-x m</KBD>
<DD>
Начать составление сообщения для пересылки (<CODE>compose-mail</CODE>).
<DT><KBD>C-x 4 m</KBD>
<DD>
Аналогично, но показать сообщение в другом окне
(<CODE>compose-mail-other-window</CODE>).
<DT><KBD>C-x 5 m</KBD>
<DD>
Аналогично, но создать новый фрейм (<CODE>compose-mail-other-frame</CODE>).
<DT><KBD>C-c C-s</KBD>
<DD>
В режиме Mail, посылает сообщение (<CODE>mail-send</CODE>).
<DT><KBD>C-c C-c</KBD>
<DD>
Посылает сообщение и прячет его буфер (<CODE>mail-send-and-exit</CODE>).
</DL>

<P>
<A NAME="IDX1744"></A>
<A NAME="IDX1745"></A>
<A NAME="IDX1746"></A>
<A NAME="IDX1747"></A>
<A NAME="IDX1748"></A>
<A NAME="IDX1749"></A>
  Команда <KBD>C-x m</KBD> (<CODE>compose-mail</CODE>) выбирает буфер с именем
<TT>`*mail*'</TT> и инициализирует его наброском исходящего сообщения.
<KBD>C-x 4 m</KBD> (<CODE>compose-mail-other-window</CODE>) выбирает буфер
<TT>`*mail*'</TT> в другом окне, оставляя предыдущий текущий буфер видимым.
<KBD>C-x 5 m</KBD> (<CODE>compose-mail-other-frame</CODE>) создает для буфера
<TT>`*mail*'</TT> новый фрейм.


<P>
  Поскольку буфер сообщения -- это обычный буфер Emacs, во время
составления письма вы можете переключаться в другие буферы и вернуться
обратно позднее (или вообще не возвращаться).  Если вы используете
команду <KBD>C-x m</KBD> снова, когда вы составляли другое сообщение, но еще
не послали его, от вас потребуют подтверждение, перед тем как удалить
старое сообщение.  Если вы ответите <KBD>n</KBD>, буфер <TT>`*mail*'</TT>
останется выбранным со своим старым содержимым, так что вы сможете
закончить прежнее сообщение и послать его.  <KBD>C-u C-x m</KBD> -- это
другой способ сделать то же самое.  Пересылка сообщения помечает буфер
<TT>`*mail*'</TT> как "немодифицированный", что устраняет необходимость
подтверждения при следующем использовании <KBD>C-x m</KBD>.


<P>
  Если вы составляете сообщение в буфере <TT>`*mail*'</TT> и хотите послать
еще одно сообщение до завершения первого, переименуйте буфер
<TT>`*mail*'</TT> с помощью <KBD>M-x rename-uniquely</KBD> (see section <A HREF="emacs_20.html#SEC165">Разнообразные операции над буфером</A>).  Затем вы можете использовать <KBD>C-x m</KBD> или ее варианты,
описанные выше, чтобы создать новый буфер <TT>`*mail*'</TT>.  Если вы
сделаете так, то сможете работать с каждым буфером с сообщением
независимо.




<H2><A NAME="SEC340" HREF="emacs_toc.html#TOC340">Формат буфера с почтовым сообщением</A></H2>

<P>
  Кроме <EM>текста</EM>, или <EM>тела</EM>, сообщение имеет <EM>поля
заголовка</EM>, которые говорят, кто послал его, когда, кому, зачем и так
далее.  Некоторые поля заголовка, такие как <SAMP>`Date'</SAMP> (дата) и
<SAMP>`Sender'</SAMP> (отправитель), создаются автоматически, когда вы посылаете
сообщение.  Другие же, например имена получателей, должны быть заданы
вами, чтобы сообщение было отослано правильно.


<P>
  Режим Mail предусматривает несколько команд, помогающих вам
отредактировать некоторые поля заголовка, и некоторые поля в этом буфере
иногда инициализируются автоматически.  Вы можете вставить или
отредактировать любые поля заголовка, используя обычные команды
редактирования.


<P>
  Строка в буфере, которая гласит



<PRE>
--text follows this line--
</PRE>

<P>
--- это специальный ограничитель, отделяющий заданные вами заголовки от
самого текста.  Все, что следует за этой строкой, -- это текст
сообщения, а заголовки предшествуют ей.  Сама разделяющая строка не
появляется в реальном посылаемом сообщении.  Используемый для
строки-ограничителя текст задается переменной
<CODE>mail-header-separator</CODE>.


<P>
  Здесь представлен пример того, как могут выглядеть заголовки и текст в
буфере сообщения.



<PRE>
To: gnu@gnu.org
CC: lungfish@spam.org, byob@spam.org
Subject: The Emacs Manual
--Text follows this line--
Please ignore this message.
</PRE>



<H2><A NAME="SEC341" HREF="emacs_toc.html#TOC341">Поля заголовка сообщения</A></H2>
<P>
<A NAME="IDX1750"></A>


<P>
  Каждое поле заголовка в буфере сообщения начинается с имени это поля,
оно пишется в начале строки и отделяется двоеточием.  Прописные и
строчные буквы в именах полей не различаются (и в почтовых адресах
тоже).  После двоеточия и необязательного пропуска пишется содержимое
этого поля.


<P>
  Вы можете использовать для полей заголовка любые имена, какие вам
нравятся, но обычно люди используют только стандартные имена с принятыми
значениями.  Ниже приведена таблица часто используемых в посылаемых
сообщениях полей.


<DL COMPACT>

<DT><SAMP>`To'</SAMP>
<DD>
Это поле содержит почтовые адреса, на которые посылается сообщение.
Если вы перечисляете более одного адреса, используйте для их разделения
запятые, а не пробелы.

<DT><SAMP>`Subject'</SAMP>
<DD>
Содержанием поля <SAMP>`Subject'</SAMP> должен быть фрагмент текста, который
указывает, о чем будет сообщение.  Смысл полей <SAMP>`Subject'</SAMP> в том, что
большинство программ чтения почты могут предоставлять обзорный перечень
сообщений, печатая только тему каждого сообщения, а не весь текст.

<DT><SAMP>`CC'</SAMP>
<DD>
Это поле, как и поле <SAMP>`To'</SAMP>, содержит дополнительные почтовые адреса,
по которым нужно отправить сообщение, но эти читатели не должны
рассматривать это сообщение как адресованное им.

<DT><SAMP>`BCC'</SAMP>
<DD>
Это поле содержит дополнительные почтовые адреса, по которым
отправляется сообщение, но они не должны появляться в заголовке
фактически посланного сообщения.  Посланные таким образом копии
называются <EM>слепыми копиями</EM>.

<A NAME="IDX1751"></A>
Чтобы вам посылалась слепая копия каждого исходящего сообщения,
установите переменную <CODE>mail-self-blind</CODE> равной <CODE>t</CODE>.

<DT><SAMP>`FCC'</SAMP>
<DD>
Это поле содержит имя файла, оно велит Emacs добавить после отправки
копию этого сообщения в заданный файл.  Если это файл в формате Rmail,
Emacs записывает сообщение в формате Rmail; в противном случае -- в
системном формате почтовых файлов.

<A NAME="IDX1752"></A>
Чтобы каждый раз, когда вы начинаете редактирование исходящего
сообщения, в поле <SAMP>`FCC'</SAMP> помещалось фиксированное имя файла,
установите переменную <CODE>mail-archive-file-name</CODE> равной имени этого
файла.  Если вы не удалите поле <SAMP>`FCC'</SAMP> перед посылкой, сообщение
будет записано в этот файл.

<DT><SAMP>`From'</SAMP>
<DD>
Используйте поле <SAMP>`From'</SAMP>, чтобы назвать себя, когда вы отправляете
почту, войдя в систему под чужим именем.  Содержимое поля <SAMP>`From'</SAMP>
должно быть правильным почтовым адресом, поскольку обычно ответы
направляются по этому адресу.  Если вы не задали поле <SAMP>`From'</SAMP> сами,
Emacs использует значение <CODE>user-mail-address</CODE> в качестве значения
по умолчанию.

<DT><SAMP>`Reply-to'</SAMP>
<DD>
Используйте это поле, чтобы направлять ответы по адресам, отличным от
вашего собственного.  Большинство программ чтения почты (включая Rmail)
автоматически посылают ответы по адресу <SAMP>`Reply-to'</SAMP>; он имеет
приоритет перед адресом <SAMP>`From'</SAMP>.  Добавляя в заголовок поле
<SAMP>`Reply-to'</SAMP>, вы можете избавиться от любых проблем, которые может
вызывать при ответе ваш адрес <SAMP>`From'</SAMP>.

<A NAME="IDX1753"></A>
<A NAME="IDX1754"></A>
Чтобы какой-то адрес для <SAMP>`Reply-to'</SAMP> помещался в каждое исходящее
сообщение, установите переменную <CODE>mail-default-reply-to</CODE> равной
этом адресу (в виде строки).  Тогда <CODE>mail</CODE> инициализирует сообщения
с заданным адресом <SAMP>`Reply-to'</SAMP>.  Вы можете удалить или изменить это
поле заголовка перед отправкой сообщения, если хотите.  Когда Emacs
начинает работу, <CODE>mail-default-reply-to</CODE> инициализируется по
переменной среды @env{REPLYTO}, если она установлена.

<DT><SAMP>`In-reply-to'</SAMP>
<DD>
Это поле содержит фрагмент текста, описывающий сообщение, на которое вы
отвечаете.  Некоторые почтовые системы могут использовать эту информацию
для соотношения связанных между собой фрагментов почты.  Обычно это поле
заполняется самим Rmail, когда вы отвечаете на сообщение из него, и вам
никогда не придется думать об этом (see section <A HREF="emacs_32.html#SEC350">Чтение почты с помощью Rmail</A>).

<DT><SAMP>`References'</SAMP>
<DD>
В этом поле перечисляются ID предыдущих сообщений, связанных с этим.
Rmail устанавливает это поле автоматически, когда вы отвечаете на
какое-то сообщение.
</DL>

<P>
  Поля заголовка <SAMP>`To'</SAMP>, <SAMP>`CC'</SAMP>, <SAMP>`BCC'</SAMP> и <SAMP>`FCC'</SAMP> могут
использоваться любое число раз, и каждое из этих полей может содержать
несколько адресов, разделенных запятыми.  Поля <SAMP>`To'</SAMP>, <SAMP>`CC'</SAMP> или
<SAMP>`BCC'</SAMP> могут также иметь строки продолжения: одна или несколько
строк, начинающиеся с пробельных знаков и следующие за строкой, на
которой начинается поле, рассматриваются как часть этого поля.  Вот
пример поля <SAMP>`To'</SAMP> со строкой продолжения:



<PRE>
To: foo@here.net, this@there.net,
  me@gnu.cambridge.mass.usa.earth.spiral3281
</PRE>

<P>
<A NAME="IDX1755"></A>
  При посылке сообщения, если вы не написали поле <SAMP>`From'</SAMP> сами,
Emacs сделает это за вас.  Формат этого поля управляется переменной
<CODE>mail-from-style</CODE>:


<DL COMPACT>

<DT><CODE>nil</CODE>
<DD>
Только почтовый адрес, как <SAMP>`king@grassland.com'</SAMP>.
<DT><CODE>parens</CODE>
<DD>
И почтовый адрес, и полное имя, как <SAMP>`king@grassland.com (Elvis
Parsley)'</SAMP>.
<DT><CODE>angles</CODE>
<DD>
То же, но как <SAMP>`Elvis Parsley &#60;king@grassland.com&#62;'</SAMP>.
<DT><CODE>system-default</CODE>
<DD>
Позволить системе самой вставить поле <SAMP>`From'</SAMP>.
</DL>



<H2><A NAME="SEC342" HREF="emacs_toc.html#TOC342">Почтовые псевдонимы</A></H2>
<P>
<A NAME="IDX1756"></A>
<A NAME="IDX1757"></A>
<A NAME="IDX1758"></A>


<P>
  Вы можете определить <EM>почтовые псевдонимы</EM> в файле с именем
<TT>`~/.mailrc'</TT>.  Это короткие мнемонические имена, обозначающие
почтовые адреса или группы адресов.  Подобно многим другим почтовым
программам, Emacs раскрывает псевдонимы, когда они появляются в полях
<SAMP>`To'</SAMP>, <SAMP>`From'</SAMP>, <SAMP>`CC'</SAMP>, <SAMP>`BCC'</SAMP> и <SAMP>`Reply-to'</SAMP> и в их
вариантах с <SAMP>`Resent-'</SAMP>.


<P>
  Чтобы определить псевдоним в <TT>`~/.mailrc'</TT>, напишите одну строку в
таком формате:



<PRE>
alias <VAR>короткий-адрес</VAR> <VAR>полные-адреса</VAR>
</PRE>

<P>
Здесь <VAR>полные-адреса</VAR> означает один или более почтовых адресов, в
которые раскрывается <VAR>короткий-адрес</VAR>.  Разделяйте адреса пробелами;
если адрес содержит пробел, заключайте весь адрес в двойные кавычки.


<P>
Например, чтобы сделать так, чтобы <CODE>maingnu</CODE> обозначало ваш
собственный местный адрес и <CODE>gnu@gnu.org</CODE>, поместите такую строку:



<PRE>
alias maingnu gnu@gnu.org local-gnu
</PRE>

<P>
  Emacs также распознает в файлах <SAMP>`.mailrc'</SAMP> команды включения.  Они
выглядят так:



<PRE>
source <VAR>имя-файла</VAR>
</PRE>

<P>
Файл <TT>`~/.mailrc'</TT> в основном используется другими программами для
чтения почты; он может содержать различные другие команды.  Emacs
игнорирует все, кроме определений псевдонимов и команд включения.


<P>
<A NAME="IDX1759"></A>
  Есть другой способ определить почтовый псевдоним, но только внутри
Emacs -- с помощью команды <CODE>define-mail-alias</CODE>.  Она запрашивает
псевдоним и затем полный адрес.  Вы можете использовать ее для
определения псевдонимов в вашем файле <TT>`.emacs'</TT>, следующим образом:



<PRE>
(define-mail-alias "maingnu" "gnu@gnu.org")
</PRE>

<P>
<A NAME="IDX1760"></A>
  <CODE>define-mail-alias</CODE> записывает псевдонимы, добавляя их к
переменной, называемой <CODE>mail-aliases</CODE>.  Если вы умеете обращаться
со списками в Лиспе, вы можете установить <CODE>mail-aliases</CODE> напрямую.
Первоначальное значение переменной <CODE>mail-aliases</CODE> равно <CODE>t</CODE>,
что означает, что для получения правильного значения Emacs должен
считать <TT>`.mailrc'</TT>.


<P>
<A NAME="IDX1761"></A>
  Вы можете задать вместо <TT>`~/.mailrc'</TT> файл с другим именем,
установив переменную <CODE>mail-personal-alias-file</CODE>.


<P>
<A NAME="IDX1762"></A>
  Обычно Emacs раскрывает псевдонимы, когда вы отсылаете сообщение.  Вам
не обязательно раскрывать псевдонимы до отсылки сообщения, но вы можете
раскрыть их, если хотите увидеть, куда пойдет это письмо.  Чтобы сделать
это, используйте команду <KBD>M-x expand-mail-aliases</KBD>; она раскрывает
все почтовые псевдонимы, присутствующие в данный момент в полях
заголовка с адресами.


<P>
  Если хотите, вы можете сделать так, чтобы почтовые псевдонимы
раскрывались как сокращения, по мере того как вы их набираете
(see section <A HREF="emacs_29.html#SEC326">Сокращения</A>).  Чтобы включить эту возможность, выполните
следующее:



<PRE>
(add-hook 'mail-setup-hook 'mail-abbrevs-setup)
</PRE>

<P>
<A NAME="IDX1763"></A>
<A NAME="IDX1764"></A>
Это можно написать в файле <TT>`.emacs'</TT>.  See section <A HREF="emacs_36.html#SEC449">Ловушки</A>.  Если вы
пользуетесь этим методом, вы должны использовать
<CODE>define-mail-abbrev</CODE>, а не <CODE>define-mail-alias</CODE>; последняя
команда не работает с этим пакетом.  Обратите внимание, пакет для
сокращений почтовых адресов использует переменную <CODE>mail-abbrevs</CODE>
вместо <CODE>mail-aliases</CODE>, и все псевдонимы преобразуются к нижнему
регистру.


<P>
<A NAME="IDX1765"></A>
<A NAME="IDX1766"></A>
  Пакет для сокращений почтовых адресов также предоставляет команду
<KBD>C-c C-a</KBD> (<CODE>mail-interactive-insert-alias</CODE>), которая считывает
псевдоним (с завершением) и вставляет его определение в точке.  Это
полезно при редактировании самого текста сообщения или поля вроде
<SAMP>`Subject'</SAMP>, где Emacs обычно не раскрывает псевдонимы.


<P>
  Заметьте, что сокращения раскрываются, только если вы после вставили
разделитель слов.  Однако, вы можете перепривязать <KBD>C-n</KBD> и <KBD>M-&#62;</KBD>
так, чтобы они еще и производили раскрытие.  Это можно сделать следующим
образом:



<PRE>
(add-hook 'mail-setup-hook
          '(lambda ()
             (substitute-key-definition
               'next-line 'mail-abbrev-next-line
               mail-mode-map global-map)
             (substitute-key-definition
               'end-of-buffer 'mail-abbrev-end-of-buffer
               mail-mode-map global-map)))
</PRE>



<H2><A NAME="SEC343" HREF="emacs_toc.html#TOC343">Режим Mail</A></H2>
<P>
<A NAME="IDX1767"></A>
<A NAME="IDX1768"></A>


<P>
  Основной режим, используемый в буфере сообщения -- это режим Mail,
который очень похож на режим Text за исключением того, что в нем
предоставляются различные специальные команды на префиксе <KBD>C-c</KBD>.
Все эти команды должны производить различные операции с редактируемым
или посылаемым сообщением.  Кроме того, режим Mail определяет знак
<SAMP>`%'</SAMP> как разделитель слов; это полезно при использовании команд,
работающих со словами, для редактирования почтовых адресов.


<P>
  Режим Mail обычно используется в буферах, автоматически подготовленных
командой <CODE>mail</CODE> или родственными командами.  Однако, вы можете
также переключиться в режим Mail в буфере, обращающемся к файлу.  Это
полезно делать, если вы сохранили в файле черновик сообщения.




<H3><A NAME="SEC344" HREF="emacs_toc.html#TOC344">Отправка почты</A></H3>

<P>
  В режиме Mail есть две команды для отправки сообщения, которое вы
редактировали:


<DL COMPACT>

<DT><KBD>C-c C-s</KBD>
<DD>
Послать это сообщение и оставить буфер с ним выбранным
(<CODE>mail-send</CODE>).
<DT><KBD>C-c C-c</KBD>
<DD>
Послать это сообщение и выбрать какой-то другой буфер
(<CODE>mail-send-and-exit</CODE>).
</DL>

<P>
<A NAME="IDX1769"></A>
<A NAME="IDX1770"></A>
<A NAME="IDX1771"></A>
<A NAME="IDX1772"></A>
  <KBD>C-c C-s</KBD> (<CODE>mail-send</CODE>) отсылает сообщение и помечает буфер с
этим сообщением как немодифицированный, но при этом оставляет этот буфер
выбранным, так что вы можете изменить это сообщение (возможно с новыми
получателями) и послать его снова.


<P>
<KBD>C-c C-c</KBD> (<CODE>mail-send-and-exit</CODE>) отсылает сообщение, а затем
удаляет окно или переключает в другой буфер.  Эта команда устанавливает
для буфера с сообщением самый низкий приоритет для повторного выбора,
так как вы перестали его использовать.  Это обычный способ отправки
сообщения.


<P>
  В буфере, который обращается к файлу, отправка сообщения не сбрасывает
флаг измененности, так как это должно делать только сохранение файла.  В
результате вы не получаете предупреждения, если пытаетесь отправить одно
сообщение два раза.


<P>
<A NAME="IDX1773"></A>
  Когда вы отправляете сообщение, которое содержит знаки, не входящие в
ASCII, эти знаки необходимо перевести в какую-то систему кодирования
(see section <A HREF="emacs_23.html#SEC205">Системы кодирования</A>).  Обычно она устанавливается вашей
языковой средой (see section <A HREF="emacs_23.html#SEC201">Языковые среды</A>).  Вы можете явно указать
систему кодирования для исходящей почты, устанавливая переменную
<CODE>sendmail-coding-system</CODE>.


<P>
  Если определяемая таким образом система кодирования не может
обработать знаки в каком-то сообщении, Emacs просит вас выбрать систему
кодирования самим, показывая список возможных вариантов.




<H3><A NAME="SEC345" HREF="emacs_toc.html#TOC345">Редактирование заголовка сообщения</A></H3>

<P>
  Режим Mail предоставляет специальные команды для передвижения к
определенным полям заголовка и для завершения адресов.


<DL COMPACT>

<DT><KBD>C-c C-f C-t</KBD>
<DD>
Перейти к полю заголовка <SAMP>`To'</SAMP>, создавая его, если его еще нет
(<CODE>mail-to</CODE>).
<DT><KBD>C-c C-f C-s</KBD>
<DD>
Перейти к полю заголовка <SAMP>`Subject'</SAMP>, создавая его, если его еще нет
(<CODE>mail-subject</CODE>).
<DT><KBD>C-c C-f C-c</KBD>
<DD>
Перейти к полю заголовка <SAMP>`CC'</SAMP>, создавая его, если его еще нет
(<CODE>mail-cc</CODE>).
<DT><KBD>C-c C-f C-b</KBD>
<DD>
Перейти к полю заголовка <SAMP>`BCC'</SAMP>, создавая его, если его еще нет
(<CODE>mail-bcc</CODE>).
<DT><KBD>C-c C-f C-f</KBD>
<DD>
Перейти к полю заголовка <SAMP>`FCC'</SAMP>, создавая его, если его еще нет
(<CODE>mail-fcc</CODE>).
<DT><KBD>M-<KBD>TAB</KBD></KBD>
<DD>
Завершить почтовый адрес (<CODE>mail-complete</CODE>).
</DL>

<P>
<A NAME="IDX1774"></A>
<A NAME="IDX1775"></A>
<A NAME="IDX1776"></A>
<A NAME="IDX1777"></A>
<A NAME="IDX1778"></A>
<A NAME="IDX1779"></A>
<A NAME="IDX1780"></A>
<A NAME="IDX1781"></A>
<A NAME="IDX1782"></A>
<A NAME="IDX1783"></A>
  Есть пять команд для перемещения точки к отдельным полям заголовка, и
все они базируются на префиксе <KBD>C-c C-f</KBD> (<SAMP>`C-f'</SAMP> означает
"field".@transnote{От англ. "поле".}  Они перечислены в таблице
выше.  Если требуемое поле не существует, эти команды создают его.  Мы
предоставляем специальные команды для перемещения именно к таким полям,
потому что чаще всего пользователи хотят редактировать именно их.


<P>
<A NAME="IDX1784"></A>
<A NAME="IDX1785"></A>
  При редактировании полей заголовка, которые содержат почтовые адреса,
таких как <SAMP>`To:'</SAMP>, <SAMP>`CC:'</SAMP> и <SAMP>`BCC:'</SAMP>, вы можете завершить
адрес, введя <KBD>M-<KBD>TAB</KBD></KBD> (<CODE>mail-complete</CODE>).  Эта команда
вставляет полное имя, соответствующее этому адресу, если она может его
определить.  Переменная <CODE>mail-complete-style</CODE> говорит, нужно ли
вставлять полное имя и какой стиль следует использовать; стиль задается
как в <CODE>mail-from-style</CODE> (see section <A HREF="emacs_31.html#SEC341">Поля заголовка сообщения</A>).


<P>
  При завершении правильными почтовыми адресами считаются имена
локальных пользователей и определенные вами почтовые псевдонимы.  Вы
можете задать дополнительные источники правильных адресов; используйте
буфер настройки, чтобы просмотреть возможные варианты.


<P>
  Если вы напечатаете <KBD>M-<KBD>TAB</KBD></KBD> в теле сообщения, она вызовет
<CODE>ispell-complete-word</CODE>, как в режиме Text.




<H3><A NAME="SEC346" HREF="emacs_toc.html#TOC346">Цитирование почты</A></H3>
<P>
<A NAME="IDX1786"></A>


<P>
  В режиме Mail также есть команды для восстановления или
<EM>цитирования</EM> всего или части сообщения, на которое вы отвечаете.
Эти команды активны, только когда вы начали отправку сообщения с
использованием команды Rmail.


<DL COMPACT>

<DT><KBD>C-c C-y</KBD>
<DD>
Восстановить выбранное сообщение из Rmail (<CODE>mail-yank-original</CODE>).
<DT><KBD>C-c C-r</KBD>
<DD>
Восстановить область из буфера Rmail (<CODE>mail-yank-region</CODE>).
<DT><KBD>C-c C-q</KBD>
<DD>
Заполнить все абзацы, процитированные из другого сообщения
(<CODE>mail-fill-yanked-message</CODE>).
</DL>

<P>
<A NAME="IDX1787"></A>
<A NAME="IDX1788"></A>
  Если отправка почты запускается из программы чтения почты Rmail с
использованием команды Rmail, то внутри буфера сообщения может
использоваться команда <KBD>C-c C-y</KBD> для вставки текста сообщения, на
которое вы отвечаете.  Обычно она сдвигает каждую строку этого сообщения
на три пробела и удаляет большинство полей заголовка.  Числовой аргумент
указывает количество пробелов для отступа.  Просто <KBD>C-u</KBD> говорит о
том, что делать отступ и удалять что-либо не надо.  <KBD>C-c C-y</KBD> всегда
использует текущее сообщение из буфера Rmail, так что можно вставить
несколько старых сообщений, выбирая нужное в Rmail, переключаясь в
<TT>`*mail*'</TT> и восстанавливая его, а затем снова переключаясь в Rmail,
чтобы выбрать еще одно.


<P>
<A NAME="IDX1789"></A>
  Вы можете задать текст, который команда <KBD>C-c C-y</KBD> будет вставлять
в начале каждой строки: установите <CODE>mail-yank-prefix</CODE> равной
желаемой строке.  (Значение <CODE>nil</CODE> означает, что следует делать
отступ; это используется по умолчанию.)  Однако, <KBD>C-u C-c C-y</KBD>
никогда не добавляет ничего в начало вставляемых строк, несмотря на
значение <CODE>mail-yank-prefix</CODE>.


<P>
<A NAME="IDX1790"></A>
<A NAME="IDX1791"></A>
  Чтобы вставить только часть пришедшего сообщения, установите в Rmail
область вокруг нужного фрагмента; затем перейдите в буфер <TT>`*mail*'</TT>
и напечатайте <KBD>C-c C-r</KBD> (<CODE>mail-yank-region</CODE>).  В каждой
копируемой строке делается отступ или добавляется префикс в соответствии
с <CODE>mail-yank-prefix</CODE>.


<P>
<A NAME="IDX1792"></A>
<A NAME="IDX1793"></A>
  После использования <KBD>C-c C-y</KBD> или <KBD>C-c C-r</KBD> вы можете набрать
<KBD>C-c C-q</KBD>, чтобы заполнить абзацы восстановленного старого сообщения
или сообщений.  Однократным использованием <KBD>C-c C-q</KBD> заполняются все
такие абзацы, причем каждый отдельно.  Чтобы заполнить один абзац
процитированного сообщения, используйте <KBD>M-q</KBD>.  Если заполнение не
обрабатывает используемый вами стиль префикса для цитат автоматически,
попробуйте установить префикс заполнения явно.  See section <A HREF="emacs_26.html#SEC222">Заполнение текста</A>.




<H3><A NAME="SEC347" HREF="emacs_toc.html#TOC347">Другие возможности режима Mail</A></H3>

<DL COMPACT>

<DT><KBD>C-c C-t</KBD>
<DD>
Перемещает к началу текста тела сообщения (<CODE>mail-text</CODE>).
<DT><KBD>C-c C-w</KBD>
<DD>
Вставляет файл <TT>`~/.signature'</TT> в конец текста сообщения
(<CODE>mail-signature</CODE>).
<DT><KBD>C-c C-i <VAR>файл</VAR> <KBD>RET</KBD></KBD>
<DD>
Вставляет содержимое <VAR>файла</VAR> в конец исходящего сообщения
(<CODE>mail-attach-file</CODE>).
<DT><KBD>M-x ispell-message</KBD>
<DD>
Производит проверку правописания в тексте сообщения, но не в цитатах из
других сообщений.
</DL>

<P>
<A NAME="IDX1794"></A>
<A NAME="IDX1795"></A>
  <KBD>C-c C-t</KBD> (<CODE>mail-text</CODE>) перемещает точку к позиции сразу
после строки-разделителя заголовка, то есть к началу текста тела
сообщения.


<P>
<A NAME="IDX1796"></A>
<A NAME="IDX1797"></A>
<A NAME="IDX1798"></A>
  <KBD>C-c C-w</KBD> (<CODE>mail-signature</CODE>) добавляет в конец сообщения
стандартный кусок текста, где вы можете подробнее рассказать с себе.
Этот текст берется из файла <TT>`~/.signature'</TT> в вашем начальном
каталоге.  Чтобы подпись вставлялась автоматически, установите
переменную <CODE>mail-signature</CODE> в значение <CODE>t</CODE>; тогда при создании
почтового сообщения содержимое вашего файла <TT>`~/.signature'</TT> будет
вставляться автоматически.  Если вы не хотите ставить подпись в
конкретном сообщении, удалите ее из буфера перед отсылкой.


<P>
  Вы также можете установить <CODE>mail-signature</CODE> равной строке; тогда
эта строка автоматически вставляется в качестве вашей подписи, когда вы
начинаете редактировать сообщение.  Если вы установите ее равной
какому-то другому лисповскому выражению, это выражение всякий раз
вычисляется, а его значение (которое должно быть строкой) определяет
подпись.


<P>
<A NAME="IDX1799"></A>
  Вы можете проверить орфографию в тексте написанного сообщения с
помощью команды <KBD>M-x ispell-message</KBD>.  Если вы восстанавливали
пришедшие сообщения в набросок отправляемого, эта команда пропускает
восстановленные места, но проверяет текст, который вставили вы сами.
(Она просматривает величину отступа или значение переменной
<CODE>mail-yank-prefix</CODE>, чтобы отличить процитированные строки от
введенных вами.)  See section <A HREF="emacs_18.html#SEC107">Поиск и исправление орфографических ошибок</A>.


<P>
<A NAME="IDX1800"></A>
<A NAME="IDX1801"></A>
  Чтобы включить в отправляемое сообщение файл, вы можете использовать
<KBD>C-x i</KBD>, обычную команду для вставки файла в текущий буфер.  Но чаще
удобнее использовать особую команду, <KBD>C-c C-i</KBD>
(<CODE>mail-attach-file</CODE>).  Эта команда вставляет содержимое заданного
файла в конец буфера после подписи, если она есть, с разделяющей
строкой, включающей имя этого файла.


<P>
<A NAME="IDX1802"></A>
<A NAME="IDX1803"></A>
  Включение режима Mail (что <KBD>C-x m</KBD> делает автоматически) запускает
обычные ловушки <CODE>text-mode-hook</CODE> и <CODE>mail-mode-hook</CODE>.
Инициализация нового исходящего сообщения запускает обычную ловушку
<CODE>mail-setup-hook</CODE>; используйте эту ловушку, если вы хотите добавить
к вашему почтовому заголовку особые поля или сделать другие изменения в
представлении буфера сообщения.  See section <A HREF="emacs_36.html#SEC449">Ловушки</A>.


<P>
  Основное различие между этими ловушками состоит только в том, в какое
время они вызываются.  Когда вы набираете <KBD>M-x mail</KBD>, запускается
<CODE>mail-mode-hook</CODE>, как только будет создан буфер <TT>`*mail*'</TT>.
Затем функция <CODE>mail-setup</CODE> помещает в этот буфер его начальное
содержимое по умолчанию.  После этого запускается
<CODE>mail-setup-hook</CODE>.




<H2><A NAME="SEC348" HREF="emacs_toc.html#TOC348">Как сбить с толку NSA</A></H2>

<P>
<A NAME="IDX1804"></A>
<A NAME="IDX1805"></A>
<A NAME="IDX1806"></A>
  <KBD>M-x spook</KBD> добавляет в отправляемое сообщение строку случайно
выбранных ключевых слов.  Эти ключевые слова выбираются из списка слов,
которые предполагают, что вы обсуждаете что-то .


<P>
  За этой возможностью стоит идея, что NSA@transnote{National Security
Agency, американский аналог ФСБ с ее СОРМ2.} просматривает электронную
почту, содержащую ключевые слова, которые они могут найти интересными.
(NSA говорит, что они этого не делают, но они <EM>должны</EM> так
говорить.)  Идея состоит в том, что если многие люди добавляют к своим
сообщениям подозрительные слова, NSA будет настолько занято подделками,
что вынуждено будет совсем прекратить просмотр.


<P>
  Вот как автоматически вставлять зловещие ключевые слова, когда вы
начинаете набирать сообщение:



<PRE>
(add-hook 'mail-setup-hook 'spook)
</PRE>

<P>
  Смущает это NSA или нет, по крайней мере это развлекает людей.




<H2><A NAME="SEC349" HREF="emacs_toc.html#TOC349">Способы составления сообщений</A></H2>
<P>
<A NAME="IDX1807"></A>
<A NAME="IDX1808"></A>


<P>
  Эта глава описывает обычный режим Emacs для редактирования и отправки
почты -- режим Mail.  В Emacs есть иные способы для этого, включая
режимы MH-E и Message, не описанные в этом руководстве.  Вы можете
выбрать любой из них в качестве своего предпочтительного способа.
Команды <CODE>C-x m</CODE>, <CODE>C-x 4 m</CODE> и <CODE>C-x 5 m</CODE> используют тот
агент, который вы задали.  Так же делают и другие команды и программы
Emacs, посылающие почту.


<P>
<A NAME="IDX1809"></A>
  Чтобы указать ваш способ составления сообщений, установите переменную
<CODE>mail-user-agent</CODE>.  На данный момент допустимые значения включают
<CODE>sendmail-user-agent</CODE>, <CODE>mh-e-user-agent</CODE> и
<CODE>message-user-agent</CODE>.


<P>
  Если вы выбрали другой способ составления сообщений, информация о
буфере <TT>`*mail*'</TT> и режиме Mail из этой главы не относится к вашему
случаю; другие методы могут использовать совершенно иные команды с иным
форматом в иначе называемом буфере.
<P><HR><P>
Go to the <A HREF="emacs_1.html">first</A>, <A HREF="emacs_30.html">previous</A>, <A HREF="emacs_32.html">next</A>, <A HREF="emacs_46.html">last</A> section, <A HREF="emacs_toc.html">table of contents</A>.
</BODY>
</HTML>
