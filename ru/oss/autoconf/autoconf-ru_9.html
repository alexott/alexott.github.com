<HTML>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- Created on February, 19  2004 by texi2html 1.64 -->
<!-- 
Written by: Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Olaf Bachmann <obachman@mathematik.uni-kl.de>
Send bugs and suggestions to <texi2html@mathematik.uni-kl.de>
 
-->
<HEAD>
<TITLE>Autoconf: Локальная конфигурация</TITLE>

<META NAME="description" CONTENT="Autoconf: Локальная конфигурация">
<META NAME="keywords" CONTENT="Autoconf: Локальная конфигурация">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">
<META NAME="Generator" CONTENT="texi2html 1.64">

</HEAD>

<BODY LANG="" BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#0000FF" VLINK="#800080" ALINK="#FF0000">

<A NAME="SEC72"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_8.html#SEC71"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC73"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_8.html#SEC67"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_10.html#SEC81"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H1> 9. Локальная конфигурация </H1>
<!--docid::SEC72::-->
<A NAME="Site Configuration"></A>
<P>

Скрипты <CODE>configure</CODE> поддерживают несколько видов решений
локальной конфигурации.  Пользователь может указать,
где находятся внешние пакеты программного
обеспечения, включить или отключить дополнительные возможности,
установить программы, изменяя их имена, и установить значения по
умолчанию для ключей <CODE>configure</CODE>.
</P><P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="autoconf-ru_9.html#SEC73">9.1 Работа с внешним программным обеспечением</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="autoconf-ru_9.html#SEC74">9.2 Выбор ключей пакетов</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="autoconf-ru_9.html#SEC75">9.3 Детали локальной конфигурации</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="autoconf-ru_9.html#SEC76">9.4 Преобразование имен программ при установке</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="autoconf-ru_9.html#SEC80">9.5 Установка значений по умолчанию для машины</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Задание значений по умолчанию для <CODE>configure</CODE></TD></TR>
</TABLE></BLOCKQUOTE>
<P>

<A NAME="Внешнее ПО"></A>
<HR SIZE="6">
<A NAME="SEC73"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC74"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_10.html#SEC81"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 9.1 Работа с внешним программным обеспечением </H2>
<!--docid::SEC73::-->
<A NAME="External Software"></A>
<P>

Некоторые пакеты требуют, или могут при случае использовать другие
пакеты программного обеспечения, уже установленные в
системе.  Пользователь может указать скрипту <CODE>configure</CODE> с помощью ключей
командной строки, какие внешние пакеты надо
использовать. Ключи имеют одну из следующих форм:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>--with-<VAR>package</VAR>[=<VAR>arg</VAR>]
--without-<VAR>package</VAR>
</pre></td></tr></table></P><P>

Например, <SAMP>`--with-gnu-ld'</SAMP> означает, что надо работать с
компоновщиком GNU linker вместо других компоновщиков. <SAMP>`--with-x'</SAMP>
означает работу с X Window System.
</P><P>

Пользователь может задать аргумент, поставив после имени пакета символ
<SAMP>`='</SAMP> и нужный аргумент.  Вы можете задать аргумент, равный
<SAMP>`no'</SAMP>, для пакетов, использующихся по умолчанию; он сообщает о том,
что этот пакет <EM>не</EM> надо использовать. Аргумент, не равный ни
<SAMP>`yes'</SAMP>, ни <SAMP>`no'</SAMP>, может включать имя или номер версии другого
пакета для более точного указания, с каким пакетом эта программа
предполагает работать. Если аргумент не задан, то его значение по
умолчанию равно <SAMP>`yes'</SAMP>. <SAMP>`--without-<VAR>package</VAR>'</SAMP> эквивалентно
вызову <SAMP>`--with-<VAR>package</VAR>=no'</SAMP>.
</P><P>

Скрипты <CODE>configure</CODE> не выдают ошибок о ключах
<SAMP>`--with-<VAR>package</VAR>'</SAMP>, которые они не поддерживают. Такое
поведение позволяет конфигурировать дерево исходных текстов, содержащее
множество пакетов, с помощью скрипта <CODE>configure</CODE> верхнего уровня,
когда пакеты поддерживают разные ключи, без выдачи фальшивых сообщений
об ошибках в ключах, которые поддерживают лишь некоторые пакеты.  К
сожалению, побочным эффектом этого является то, что ошибка в задании
ключей не диагностируется.  До сих пор не был найден подход к решению
этой проблемы.
</P><P>

Для каждого из внешних пакетов, который может быть использован в файле
<TT>`configure.in'</TT>, должен быть вызван макрос <CODE>AC_ARG_WITH</CODE>, чтобы
определить, заставил ли пользователь <CODE>configure</CODE> использовать этот
пакет. Будет ли пакет использоваться по умолчанию или нет, а также какие
аргументы будут правильны, зависит от вас.
</P><P>

<A NAME="IDX484"></A>
<DL>
<DT><U>Macro:</U> <B>AC_ARG_WITH</B> <I>(<VAR>package</VAR>, <VAR>help-string</VAR> [, <VAR>action-if-given</VAR> [, <VAR>action-if-not-given</VAR>]])</I>
<DD><A NAME="IDX485"></A>
</P><P>

Если пользователь задал <CODE>configure</CODE> ключ
<SAMP>`--with-<VAR>package</VAR>'</SAMP> или ключ <SAMP>`--without-<VAR>package</VAR>'</SAMP>, то
выполняются команды командного процессора <VAR>action-if-given</VAR>. Если ни
один из ключей не задан, то выполняются команды
<VAR>action-if-not-given</VAR>. Имя <VAR>package</VAR> задает другой пакет, с
которым должна работать эта программа.  Это имя должно содержать только
буквы, цифры и знак "минус".
</P><P>

Аргумент ключа командной строки из кода командного процессора
<VAR>action-if-given</VAR> в переменной командного процессора <CODE>withval</CODE>,
который в действительности является значением переменной командного
процессора <CODE>with_<VAR>package</VAR></CODE>, с символами <SAMP>`-'</SAMP>, замененными
на символ <SAMP>`_'</SAMP>.  Можете использовать эту переменную, если хотите.
</P><P>

Аргумент <VAR>help-string</VAR> является описанием ключа, выглядящем примерно
так:
<TABLE><tr><td>&nbsp;</td><td class=example><pre>  --with-readline         support fancy command line editing
</pre></td></tr></table><VAR>help-string</VAR> может занимать больше одной строки, если
необходима подробная информация. Просто убедитесь, что строка разделена
на колонки в выводе <SAMP>`configure --help'</SAMP>. Избегайте использовать
символы табуляции в строке помощи.  Для того, чтобы сохранить начальные
пробелы, нужно поместить строку между символами <SAMP>`['</SAMP> и <SAMP>`]'</SAMP>.
</DL>
</P><P>

<A NAME="IDX486"></A>
<DL>
<DT><U>Macro:</U> <B>AC_WITH</B> <I>(<VAR>package</VAR>, <VAR>action-if-given</VAR> [, <VAR>action-if-not-given</VAR>])</I>
<DD><A NAME="IDX487"></A>
Это устаревшая версия макроса <CODE>AC_ARG_WITH</CODE>, которая не
поддерживает использование строки помощи.
</DL>
</P><P>

<A NAME="Ключи пакетов"></A>
<HR SIZE="6">
<A NAME="SEC74"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC73"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC75"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_10.html#SEC81"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 9.2 Выбор ключей пакетов </H2>
<!--docid::SEC74::-->
<A NAME="Package Options"></A>
<P>

Если пакет имеет необязательные возможности, задающиеся во время
компиляции, то пользователь может задать <CODE>configure</CODE> ключи
командной строки для указания--- нужно ли их компилировать. Ключи
имеют одну из следующих форм:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>--enable-<VAR>feature</VAR>[=<VAR>arg</VAR>]
--disable-<VAR>feature</VAR>
</pre></td></tr></table></P><P>

Эти ключи позволяют выбрать, какие необязательные возможности нужно
собрать и установить.  Ключи <SAMP>`--enable-<VAR>feature</VAR>'</SAMP> никогда не
должны приводить к тому, что какое-то свойство изменит свое поведение,
или же заменять одну возможность другой.  Эти ключи должны только
включать или не включать части программы в процесс компиляции.
</P><P>

Пользователь может задать аргумент, следующий за именем свойства и
знаком <SAMP>`='</SAMP>.  Если задать аргумент <SAMP>`no'</SAMP>, то свойство будет
недоступным.  Свойство с аргументом может выглядеть примерно следующим
образом: <SAMP>`--enable-debug=stabs'</SAMP>.  Если аргумент не задан, то
значением по умолчанию является <SAMP>`yes'</SAMP>.
<SAMP>`--disable-<VAR>feature</VAR>'</SAMP> является эквивалентом
<SAMP>`--enable-<VAR>feature</VAR>=no'</SAMP>.
</P><P>

Скрипты <CODE>configure</CODE> не выражают недовольства по поводу ключей
<SAMP>`--enable-<VAR>feature</VAR>'</SAMP>, которые они не поддерживают. Такое
поведение позволяет конфигурировать дерево исходных текстов, содержащее
множество пакетов, с помощью скрипта <CODE>configure</CODE> верхнего уровня,
когда пакеты поддерживают разные ключи, без выдачи фальшивых сообщений
об ошибках о ключах, которые поддерживают только некоторые пакеты.
Побочным эффектом этого является то, что ошибка в задании ключей не
диагностируется.  До сих пор не был найден подход к решению этой
проблемы.
</P><P>

Для каждой из необязательных возможностей <TT>`configure.in'</TT> должен
вызывать <CODE>AC_ARG_ENABLE</CODE> для определения, запросил ли пользователь
<CODE>configure</CODE> включение этой возможности.  Будет ли эта возможность
включена по умолчанию или нет, и какие аргументы будут правильными,
зависит от вас.
</P><P>

<A NAME="IDX488"></A>
<DL>
<DT><U>Macro:</U> <B>AC_ARG_ENABLE</B> <I>(<VAR>feature</VAR>, <VAR>help-string</VAR> [, <VAR>action-if-given</VAR> [, <VAR>action-if-not-given</VAR>]])</I>
<DD><A NAME="IDX489"></A>
Если пользователь задал <CODE>configure</CODE> ключ
<SAMP>`--enable-<VAR>feature</VAR>'</SAMP> или <SAMP>`--disable-<VAR>feature</VAR>'</SAMP>, то
запускаются команды <VAR>action-if-given</VAR>. Если не был задан ни один
ключ, то запускаются команды <VAR>action-if-not-given</VAR>.  Имя
<VAR>feature</VAR> указывает необязательную возможность, которую пользователь
может включить или выключить.  Имя должно состоять только из букв, цифр
и знака "минус".
</P><P>

Аргумент ключа доступен из кода командного процессора
<VAR>action-if-given</VAR> в переменную командного процессора
<CODE>enableval</CODE>, которая в действительности является значением
переменной <CODE>enable_<VAR>feature</VAR></CODE>, причем символы <SAMP>`-'</SAMP> заменены
на символ <SAMP>`_'</SAMP>.  Если хотите, то можете использовать эту переменную.
Аргумент <VAR>help-string</VAR> делает то же самое, что и соответствующий
аргумент макроса <CODE>AC_ARG_WITH</CODE> (see section <A HREF="autoconf-ru_9.html#SEC73">9.1 Работа с внешним программным обеспечением</A>).
</DL>
</P><P>

<A NAME="IDX490"></A>
<DL>
<DT><U>Macro:</U> <B>AC_ENABLE</B> <I>(<VAR>feature</VAR>, <VAR>action-if-given</VAR> [, <VAR>action-if-not-given</VAR>])</I>
<DD><A NAME="IDX491"></A>
Это устаревшая версия <CODE>AC_ARG_ENABLE</CODE>, которая не поддерживает 
использование строки помощи.
</DL>
</P><P>

<A NAME="Детали локальной конфигурации"></A>
<HR SIZE="6">
<A NAME="SEC75"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC74"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC76"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_10.html#SEC81"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 9.3 Детали локальной конфигурации </H2>
<!--docid::SEC75::-->
<A NAME="Site Details"></A>
<P>

Некоторые пакеты программ требуют сложной специфической для машины
информации.  Например, это имена машин, предоставляющих какие-либо
сервисы, имена компаний, а также электронные почтовые адреса, по которым
можно связаться с необходимыми людьми. Поскольку некоторые скрипты,
созданные Metaconfig, запрашивают эту информацию интерактивно, то люди
часто спрашивают, как можно получить эту информацию в Autoconf-скриптах,
которые не являются интерактивными.
</P><P>

Такая информация по конфигурации машины должна быть помещена в файл,
редактируемый <EM>только людьми</EM>, а не программами. Файл может
располагаться либо в зависимости от значения используемой переменной
<CODE>prefix</CODE>, либо находиться в стандартном месте, например, в домашнем
каталоге пользователя.  Он даже может быть указан в переменной
среды. Программа должна использовать этот файл во время выполнения, а не
во время компиляции. Настройка во время выполнения является более
удобной для пользователей и делает процесс настройки более простым, чем
получение информации во время процесса конфигурации.  See section `Variables for Installation Directories' in <CITE>GNU Coding Standards</CITE>, в которых описано, где именно необходимо размещать
файлы данных.
</P><P>

<A NAME="Преобразование имен"></A>
<HR SIZE="6">
<A NAME="SEC76"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC75"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC77"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC80"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 9.4 Преобразование имен программ при установке </H2>
<!--docid::SEC76::-->
<A NAME="Transforming Names"></A>
<P>

<BLOCKQUOTE><TABLE BORDER=0 CELLSPACING=0> 
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="autoconf-ru_9.html#SEC77">9.4.1 Ключи преобразования</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP">Ключи <CODE>configure</CODE> для преобразования имен.</TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="autoconf-ru_9.html#SEC78">9.4.2 Примеры преобразований</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"></TD></TR>
<TR><TD ALIGN="left" VALIGN="TOP"><A HREF="autoconf-ru_9.html#SEC79">9.4.3 Правила преобразования</A></TD><TD>&nbsp;&nbsp;</TD><TD ALIGN="left" VALIGN="TOP"><TT>`Makefile'</TT> использующий преобразование имен.</TD></TR>
</TABLE></BLOCKQUOTE>
<P>

Autoconf поддерживает изменение имен программ при их установке. Для
того, чтобы использовать это преобразование, в файле <TT>`configure.in'</TT>
должен быть вызов макроса <CODE>AC_ARG_PROGRAM</CODE>.
</P><P>

<A NAME="IDX492"></A>
<DL>
<DT><U>Macro:</U> <B>AC_ARG_PROGRAM</B>
<DD><A NAME="IDX493"></A>
<A NAME="IDX494"></A>
Помещает в выходную переменную <CODE>program_transform_name</CODE>
последовательность команд <CODE>sed</CODE>, используемых для изменения имен
устанавливаемых программ.
</P><P>

Если при запуске <CODE>configure</CODE> задан любой из нижеописанных ключей,
то имена программ изменяются соответствующим образом. В противном
случае, если был вызван макрос <CODE>AC_CANONICAL_SYSTEM</CODE> и значение,
заданное с помощью ключа <SAMP>`--target'</SAMP> отличается от типа машины,
(указанного с помощью ключа <SAMP>`--host'</SAMP> или типа по умолчанию,
определенного с помощью <CODE>config.sub</CODE>), то в качестве префикса имени
используется тип целевой машины и дефис.  Если не задано ни того, ни
другого, то преобразование имен не выполняется.
</DL>
</P><P>

<A NAME="Ключи преобразования"></A>
<HR SIZE="6">
<A NAME="SEC77"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC76"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC78"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC75"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC76"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC80"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 9.4.1 Ключи преобразования </H3>
<!--docid::SEC77::-->
<A NAME="Transformation Options"></A>
<P>

Вы можете задать преобразование имен, запустив <CODE>configure</CODE> со
следующими ключами командной строки:
</P><P>

<DL COMPACT>
<DT><CODE>--program-prefix=<VAR>prefix</VAR></CODE>
<DD>добавляет префикс <VAR>prefix</VAR> к именам;
<P>

<DT><CODE>--program-suffix=<VAR>suffix</VAR></CODE>
<DD>добавляет к именам суффикс <VAR>suffix</VAR>;
<P>

<DT><CODE>--program-transform-name=<VAR>expression</VAR></CODE>
<DD>выполняет подстановки <CODE>sed</CODE> <VAR>expression</VAR> для имен программ.
</DL>
<P>

<A NAME="Примеры преобразований"></A>
<HR SIZE="6">
<A NAME="SEC78"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC77"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC79"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC75"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC76"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC80"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 9.4.2 Примеры преобразований </H3>
<!--docid::SEC78::-->
<A NAME="Transformation Examples"></A>
<P>

Эти преобразования полезны при работе с программами, которые являются
частью кросс-компиляционной среды разработки. Например, кросс-ассемблер,
запускаемый на Sun 4 и настроенный с ключом <SAMP>`--target=i960-vxworks'</SAMP>,
обычно устанавливается как <TT>`i960-vxworks-as'</TT>, а не как <TT>`as'</TT>,
иначе его можно перепутать с родным ассемблером Sun 4.
</P><P>

Можно сделать так, чтобы имена программ начинались с символа <SAMP>`g'</SAMP>,
если не хотите, чтобы программы GNU, установленные в системе, заслоняли
собой другие утилиты с тем же именем. Например, если вы настраиваете
программу GNU <CODE>diff</CODE> с ключом <SAMP>`--program-prefix=g'</SAMP>, то затем
можете запустить <SAMP>`make install'</SAMP> и программа будет установлена
как <TT>`/usr/local/bin/gdiff'</TT>.
</P><P>

В качестве более изощренного примера можете использовать
<TABLE><tr><td>&nbsp;</td><td class=example><pre>--program-transform-name='s/^/g/; s/^gg/g/; s/^gless/less/'
</pre></td></tr></table>для добавления символа <SAMP>`g'</SAMP> к большинству имен программ в дереве
исходных текстов, за исключением программ типа <CODE>gdb</CODE>, чьи имена уже 
начинаются с этого символа, и за исключением <CODE>less</CODE> и <CODE>lesskey</CODE>,
которые не являются программами GNU. (Предполагается, что дерево
исходных текстов, содержащее эти программы, уже сконфигурировано для
использования этой возможности).
</P><P>

Одним из способов одновременной установки нескольких версий некоторых
программ является добавление номера версии программы к имени. Например,
если вы хотите сохранить для дальнейшего использования Autoconf версии
1, то вы можете настроить Autoconf версии 2 с помощью ключа
<SAMP>`--program-suffix=2'</SAMP> для того, чтобы программы были установлены под
именами <TT>`/usr/local/bin/autoconf2'</TT>,
<TT>`/usr/local/bin/autoheader2'</TT> и т. п.
</P><P>

<A NAME="Правила преобразования"></A>
<HR SIZE="6">
<A NAME="SEC79"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC78"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC80"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC75"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC76"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC80"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H3> 9.4.3 Правила преобразования </H3>
<!--docid::SEC79::-->
<A NAME="Transformation Rules"></A>
<P>

Вот как нужно использовать переменную  <CODE>program_transform_name</CODE> в
<TT>`Makefile.in'</TT>:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>transform=@program_transform_name@
install: all
        $(INSTALL_PROGRAM) myprog $(bindir)/`echo myprog|sed '$(transform)'`

uninstall:
        rm -f $(bindir)/`echo myprog|sed '$(transform)'`
</pre></td></tr></table></P><P>

Если у вас устанавливается больше одной программы, то вы можете
выполнять ту же операцию в цикле:
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre>PROGRAMS=cp ls rm
install:
        for p in $(PROGRAMS); do \
          $(INSTALL_PROGRAM) $$p $(bindir)/`echo $$p|sed '$(transform)'`; \
        done

uninstall:
        for p in $(PROGRAMS); do \
          rm -f $(bindir)/`echo $$p|sed '$(transform)'`; \
        done
</pre></td></tr></table></P><P>

Преобразовывать ли имена файлов документации (Texinfo или <CODE>man</CODE>) --
сложный вопрос.  Кажется, на него нет единственного ответа, потому что
для преобразования имен есть несколько причин.  Часто документация не
является специфической для конкретной архитектуры, а файлы Texinfo не
конфликтуют с системной документацией. Но эти файлы иногда могут
конфликтовать с ранними версиями тех же файлов, а страницы <CODE>man</CODE> -
с системной документацией. В качестве компромисса можно выполнять
преобразования имен страниц <CODE>man</CODE>, но не руководств в формате
Texinfo.
</P><P>

<A NAME="Локальные значения по умолчанию"></A>
<HR SIZE="6">
<A NAME="SEC80"></A>
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC79"> &lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_10.html#SEC81"> &gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC76"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC72"> Up </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_10.html#SEC81"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<H2> 9.5 Установка значений по умолчанию для машины </H2>
<!--docid::SEC80::-->
<A NAME="Site Defaults"></A>
<P>

Созданные Autoconf скрипты <CODE>configure</CODE> позволяют вам задать
значения по умолчанию для некоторых параметров настройки. Вы можете
сделать это, создавая файлы инициализации для машины и для целой
системы.
</P><P>

<A NAME="IDX495"></A>
Если установлена переменная среды <CODE>CONFIG_SITE</CODE>, то
<CODE>configure</CODE> использует ее значение как имя скрипта командного
процессора, который необходимо выполнить. В противном случае он
считывает скрипт <TT>`<VAR>prefix</VAR>/share/config.site'</TT>, если тот
существует, а затем скрипт <TT>`<VAR>prefix</VAR>/etc/config.site'</TT>, также
если он существует. Таким образом, специфические для машины файлы
перекрывают настройки в машинно-независимых файлах в случае конфликта.
</P><P>

Файлы настроек машины могут быть произвольными скриптами командного
процессора, но реально использоваться в них могут только определенные
строки кода.  Поскольку <CODE>configure</CODE> считывает кэш-файлы после того,
как он считывает файлы настройки машины, то файл локальной конфигурации
может определить кэш-файл по умолчанию, который будет общим для всех
запускаемых в системе скриптов <CODE>configure</CODE>, созданных с помощью
Autoconf. Если вы установите кэш-файл по умолчанию в файле локальной
настройки, то хорошо было бы установить также выходную переменную
<CODE>CC</CODE>, поскольку кэш-файл является правильным только для
определенного компилятора, а многие системы имеют несколько
компиляторов.
</P><P>

В файле локальных настроек вы можете проверять или изменять значения
ключей командной строки, заданных скрипту <CODE>configure</CODE>; ключи
устанавливают переменные командного процессора, называющиеся так же, как
и ключи командной строки, но с символами дефиса, замененными на символы
подчеркивания. Исключением из этого правила являются ключи
<SAMP>`--without-'</SAMP> и <SAMP>`--disable-'</SAMP>, которые подобны заданию
соответствующих ключей <SAMP>`--with-'</SAMP> или <SAMP>`--enable-'</SAMP> со значением
<SAMP>`no'</SAMP>.  Таким образом, <SAMP>`--cache-file=localcache'</SAMP> устанавливает
переменную <CODE>cache_file</CODE> в значение <SAMP>`localcache'</SAMP>;
<SAMP>`--enable-warnings=no'</SAMP> или <SAMP>`--disable-warnings'</SAMP> устанавливают
переменную <CODE>enable_warnings</CODE> равной значению <SAMP>`no'</SAMP>;
<SAMP>`--prefix=/usr'</SAMP> устанавливает переменную <CODE>prefix</CODE> равной
<SAMP>`/usr'</SAMP>; и т. п.
</P><P>

В файлах локальных настроек также можно устанавливать нестандартные
значения по умолчанию для других выходных переменных, таких как
<CODE>CFLAGS</CODE>: иначе вам пришлось бы делать это снова и снова в
командной строке.  Если вы обычно используете нестандартные значения для
переменных <VAR>prefix</VAR> или <VAR>exec_prefix</VAR> (которые обычно
используются для указания файла локальной конфигурации), то все равно
можно задать эти значения в этом файле, если указать его имя в
переменной среды <CODE>CONFIG_SITE</CODE>.
</P><P>

Вы можете сами установить значения некоторых кэш-переменных в файле
локальной конфигурации.  Это полезно делать при кросс-компиляции,
поскольку невозможно определить и проверить возможности, требующие
запуска тестовых программ. Вы можете "заполнить кэш" установкой этих
значений для систем в файле <TT>`<VAR>prefix</VAR>/etc/config.site'</TT>. Для
определения имен кэш-переменных, которые вам необходимо установить,
поищите переменные с именами, содержащими <SAMP>`_cv_'</SAMP> в соответствующих
скриптах <CODE>configure</CODE> или в исходном коде <CODE>m4</CODE> макросов
Autoconf.
</P><P>

Кэш-файл не переопределяет ни одну переменную, установленную в файлах
локальной конфигурации.  Сходным образом вы не должны переопределять ключи
командной строки в файлах локальной конфигурации.  Ваш код должен
проверять, имеют ли уже переменные типа <CODE>prefix</CODE> или
<CODE>cache_file</CODE> значения по умолчанию (установленные ранее в процессе
выполнения <CODE>configure</CODE>), и если да, то не изменять этих значений.
</P><P>

Вот пример файла <TT>`/usr/share/local/gnu/share/config.site'</TT>.
Команда <SAMP>`configure --prefix=/usr/share/local/gnu'</SAMP> должна прочитать
этот файл (если переменная <CODE>CONFIG_SITE</CODE> не
установлена в другое значение).
</P><P>

<TABLE><tr><td>&nbsp;</td><td class=example><pre># config.site для configure
#
# изменение некоторых значений по умолчанию.
test "$prefix" = NONE &#38;&#38; prefix=/usr/share/local/gnu
test "$exec_prefix" = NONE &#38;&#38; exec_prefix=/usr/local/gnu
test "$sharedstatedir" = '${prefix}/com' &#38;&#38; sharedstatedir=/var
test "$localstatedir" = '${prefix}/var' &#38;&#38; localstatedir=/var
#
# разрешить скриптам, созданным Autoconf 2.x, пользоваться общим кэш-файлом
# для получения результатов тестов, которые действительны для данной
# архитектуры.
if test "$cache_file" = ./config.cache; then
  cache_file="$prefix/var/config.cache"
  # Кэш-файл действителен только для одного компилятора C.
  CC=gcc
fi
</pre></td></tr></table></P><P>

<A NAME="Запуск configure"></A>
<HR SIZE="6">
<TABLE CELLPADDING=1 CELLSPACING=1 BORDER=0>
<TR><TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_9.html#SEC76"> &lt;&lt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_10.html#SEC81"> &gt;&gt; </A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT"> &nbsp; <TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru.html#SEC_Top">Top</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_toc.html#SEC_Contents">Contents</A>]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[Index]</TD>
<TD VALIGN="MIDDLE" ALIGN="LEFT">[<A HREF="autoconf-ru_abt.html#SEC_About"> ? </A>]</TD>
</TR></TABLE>
<BR>  
<FONT SIZE="-1">
This document was generated
on <I>February, 19  2004</I>
using <A HREF="http://www.mathematik.uni-kl.de/~obachman/Texi2html
"><I>texi2html</I></A>

</BODY>
</HTML>
