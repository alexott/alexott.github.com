<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.34 in css mode. -->
<html>
  <head>
    <title>proxy.cpp</title>
    <style type="text/css">
    <!--
      body {
        color: #000000;
        background-color: #ebebeb;
      }
      .comment {
        /* font-lock-comment-face */
        color: #666666;
      }
      .comment-delimiter {
        /* font-lock-comment-delimiter-face */
        color: #666666;
      }
      .constant {
        /* font-lock-constant-face */
        color: #00008b;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #0000ff;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #a020f0;
      }
      .preprocessor {
        /* font-lock-preprocessor-face */
        color: #006400;
      }
      .string {
        /* font-lock-string-face */
        color: #008b00;
      }
      .type {
        /* font-lock-type-face */
        color: #0000ff;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #8b0000;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="comment-delimiter">/**</span><span class="comment">
 * </span><span class="comment"><span class="keyword">@file</span></span><span class="comment">   proxy.cpp
 * </span><span class="comment"><span class="keyword">@author</span></span><span class="comment"> Alex Ott &lt;<a href="mailto:alexott&#64;gmail.com">alexott&#64;gmail.com</a>&gt;
 * 
 * </span><span class="comment"><span class="keyword">@brief</span></span><span class="comment">  
 * 
 * 
 */</span>

<span class="preprocessor">#include</span> <span class="string">"proxy-server.hpp"</span>

<span class="type">int</span> <span class="function-name">main</span>(<span class="type">int</span> <span class="variable-name">argc</span>, <span class="type">char</span>** <span class="variable-name">argv</span>) {
    <span class="keyword">try</span> {
        <span class="type">int</span> <span class="variable-name">thread_num</span>=2;
        <span class="keyword">if</span>(argc &gt; 1)
            thread_num=<span class="constant">boost</span>::<span class="type">lexical_cast</span>&lt;<span class="type">int</span>&gt;(argv[1]);
        <span class="type">ios_deque</span> <span class="variable-name">io_services</span>;
        <span class="constant">std</span>::<span class="type">deque</span>&lt;<span class="constant">ba</span>::<span class="constant">io_service</span>::work&gt; <span class="variable-name">io_service_work</span>;
        
        <span class="constant">boost</span>::<span class="type">thread_group</span> <span class="variable-name">thr_grp</span>;
        
        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable-name">i</span> = 0; i &lt; thread_num; ++i) {
            <span class="type">io_service_ptr</span> <span class="variable-name">ios</span>(<span class="keyword">new</span> <span class="constant">ba</span>::<span class="type">io_service</span>);
            io_services.push_back(ios);
            io_service_work.push_back(<span class="constant">ba</span>::<span class="constant">io_service</span>::work(*ios));
            thr_grp.create_thread(<span class="constant">boost</span>::bind(&amp;<span class="constant">ba</span>::<span class="constant">io_service</span>::run, ios));
        }
        <span class="type">server</span> <span class="variable-name">server</span>(io_services);
        thr_grp.join_all();
    } <span class="keyword">catch</span> (<span class="constant">std</span>::exception&amp; e) {
        <span class="constant">std</span>::cerr &lt;&lt; e.what() &lt;&lt; <span class="constant">std</span>::endl;
    }


    <span class="keyword">return</span> 0;
}

</pre>
  </body>
</html>
